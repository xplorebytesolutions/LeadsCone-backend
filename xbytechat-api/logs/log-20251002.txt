2025-10-02 09:09:10.643 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:09:50.392 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:10:52.709 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:11:20.496 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:11:21.011 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:11:21.026 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:11:21.077 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:11:21.123 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:11:21.123 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:11:21.131 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:11:21.256 +05:30 [ERR] Failed executing DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:12:29.707 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:12:30.164 +05:30 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:12:30.176 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:12:30.230 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:12:30.275 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:12:30.276 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:12:30.284 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:12:30.399 +05:30 [ERR] Failed executing DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:12:46.605 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:12:47.927 +05:30 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:12:47.938 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:13:14.102 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:13:30.225 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:13:30.738 +05:30 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:13:30.753 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:13:30.814 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:13:30.872 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:13:30.872 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:13:30.881 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:13:31.010 +05:30 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:22:24.332 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:22:25.646 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:22:25.658 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:22:50.703 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:23:42.902 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:23:44.207 +05:30 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:23:44.217 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:24:10.363 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:24:10.813 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:24:10.825 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:24:10.876 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:24:10.922 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:24:10.923 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:24:10.930 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:24:11.046 +05:30 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:24:30.161 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:24:31.494 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:24:31.505 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:24:59.930 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:25:00.374 +05:30 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:25:00.387 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:25:00.442 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:25:00.488 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:25:00.488 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:25:00.495 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:25:00.600 +05:30 [ERR] Failed executing DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:26:16.664 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:26:17.961 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:26:17.972 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:26:30.869 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:26:31.342 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:26:31.354 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:26:31.405 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:26:31.455 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:26:31.455 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:26:31.463 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:26:31.577 +05:30 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "CustomerWebhookConfigs" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "Url" character varying(1024) NOT NULL,
    "BearerToken" character varying(2048),
    "IsActive" boolean NOT NULL,
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone,
    CONSTRAINT "PK_CustomerWebhookConfigs" PRIMARY KEY ("Id")
);
2025-10-02 09:28:59.641 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:29:00.091 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:29:00.103 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:29:00.157 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:29:00.204 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:29:00.205 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:29:00.212 +05:30 [INF] Applying migration '20251001121508_freshDeplyafterWebhookConfigs077'.
2025-10-02 09:29:00.312 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251001121508_freshDeplyafterWebhookConfigs077', '8.0.18');
2025-10-02 09:30:30.818 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:30:31.275 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:30:31.287 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:30:31.340 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:30:31.388 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:30:31.388 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:30:31.395 +05:30 [INF] No migrations were applied. The database is already up to date.
2025-10-02 09:32:18.316 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:32:42.056 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:32:42.503 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:32:42.515 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:32:42.566 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:32:42.612 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:32:42.613 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:32:42.621 +05:30 [INF] Applying migration '20251002040219_ContactJourneyStateLocal'.
2025-10-02 09:32:42.747 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ContactJourneyStates" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "FlowId" uuid NOT NULL,
    "ContactPhone" character varying(32) NOT NULL,
    "JourneyText" text NOT NULL,
    "ClickCount" integer NOT NULL,
    "LastButtonText" character varying(256),
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_ContactJourneyStates" PRIMARY KEY ("Id")
);
2025-10-02 09:32:42.753 +05:30 [ERR] Failed executing DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_CustomerWebhookConfigs_BusinessId_IsActive" ON "CustomerWebhookConfigs" ("BusinessId", "IsActive");
2025-10-02 09:33:46.061 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:33:47.341 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:33:47.352 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:34:01.590 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:34:15.245 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:34:15.787 +05:30 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:34:15.802 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:34:15.872 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:34:15.942 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 09:34:15.943 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 09:34:15.953 +05:30 [INF] Applying migration '20251002040402_ContactJourneyStateLocal'.
2025-10-02 09:34:16.089 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ContactJourneyStates" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "FlowId" uuid NOT NULL,
    "ContactPhone" character varying(32) NOT NULL,
    "JourneyText" text NOT NULL,
    "ClickCount" integer NOT NULL,
    "LastButtonText" character varying(256),
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_ContactJourneyStates" PRIMARY KEY ("Id")
);
2025-10-02 09:34:16.092 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_ContactJourneyStates_BusinessId_FlowId_ContactPhone" ON "ContactJourneyStates" ("BusinessId", "FlowId", "ContactPhone");
2025-10-02 09:34:16.092 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251002040402_ContactJourneyStateLocal', '8.0.18');
2025-10-02 09:55:57.594 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 09:55:57.635 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 09:55:57.650 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 09:55:58.451 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 09:55:58.956 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 09:55:58.974 +05:30 [INF] ClickLogWorker started
2025-10-02 09:55:59.166 +05:30 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 09:55:59.210 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__cutoff_0='2025-09-25T04:25:57.7641294Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 09:55:59.289 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 09:55:59.290 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 09:55:59.291 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 09:55:59.292 +05:30 [INF] Hosting environment: Development
2025-10-02 09:55:59.294 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 09:56:00.033 +05:30 [INF] ClickLogWorker stopped
2025-10-02 09:56:01.589 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 09:56:01.821 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 244.6453ms
2025-10-02 09:56:01.841 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 09:56:01.850 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 8.1805ms
2025-10-02 09:56:01.917 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 09:56:01.968 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 51.1332ms
2025-10-02 09:56:02.190 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 09:56:02.450 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 259.1757ms
2025-10-02 09:56:04.072 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__now_0='2025-10-02T04:26:03.9879596+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:56:09.011 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 09:56:09.110 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 09:56:09.136 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 09:56:09.161 +05:30 [INF] Start processing HTTP request GET https://partnersv1.pinbot.ai/v3/251114021418599/message_templates?limit=100
2025-10-02 09:56:09.163 +05:30 [INF] Sending HTTP request GET https://partnersv1.pinbot.ai/v3/251114021418599/message_templates?limit=100
2025-10-02 09:56:12.013 +05:30 [INF] Received HTTP response headers after 2845.968ms - 200
2025-10-02 09:56:12.015 +05:30 [INF] End processing HTTP request after 2856.6881ms - 200
2025-10-02 09:56:12.167 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82', @__providerKey_1='pinnacle'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."Body", w."BusinessId", w."ButtonsJson", w."Category", w."CreatedAt", w."ExternalId", w."HasImageHeader", w."IsActive", w."Language", w."LastSyncedAt", w."Name", w."PlaceholderCount", w."Provider", w."RawJson", w."Status", w."UpdatedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__providerKey_1
2025-10-02 09:56:12.313 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@p1='005f7851-ae6e-4fa9-8f54-beb8cd92276b', @p0='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p3='1821d66c-fb26-4c9c-ae9c-637698927546', @p2='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p5='1a2910fa-84aa-474a-8174-b799c98fbff6', @p4='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p7='1c000849-2790-447f-88a4-f5a19dc96926', @p6='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p9='1d5e446c-321a-4967-af0c-cd0e8d0268e5', @p8='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p11='1df5ec8b-e36d-438d-9bec-e8d4698df64a', @p10='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p13='347871a0-b1f9-49c7-a494-8df146b1a4e6', @p12='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p15='3bbfd722-61cf-445c-9d5f-2a7c672ad813', @p14='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p17='3cef57c5-0397-4ce6-a864-afe4109a7b36', @p16='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p19='40070956-4f23-40d3-a4a1-e23dd483ba02', @p18='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p21='4678725a-14c2-4a7d-9c47-eb5c238a6c7e', @p20='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p23='46cdca2c-1e94-4d83-8e36-bfcec81e2b7e', @p22='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p25='4f385d21-c035-435e-b352-d75b1e276b46', @p24='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p27='5110a9d7-ce2a-491c-98b8-f2c7d84be02b', @p26='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p29='5a12c8cf-76e4-4dc1-a281-77bbb2dbac73', @p28='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p31='6154a579-fab8-4eb9-a1f7-b0f5342aea7b', @p30='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p33='622ed49c-d677-4c6f-a2ab-6cb6ae3d49ff', @p32='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p35='643fd567-51c8-4fc8-9b32-36142aa42264', @p34='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p37='6cb81f1b-a149-48a4-a917-92f7d4ca1233', @p36='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p39='6e18fc61-5c74-4d0c-b2f6-81b8bdec772a', @p38='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p41='741fcb87-6fcd-42f1-bc8f-1a6f821590fa', @p40='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p43='78747243-4856-4560-ab7e-de8c63ae9753', @p42='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p47='9dc1ecc0-27e8-400a-8c2b-3705a332d516', @p44='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p45='{"name":"testing_1","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/434020495_817759347145442_7459011205631203997_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=TPeLgqGOc_QQ7kNvwG8ZnAA&_nc_oc=Adlsb8Xopu1DHmzRWaCDR-QTcJywo8gIZ08UpVskHIiyJjRS-VsmECNLvKKD_4sTTrw&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=TL6Bm3NlahaNn4hBlDEYJA&oh=01_Q5Aa2gEw_fsdpr7nevIodqJZfesYNQ8w6ew_-VjBtBmuW7LSoA&oe=69056D59"]}},{"type":"BODY","text":"Dear User,\r\nTesting"}],"language":"en","status":"APPROVED","category":"MARKETING","id":"817759340478776"}' (Nullable = false), @p46='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p49='a837c77e-bcd3-4178-b7b9-032bbf63cc51', @p48='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p53='a9b97f70-ab05-492c-975a-7b6ee5eb0e6d', @p50='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p51='{"name":"tempalte_v1","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/389521422_865429908351181_4208520018935703846_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=XJ2AtTaAFy8Q7kNvwH0RC7u&_nc_oc=Admvvvv62QCd_hnqZLK38byKxZdZbETcrwkLpS77teOam7OVji4Re8G2qAwdPE2Btgo&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=TL6Bm3NlahaNn4hBlDEYJA&oh=01_Q5Aa2gEM_jKAAOmNiQ-UuvGj7fKgW5GFNK2t2X08c0kGRzIJ7g&oe=690580BD"]}},{"type":"BODY","text":"Dear {{1}},\r\nThe Sale is live Now!!!!!!","example":{"body_text":[["name"]]}}],"language":"en","status":"APPROVED","category":"MARKETING","id":"865429905017848"}' (Nullable = false), @p52='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p55='b9d39738-1b3e-4cd5-824f-20d90829bc27', @p54='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p59='c2ab8631-3dd6-42ce-9252-88b97a6d5a32', @p56='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p57='{"name":"video_template","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/516018879_2829095420619582_8191240975323859564_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=Z-vPzSiWyBUQ7kNvwEYmbsP&_nc_oc=AdmWm3AXzRig2aj0nj7E3z4B9UiQKcbuIDsDsGBcmrBc9G7MqgtmqkS6u9ZQ6bTsNIk&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=TL6Bm3NlahaNn4hBlDEYJA&oh=01_Q5Aa2gE7H9unMWbIK0dVYeAYjtJOa2saGkuqdapfJEN7HOyUZw&oe=6905751B"]}},{"type":"BODY","text":"Hello {{1}}👋\nAapka order successfully deliver ho chuka hai. 🚚✨\nKya aapne Nirvasa ka Vaji Amrit Vati lena start kar diya hai? 💊\nNeeche diye gaye options me se select karke bataye 👇","example":{"body_text":[["No"]]}},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","id":"2829095417286249"}' (Nullable = false), @p58='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p61='cc1fbb25-b689-46af-b9ab-dd079b69796b', @p60='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p63='d73052f7-cf7c-41c9-80fd-859b50a8b296', @p62='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p65='d9a658f1-aa9f-402c-8cd8-3e0a6f449c59', @p64='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p67='dd977d94-5945-47fe-9fb2-bd9677b6bacd', @p66='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p69='e0211c6f-8eb7-4292-b62b-813528e7ed8d', @p68='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p71='e4f5ff05-2904-4dac-9d81-e167456a9072', @p70='2025-10-02T04:26:09.1215710Z' (DbType = DateTime), @p73='f1bc02e3-a7a6-44e0-8c00-a2db666f7777', @p72='2025-10-02T04:26:09.1215710Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p0
WHERE "Id" = @p1;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p2
WHERE "Id" = @p3;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p4
WHERE "Id" = @p5;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p6
WHERE "Id" = @p7;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p8
WHERE "Id" = @p9;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p10
WHERE "Id" = @p11;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p12
WHERE "Id" = @p13;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p14
WHERE "Id" = @p15;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p16
WHERE "Id" = @p17;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p18
WHERE "Id" = @p19;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p20
WHERE "Id" = @p21;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p22
WHERE "Id" = @p23;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p24
WHERE "Id" = @p25;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p26
WHERE "Id" = @p27;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p28
WHERE "Id" = @p29;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p30
WHERE "Id" = @p31;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p32
WHERE "Id" = @p33;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p34
WHERE "Id" = @p35;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p36
WHERE "Id" = @p37;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p38
WHERE "Id" = @p39;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p40
WHERE "Id" = @p41;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p42
WHERE "Id" = @p43;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p44, "RawJson" = @p45, "UpdatedAt" = @p46
WHERE "Id" = @p47;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p48
WHERE "Id" = @p49;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p50, "RawJson" = @p51, "UpdatedAt" = @p52
WHERE "Id" = @p53;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p54
WHERE "Id" = @p55;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p56, "RawJson" = @p57, "UpdatedAt" = @p58
WHERE "Id" = @p59;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p60
WHERE "Id" = @p61;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p62
WHERE "Id" = @p63;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p64
WHERE "Id" = @p65;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p66
WHERE "Id" = @p67;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p68
WHERE "Id" = @p69;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p70
WHERE "Id" = @p71;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p72
WHERE "Id" = @p73;
2025-10-02 09:56:12.331 +05:30 [INF] TemplateSyncWorker: biz="8390da76-10de-4d76-80f2-68b68f4e2b82" added=0 updated=3 skipped=31 syncedAt="2025-10-02T04:26:09.1215710Z"
2025-10-02 09:56:12.338 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 09:56:12.342 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 09:56:12.349 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=100
2025-10-02 09:56:12.350 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=100
2025-10-02 09:56:13.002 +05:30 [INF] Received HTTP response headers after 650.0767ms - 401
2025-10-02 09:56:13.003 +05:30 [INF] End processing HTTP request after 653.598ms - 401
2025-10-02 09:56:13.006 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerKey_1='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."Body", w."BusinessId", w."ButtonsJson", w."Category", w."CreatedAt", w."ExternalId", w."HasImageHeader", w."IsActive", w."Language", w."LastSyncedAt", w."Name", w."PlaceholderCount", w."Provider", w."RawJson", w."Status", w."UpdatedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__providerKey_1
2025-10-02 09:56:13.009 +05:30 [INF] TemplateSyncWorker: biz="9841bcab-ca71-439f-8691-d85ada887b01" added=0 updated=0 skipped=0 syncedAt="2025-10-02T04:26:12.3405677Z"
2025-10-02 09:56:13.011 +05:30 [INF] TemplateSyncWorker: sweep finished in 4030 ms; processed=2; next run ~"2025-10-02T10:26:08.9806271Z"
2025-10-02 09:56:14.090 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:26:14.0864144+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:56:24.102 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:26:24.0985833+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:56:34.111 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:26:34.1084187+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:56:44.121 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:26:44.1189811+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:56:54.131 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:26:54.1294693+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:04.150 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:04.1481493+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:14.166 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:14.1637870+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:24.172 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:24.1696523+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:34.182 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:34.1800965+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:44.189 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:44.1876065+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:57:54.226 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:27:54.2227547+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:04.239 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:28:04.2378021+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:10.135 +05:30 [INF] Request starting HTTP/1.1 GET http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp?hub.mode=subscribe&hub.challenge=1763726744&hub.verify_token=SPYdyJzlMorCAHYtiayJzlMorUoryJzlMorEYUcGCaRdzy0IMhhK - null null
2025-10-02 09:58:10.140 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 09:58:10.333 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api)'
2025-10-02 09:58:10.348 +05:30 [INF] Route matched with {action = "VerifyWebhook", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult VerifyWebhook(System.String, System.String, System.String) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 09:58:10.362 +05:30 [INF] ✅ WhatsApp webhook verified successfully.
2025-10-02 09:58:10.365 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-10-02 09:58:10.370 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api) in 16.7987ms
2025-10-02 09:58:10.372 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.VerifyWebhook (xbytechat.api)'
2025-10-02 09:58:10.374 +05:30 [INF] Request finished HTTP/1.1 GET http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp?hub.mode=subscribe&hub.challenge=1763726744&hub.verify_token=SPYdyJzlMorCAHYtiayJzlMorUoryJzlMorEYUcGCaRdzy0IMhhK - 200 null text/plain; charset=utf-8 239.0202ms
2025-10-02 09:58:14.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:28:14.2485633+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:24.263 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:28:24.2615537+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:34.277 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:28:34.2741071+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:44.290 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:28:44.2890019+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:58:54.302 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:28:54.2992303+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:04.325 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@__now_0='2025-10-02T04:29:04.3069853+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:14.342 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:29:14.3401457+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:24.360 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:29:24.3582199+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:28.316 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-10-02 09:59:28.333 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.336 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 19.9523ms
2025-10-02 09:59:28.342 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 48
2025-10-02 09:59:28.346 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.348 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-10-02 09:59:28.354 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-10-02 09:59:28.381 +05:30 [INF] 🔑 Login attempt for email: test@gmail.com
2025-10-02 09:59:28.458 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__dto_Email_0='test@gmail.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-10-02 09:59:28.523 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__user_BusinessId_Value_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."PlanId", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", p."Id", p."Code", p."CreatedAt", p."Description", p."IsActive", p."Name"
FROM "Businesses" AS b
LEFT JOIN "Plans" AS p ON b."PlanId" = p."Id"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-10-02 09:59:28.648 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='6376a399-238e-4a8c-b2b8-b66a69a74c0c'], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT t0."Code", t0."Group"
FROM "Users" AS u
INNER JOIN "Businesses" AS b ON u."BusinessId" = b."Id"
INNER JOIN (
    SELECT p."PermissionId", p."PlanId"
    FROM "PlanPermissions" AS p
    WHERE p."IsActive"
) AS t ON b."PlanId" = t."PlanId"
INNER JOIN (
    SELECT p0."Id", p0."Code", p0."Group"
    FROM "Permissions" AS p0
    WHERE p0."IsActive"
) AS t0 ON t."PermissionId" = t0."Id"
WHERE u."Id" = @__userId_0 AND EXISTS (
    SELECT 1
    FROM "RolePermissions" AS r
    WHERE r."IsActive" AND NOT (r."IsRevoked") AND r."RoleId" = u."RoleId" AND r."PermissionId" = t0."Id")
2025-10-02 09:59:28.659 +05:30 [INF] ✅ Token generated for: test@gmail.com
2025-10-02 09:59:28.750 +05:30 [INF] 🔎 JWT includes plan_id: 5f9f5de1-a0b2-48ba-b03d-77b27345613f
2025-10-02 09:59:28.752 +05:30 [INF] ✅ Login successful for test@gmail.com, Role: business, PlanId: "5f9f5de1-a0b2-48ba-b03d-77b27345613f"
2025-10-02 09:59:28.756 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:28.762 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 406.1614ms
2025-10-02 09:59:28.763 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-10-02 09:59:28.767 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 425.0897ms
2025-10-02 09:59:28.770 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 09:59:28.773 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.774 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 3.8392ms
2025-10-02 09:59:28.777 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 09:59:28.780 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.811 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:28.815 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 09:59:28.829 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Id", p0."Code", p0."CreatedAt", p0."Description", p0."Group", p0."IsActive", p0."Name"
FROM "PlanPermissions" AS p
INNER JOIN "Permissions" AS p0 ON p."PermissionId" = p0."Id"
WHERE p."PlanId" = @__planId_0 AND p."IsActive"
2025-10-02 09:59:28.854 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 09:59:28.857 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:28.868 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 50.7564ms
2025-10-02 09:59:28.869 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:28.870 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 93.3495ms
2025-10-02 09:59:28.883 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 09:59:28.886 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.888 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.6757ms
2025-10-02 09:59:28.896 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 09:59:28.899 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:28.903 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:28.905 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 09:59:28.912 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 09:59:28.916 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:28.918 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 11.1248ms
2025-10-02 09:59:28.920 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:28.921 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 25.3494ms
2025-10-02 09:59:29.034 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 09:59:29.040 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:29.043 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:29.045 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 09:59:29.051 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 09:59:29.056 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:29.059 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 11.4849ms
2025-10-02 09:59:29.060 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 09:59:29.062 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 27.5464ms
2025-10-02 09:59:32.476 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-10-02 09:59:32.477 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - null null
2025-10-02 09:59:32.484 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.487 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 11.2408ms
2025-10-02 09:59:32.487 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.491 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-10-02 09:59:32.491 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - 204 null null 14.4038ms
2025-10-02 09:59:32.494 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.497 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - null null
2025-10-02 09:59:32.498 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-10-02 09:59:32.500 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.502 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.504 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 09:59:32.507 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 09:59:32.516 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 09:59:32.525 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='PINNACLE'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 09:59:32.527 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 09:59:32.539 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 30.799ms
2025-10-02 09:59:32.541 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.542 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - 200 null application/json; charset=utf-8 45.2366ms
2025-10-02 09:59:32.550 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat_api.WhatsAppSettings.Models.WhatsAppSettingEntity'.
2025-10-02 09:59:32.556 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 50.2573ms
2025-10-02 09:59:32.558 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-10-02 09:59:32.559 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 200 null application/json; charset=utf-8 68.0409ms
2025-10-02 09:59:32.573 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 09:59:32.575 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 09:59:32.576 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.578 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.579 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 204 null null 5.2533ms
2025-10-02 09:59:32.579 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 204 null null 3.8214ms
2025-10-02 09:59:32.585 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 09:59:32.587 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.588 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.590 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 09:59:32.594 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 09:59:32.597 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 09:59:32.599 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 7.4751ms
2025-10-02 09:59:32.599 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 09:59:32.600 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.602 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:32.603 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 200 null application/json; charset=utf-8 18.7809ms
2025-10-02 09:59:32.604 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.607 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 09:59:32.612 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 09:59:32.615 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 09:59:32.617 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 7.6167ms
2025-10-02 09:59:32.618 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 09:59:32.619 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 200 null application/json; charset=utf-8 19.8178ms
2025-10-02 09:59:34.370 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:29:34.3683113+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:38.606 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - null null
2025-10-02 09:59:38.608 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:38.609 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - 204 null null 3.2647ms
2025-10-02 09:59:38.616 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - application/json 572
2025-10-02 09:59:38.619 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:38.620 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-10-02 09:59:38.623 +05:30 [INF] Route matched with {action = "UpdateSetting", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSetting(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 09:59:38.638 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__dto_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__dto_Provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__dto_BusinessId_0 AND w."Provider" = @__dto_Provider_1
LIMIT 1
2025-10-02 09:59:38.656 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p2='22ee5a32-2db4-4602-814f-0a24694f5636', @p0='EAAUbmP4285YBPtdfxqi3bPvpZBatZBz6jwtNY7OH2PCZAdYuFP5xkT1bzfwfdoWZAkzZBTgX7nfKwjsBm4ARPFRVdMezlACbv2JmhXeIr9UIsFLpoAXQSam2fucywWHGlfBEw8Yuqdpx3zLIX1ZAqaxxZCeLiaPa7h7lWMTSrZCCxPFSsFZCOyDXEZBlgqB0EuBDHi0x0RDpZClZCx0k0YZAZCKDDCEgvBgCDRsleb88iDHzLUCXfPCMU76MD4QZAZC9GAXZCjgZDZD' (Nullable = false), @p1='2025-10-02T04:29:38.6424652Z' (Nullable = true) (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppSettings" SET "ApiKey" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-10-02 09:59:38.659 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:38.661 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api) in 36.155ms
2025-10-02 09:59:38.662 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-10-02 09:59:38.663 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - 200 null application/json; charset=utf-8 46.7604ms
2025-10-02 09:59:43.526 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - null null
2025-10-02 09:59:43.530 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:43.530 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - 204 null null 3.8939ms
2025-10-02 09:59:43.533 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - application/json 2
2025-10-02 09:59:43.536 +05:30 [INF] CORS policy execution successful.
2025-10-02 09:59:43.537 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 09:59:43.540 +05:30 [INF] Route matched with {action = "TestConnectionCurrent", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] TestConnectionCurrent() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 09:59:43.546 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 09:59:43.552 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 09:59:43.553 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 09:59:44.377 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:29:44.3754968+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 09:59:45.398 +05:30 [INF] Received HTTP response headers after 1844.4545ms - 200
2025-10-02 09:59:45.400 +05:30 [INF] End processing HTTP request after 1848.0963ms - 200
2025-10-02 09:59:45.403 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 09:59:45.405 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api) in 1863.1002ms
2025-10-02 09:59:45.406 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 09:59:45.407 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - 200 null application/json; charset=utf-8 1874.1879ms
2025-10-02 09:59:54.396 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:29:54.3937751+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:04.400 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:30:04.3978530+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:14.420 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:30:14.4176049+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:24.435 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:30:24.4334782+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:34.448 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:30:34.4460603+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:44.463 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:30:44.4612323+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:00:54.476 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:30:54.4736275+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:04.558 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:31:04.5012194+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:14.570 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:31:14.5679002+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:24.580 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:31:24.5780540+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:34.595 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:31:34.5943288+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:44.607 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:31:44.6051934+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:01:51.514 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:01:51.517 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:01:51.521 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:01:51.555 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:01:51.559 +05:30 [INF] [CustomAPI:"89c7dcc0-19ac-484d-b74a-d0b10665d43c"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:01:51.571 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:01:51.574 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:01:51.575 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:01:52.758 +05:30 [INF] Received HTTP response headers after 1182.482ms - 200
2025-10-02 10:01:52.760 +05:30 [INF] End processing HTTP request after 1186.1749ms - 200
2025-10-02 10:01:52.867 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:01:52.871 +05:30 [INF] [CustomAPI:"89c7dcc0-19ac-484d-b74a-d0b10665d43c"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:01:52.882 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:01:52.890 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:01:52.900 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:01:52.901 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:01:53.883 +05:30 [INF] Received HTTP response headers after 981.2564ms - 200
2025-10-02 10:01:53.884 +05:30 [INF] End processing HTTP request after 984.385ms - 200
2025-10-02 10:01:53.992 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='877bb569-3347-4cd5-b042-a7ae85ceda18', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T04:31:53.8896259Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T04:31:53.8896259Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:01:54.012 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__messageLogId_0='877bb569-3347-4cd5-b042-a7ae85ceda18', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:01:54.045 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='ce73582b-91c8-4a55-a933-2d80d2d224d7', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T04:31:54.0148072+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p8='2025-10-02T04:31:54.0151272+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:01:54.048 +05:30 [INF] [CustomAPI:"89c7dcc0-19ac-484d-b74a-d0b10665d43c"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:01:54.050 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:01:54.058 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 2535.8256ms
2025-10-02 10:01:54.059 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:01:54.060 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 2546.3814ms
2025-10-02 10:01:54.625 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:31:54.6237789+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:04.637 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:04.6350664+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:05.000 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:02:05.004 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:02:05.006 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:02:05.012 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"sent","timestamp":"1759379526","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","expiration_timestamp":"1759379526","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:02:05.014 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:02:05.016 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:02:05.019 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 11.1067ms
2025-10-02 10:02:05.020 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:02:05.021 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.0899ms
2025-10-02 10:02:05.125 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"sent","timestamp":"1759379526","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","expiration_timestamp":"1759379526","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:02:05.138 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:02:05.142 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:02:05.151 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:02:05.154 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:02:05.162 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:02:05.171 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p4='877bb569-3347-4cd5-b042-a7ae85ceda18', @p0='marketing', @p1='bad99e302a31225816496e83593fe8f2', @p2='2025-10-01T04:32:06.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='254a1363-5349-4753-9319-269a52f20c15', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='bad99e302a31225816496e83593fe8f2', @p9='2025-10-02T04:32:05.1534601+00:00' (DbType = DateTime), @p10='sent' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T04:32:06.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"sent","timestamp":"1759379526","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","expiration_timestamp":"1759379526","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==', @p19='32d9a837-dbd7-477d-9100-30a1b8cd4028', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='bad99e302a31225816496e83593fe8f2', @p23='2025-10-02T04:32:05.1567935+00:00' (DbType = DateTime), @p24='pricing_update' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T04:32:06.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"sent","timestamp":"1759379526","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","expiration_timestamp":"1759379526","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:02:05.193 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:02:05.201 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:02:06.384 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-10-02 10:02:06.387 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:02:06.387 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:02:06.391 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"delivered","timestamp":"1759379528","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:02:06.393 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:02:06.393 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:02:06.395 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.6276ms
2025-10-02 10:02:06.395 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"delivered","timestamp":"1759379528","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:02:06.396 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:02:06.397 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:02:06.398 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.6431ms
2025-10-02 10:02:06.401 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='delivered', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:02:06.406 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:02:06.409 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:02:06.415 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='c37f1bc9-609b-4646-95bc-5dc295087fe8', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='bad99e302a31225816496e83593fe8f2', @p4='2025-10-02T04:32:06.4050985+00:00' (DbType = DateTime), @p5='delivered' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:32:08.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"delivered","timestamp":"1759379528","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:02:06.419 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:02:06.422 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:02:06.426 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='877bb569-3347-4cd5-b042-a7ae85ceda18', @p0='Delivered' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:02:14.654 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:14.6527926+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:24.670 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:24.6690402+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:34.690 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:34.6881273+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:44.700 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:44.6980752+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:02:54.712 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:32:54.7106450+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:04.722 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:04.7202809+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:13.206 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:03:13.214 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:03:13.215 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:03:13.217 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"read","timestamp":"1759379594","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:03:13.218 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:03:13.219 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:03:13.220 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.7634ms
2025-10-02 10:03:13.221 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:03:13.222 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 16.5428ms
2025-10-02 10:03:13.227 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"read","timestamp":"1759379594","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:03:13.228 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:03:13.231 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:03:13.234 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:03:13.238 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:03:13.242 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='4e4b5b0e-47ce-4402-926e-45360fe93b24', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='bad99e302a31225816496e83593fe8f2', @p4='2025-10-02T04:33:13.2336675+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:33:14.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==","status":"read","timestamp":"1759379594","recipient_id":"918974005240","conversation":{"id":"bad99e302a31225816496e83593fe8f2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:03:13.246 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:03:13.249 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:03:13.253 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='877bb569-3347-4cd5-b042-a7ae85ceda18', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:03:14.733 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:14.7318510+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:24.752 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:24.7500958+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:34.761 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:34.7596662+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:44.780 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:44.7784126+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:03:54.784 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:33:54.7831430+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:04.788 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:34:04.7863223+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:14.802 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:34:14.7984757+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:24.816 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:34:24.8135799+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:34.826 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:34:34.8247830+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:44.837 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:34:44.8355471+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:04:54.847 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:34:54.8460991+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:04.853 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:04.8517950+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:14.861 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:14.8594583+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:24.871 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:24.8693422+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:34.881 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:34.8796753+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:44.888 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:44.8863317+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:05:54.903 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:35:54.9014436+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:04.971 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:36:04.9194096+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:14.982 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:36:14.9809026+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:24.988 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:36:24.9865079+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:34.999 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:36:34.9976365+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:45.008 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:36:45.0063029+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:06:55.016 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:36:55.0146497+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:05.025 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:05.0238273+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:15.033 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:15.0318577+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:25.040 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:25.0384907+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:35.051 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:35.0499211+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:45.061 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:45.0601193+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:07:55.067 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:37:55.0653766+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:05.076 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:38:05.0743750+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:15.088 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:38:15.0856599+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:25.103 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:38:25.1015851+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:29.213 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 603
2025-10-02 10:08:29.216 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:29.217 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:29.219 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBRUU3N0VDRUNBOERBREE3MUFDMkE5RDAzNDA3RjkA","timestamp":"1759379910","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:08:29.221 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:29.221 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBRUU3N0VDRUNBOERBREE3MUFDMkE5RDAzNDA3RjkA","timestamp":"1759379910","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:08:29.221 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:29.222 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:08:29.224 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.2411ms
2025-10-02 10:08:29.225 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:29.226 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.3637ms
2025-10-02 10:08:29.252 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:08:29.253 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBRUU3N0VDRUNBOERBREE3MUFDMkE5RDAzNDA3RjkA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==, Text: Yes
2025-10-02 10:08:29.262 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:08:29.268 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:29.277 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:08:29.316 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:08:29.329 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:08:29.338 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:08:29.343 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:08:29.392 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@p0='767e32e1-7e0e-47e9-92f6-526195b20db7', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:29.3465629Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p9=NULL, @p10='e85ff9ca-6cd9-426b-846b-deb824d083aa' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Yes'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:08:29.400 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:08:29.418 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='40194c10-13c3-45ed-94fb-99a8912e265e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='1', @p3='918974005240' (Nullable = false), @p4='2025-10-02T04:38:29.4030711Z' (DbType = DateTime), @p5='0c5e1825-c899-41f0-b947-388dbffed015', @p6='Yes' (Nullable = false), @p7='Yes', @p8='2025-10-02T04:38:29.4031157Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ContactJourneyStates" ("Id", "BusinessId", "ClickCount", "ContactPhone", "CreatedAt", "FlowId", "JourneyText", "LastButtonText", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-02 10:08:29.420 +05:30 [INF] 🧵 Journey init: Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:08:29.425 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:08:29.430 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:29.434 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:29.443 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:08:29.448 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:29.449 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:31.139 +05:30 [INF] Received HTTP response headers after 1689.1213ms - 200
2025-10-02 10:08:31.140 +05:30 [INF] End processing HTTP request after 1692.594ms - 200
2025-10-02 10:08:31.142 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:08:31.143 +05:30 [INF] 📤 CTAJourney posted (running): Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:08:31.197 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:08:31.227 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:08:31.229 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:31.230 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:32.398 +05:30 [INF] Received HTTP response headers after 1166.923ms - 200
2025-10-02 10:08:32.399 +05:30 [INF] End processing HTTP request after 1170.398ms - 200
2025-10-02 10:08:32.457 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:32.460 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:08:32.463 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:08:32.466 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:08:32.470 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:32.471 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:33.378 +05:30 [INF] Received HTTP response headers after 905.5847ms - 200
2025-10-02 10:08:33.379 +05:30 [INF] End processing HTTP request after 909.1306ms - 200
2025-10-02 10:08:33.399 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='f3771875-2154-47ab-969f-ac8be2828ce4', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:33.3883076Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","message_status":"accepted"}]}', @p10='7c070a3e-4cc8-406c-9c3a-6f0fbfe35cae' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='960620cd-cdfb-47c1-9c4e-fc6a38dbc980', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:38:33.3875917Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:38:33.3875933Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:08:34.547 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:08:34.550 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:34.551 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:34.553 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"sent","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","expiration_timestamp":"1759379916","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:34.555 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:34.555 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"sent","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","expiration_timestamp":"1759379916","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:34.556 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:34.559 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:08:34.559 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.3984ms
2025-10-02 10:08:34.561 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:34.562 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:34.564 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:34.565 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.7947ms
2025-10-02 10:08:34.568 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:34.574 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:34.580 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='e2f616e47be1f26710b6c714dec078de'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:34.584 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='42a359d0-e026-43df-b907-a4da380f212a', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='e2f616e47be1f26710b6c714dec078de', @p4='2025-10-02T04:38:34.5675476+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:36.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"sent","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","expiration_timestamp":"1759379916","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==', @p14='46f336e9-4f7a-4745-8a48-ebe4bd7a7726', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='e2f616e47be1f26710b6c714dec078de', @p18='2025-10-02T04:38:34.5728403+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:38:36.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"sent","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","expiration_timestamp":"1759379916","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:08:34.603 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:34.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:35.054 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:08:35.056 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:35.057 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:35.059 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"read","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:35.061 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:35.061 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"read","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:35.062 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:35.063 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:35.064 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.9168ms
2025-10-02 10:08:35.067 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:35.067 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:35.071 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:35.071 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.5521ms
2025-10-02 10:08:35.074 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:35.079 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='e2f616e47be1f26710b6c714dec078de'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:35.082 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='d61dcd8f-55f8-4d67-80ed-3afbdfce28ea', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='e2f616e47be1f26710b6c714dec078de', @p4='2025-10-02T04:38:35.0697572+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:36.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==","status":"read","timestamp":"1759379916","recipient_id":"918974005240","conversation":{"id":"e2f616e47be1f26710b6c714dec078de","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:08:35.086 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:35.089 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:35.093 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='960620cd-cdfb-47c1-9c4e-fc6a38dbc980', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:08:35.116 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:38:35.1149362+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:38.650 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:08:38.653 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:38.654 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:38.656 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyMkQ2RTk1MzMwOEQ1NUI2QjQwMjk0MTc2QTU2M0MA","timestamp":"1759379920","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:08:38.657 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:38.657 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyMkQ2RTk1MzMwOEQ1NUI2QjQwMjk0MTc2QTU2M0MA","timestamp":"1759379920","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:08:38.658 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:38.658 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:08:38.659 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.2931ms
2025-10-02 10:08:38.660 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:08:38.661 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:38.662 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyMkQ2RTk1MzMwOEQ1NUI2QjQwMjk0MTc2QTU2M0MA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==, Text: Show Me Template 2
2025-10-02 10:08:38.663 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.8722ms
2025-10-02 10:08:38.666 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:08:38.671 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:38.674 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:08:38.680 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:08:38.682 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:08:38.704 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='4a7ac378-287b-46fe-87db-82742f0fb857', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:38.6846718Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @p9=NULL, @p10='c2137b22-a8cf-4da8-a670-476e773e3462' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:08:38.708 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:08:38.712 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='2', @p1='Yes/Show Me Template 2' (Nullable = false), @p2='Show Me Template 2', @p3='2025-10-02T04:38:38.7110610Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:08:38.715 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:08:38.718 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:08:38.721 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:38.724 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:38.727 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:08:38.729 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:38.730 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:39.762 +05:30 [INF] Received HTTP response headers after 1030.9041ms - 200
2025-10-02 10:08:39.763 +05:30 [INF] End processing HTTP request after 1034.4962ms - 200
2025-10-02 10:08:39.765 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:08:39.766 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:08:39.769 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:08:39.773 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:08:39.775 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:39.776 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:40.559 +05:30 [INF] Received HTTP response headers after 782.1148ms - 200
2025-10-02 10:08:40.561 +05:30 [INF] End processing HTTP request after 785.9632ms - 200
2025-10-02 10:08:40.628 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:40.630 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:08:40.633 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:08:40.637 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:08:40.639 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:40.640 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:41.530 +05:30 [INF] Received HTTP response headers after 889.0808ms - 200
2025-10-02 10:08:41.532 +05:30 [INF] End processing HTTP request after 892.487ms - 200
2025-10-02 10:08:41.536 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='bde8e0a4-14d7-4892-8675-ea0dc36ad353', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:41.5340142Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='c3b44746-6059-4b6b-8315-916ae3179e06' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","message_status":"accepted"}]}', @p10='70c65933-a7d7-492d-a077-864bef5e30b3' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='c3b44746-6059-4b6b-8315-916ae3179e06', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:38:41.5337607Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:38:41.5337624Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:08:42.739 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:08:42.742 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:42.743 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:42.746 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"sent","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","expiration_timestamp":"1759379924","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:42.747 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:42.747 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"sent","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","expiration_timestamp":"1759379924","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:42.748 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:42.749 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:42.750 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.7454ms
2025-10-02 10:08:42.753 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:42.753 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:42.760 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:42.760 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 20.6497ms
2025-10-02 10:08:42.763 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:42.769 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='b3fc02b2ce2aee08a55c273fa2c9bbb1'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:42.773 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='2cb64111-62c5-4c8f-baec-1798a0fef418', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='b3fc02b2ce2aee08a55c273fa2c9bbb1', @p4='2025-10-02T04:38:42.7618363+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:44.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"sent","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","expiration_timestamp":"1759379924","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==', @p14='84df2e3c-4f3c-4178-87a7-c0a1bbe3ffda', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='b3fc02b2ce2aee08a55c273fa2c9bbb1', @p18='2025-10-02T04:38:42.7584626+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:38:44.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"sent","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","expiration_timestamp":"1759379924","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:08:42.777 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:42.781 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:43.195 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:08:43.197 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:43.198 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:43.200 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"read","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:43.201 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:43.201 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"read","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:43.202 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:43.202 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:43.203 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.8707ms
2025-10-02 10:08:43.206 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:43.207 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:43.209 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:43.210 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.9994ms
2025-10-02 10:08:43.213 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:43.218 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='b3fc02b2ce2aee08a55c273fa2c9bbb1'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:43.221 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='3f1560f5-6129-42fe-850d-0f06f0304b76', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='b3fc02b2ce2aee08a55c273fa2c9bbb1', @p4='2025-10-02T04:38:43.2086236+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:44.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==","status":"read","timestamp":"1759379924","recipient_id":"918974005240","conversation":{"id":"b3fc02b2ce2aee08a55c273fa2c9bbb1","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:08:43.224 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:43.227 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:43.230 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='c3b44746-6059-4b6b-8315-916ae3179e06', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:08:45.134 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:38:45.1324071+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:46.454 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:08:46.457 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:46.458 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:46.460 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBOUM2NjJBNjg0RTFDNDQ4REZBRjY5NDMxRTkyQzUA","timestamp":"1759379927","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:08:46.462 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:46.462 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBOUM2NjJBNjg0RTFDNDQ4REZBRjY5NDMxRTkyQzUA","timestamp":"1759379927","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:08:46.463 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:46.464 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:08:46.465 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.3937ms
2025-10-02 10:08:46.466 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:08:46.467 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:46.468 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBOUM2NjJBNjg0RTFDNDQ4REZBRjY5NDMxRTkyQzUA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA==, Text: Show Me Template 3
2025-10-02 10:08:46.469 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.8909ms
2025-10-02 10:08:46.472 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:08:46.477 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjgzRDFCMjJGOUY4OEVFRUNBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:46.481 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:08:46.484 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:08:46.486 +05:30 [INF] 🟨 Falling back to single available link for step "00e8efb2-eb9d-4c6d-a516-1ea299da5c61"
2025-10-02 10:08:46.487 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61")
2025-10-02 10:08:46.489 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:08:46.492 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:08:46.496 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='46d99d31-91d4-4d7d-a53b-c4180de8fb24', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:46.4947285Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @p9=NULL, @p10='b932ded6-d75f-41f4-b3e5-f138bfdef800' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 3'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:08:46.499 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:08:46.503 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='3', @p1='Yes/Show Me Template 2/Show Me Template 3' (Nullable = false), @p2='Show Me Template 3', @p3='2025-10-02T04:38:46.5018766Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:08:46.505 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:08:46.508 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:08:46.511 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:46.514 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:46.517 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:08:46.519 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:46.520 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:08:47.602 +05:30 [INF] Received HTTP response headers after 1080.4457ms - 200
2025-10-02 10:08:47.603 +05:30 [INF] End processing HTTP request after 1083.9823ms - 200
2025-10-02 10:08:47.604 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:08:47.606 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:08:47.609 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:08:47.613 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:08:47.615 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:47.617 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:08:48.397 +05:30 [INF] Received HTTP response headers after 779.5264ms - 200
2025-10-02 10:08:48.399 +05:30 [INF] End processing HTTP request after 783.8834ms - 200
2025-10-02 10:08:48.456 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:08:48.458 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:08:48.461 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:08:48.465 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:08:48.467 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:48.468 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:08:49.520 +05:30 [INF] Received HTTP response headers after 1050.3649ms - 200
2025-10-02 10:08:49.522 +05:30 [INF] End processing HTTP request after 1054.237ms - 200
2025-10-02 10:08:49.526 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='6e58d5de-32e6-4ff2-a77c-bd330cfb8ccf', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:38:49.5236086Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='a37e020f-f70b-4796-8fe1-be84340ec2db' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","message_status":"accepted"}]}', @p10='0654b826-361a-4a86-9f9f-5304f3816261' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='a37e020f-f70b-4796-8fe1-be84340ec2db', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:38:49.5233613Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='960620cd-cdfb-47c1-9c4e-fc6a38dbc980' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:38:49.5233623Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:08:50.847 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:08:50.850 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:50.851 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:50.853 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"sent","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","expiration_timestamp":"1759379932","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:50.855 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:50.855 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"sent","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","expiration_timestamp":"1759379932","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:50.856 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:50.857 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:50.858 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.5996ms
2025-10-02 10:08:50.861 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:50.862 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:50.864 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:50.865 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 18.1206ms
2025-10-02 10:08:50.868 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:50.873 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='707cda840455e2cb9dfaa8ada4205b8c'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:50.877 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='7b175c25-73f0-4b75-8250-9e0f5c814962', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='707cda840455e2cb9dfaa8ada4205b8c', @p4='2025-10-02T04:38:50.8668951+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:52.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"sent","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","expiration_timestamp":"1759379932","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==', @p14='9c57ad24-ffee-4701-a9c2-21d4de9f23bb', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='707cda840455e2cb9dfaa8ada4205b8c', @p18='2025-10-02T04:38:50.8635922+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:38:52.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"sent","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","expiration_timestamp":"1759379932","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:08:50.898 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:50.902 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:51.023 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:08:51.026 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:51.027 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:51.028 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"read","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:51.030 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:51.030 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"read","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:08:51.031 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:51.032 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:08:51.033 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.5239ms
2025-10-02 10:08:51.036 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:51.036 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:51.040 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:08:51.040 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.4428ms
2025-10-02 10:08:51.043 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:51.048 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='707cda840455e2cb9dfaa8ada4205b8c'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:51.051 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='2de42121-5ca6-4858-a363-cbd32c618ac2', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='707cda840455e2cb9dfaa8ada4205b8c', @p4='2025-10-02T04:38:51.0388658+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:38:52.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==","status":"read","timestamp":"1759379932","recipient_id":"918974005240","conversation":{"id":"707cda840455e2cb9dfaa8ada4205b8c","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:08:51.054 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:08:51.058 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:08:51.061 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='a37e020f-f70b-4796-8fe1-be84340ec2db', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:08:55.152 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:38:55.1501498+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:08:58.694 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:08:58.696 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:58.697 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:08:58.699 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCRTRFNjBFNEQ0NjQ1Qjk1NjBCNjExQkREODZFNEUA","timestamp":"1759379940","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:08:58.701 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:08:58.701 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCRTRFNjBFNEQ0NjQ1Qjk1NjBCNjExQkREODZFNEUA","timestamp":"1759379940","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:08:58.702 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:08:58.703 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:08:58.704 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.883ms
2025-10-02 10:08:58.705 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:08:58.706 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:08:58.706 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCRTRFNjBFNEQ0NjQ1Qjk1NjBCNjExQkREODZFNEUA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==, Text: Show Me Template 1
2025-10-02 10:08:58.707 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.2432ms
2025-10-02 10:08:58.710 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:08:58.715 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='a37e020f-f70b-4796-8fe1-be84340ec2db' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:08:58.718 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:08:58.722 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:08:58.723 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMTIxQUIwOUM0MEM1RTFCRDY0AA==, Text='Show Me Template 1'
2025-10-02 10:09:05.166 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:05.1642147+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:09:15.182 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:15.1801655+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:09:19.898 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:09:19.901 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:09:19.902 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:09:19.904 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2MjE2Rjg5RDJENDdCRERCMDU5QzYwOUFBNjc4MTAA","timestamp":"1759379961","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:09:19.906 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:09:19.906 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2MjE2Rjg5RDJENDdCRERCMDU5QzYwOUFBNjc4MTAA","timestamp":"1759379961","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:09:19.906 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:09:19.907 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:09:19.908 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.5449ms
2025-10-02 10:09:19.909 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:09:19.910 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:09:19.910 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2MjE2Rjg5RDJENDdCRERCMDU5QzYwOUFBNjc4MTAA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==, Text: Show Me Template 1
2025-10-02 10:09:19.911 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.8087ms
2025-10-02 10:09:19.915 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:09:19.919 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='c3b44746-6059-4b6b-8315-916ae3179e06' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:09:19.922 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:09:19.925 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:09:19.927 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSM0NBQ0YyRjc5QzYyQTA3MDA4AA==, Text='Show Me Template 1'
2025-10-02 10:09:25.197 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:25.1951366+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:09:34.365 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:09:34.368 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:09:34.370 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:09:34.374 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:09:34.378 +05:30 [INF] [CustomAPI:"8e5d7b8c-0857-4409-877e-a5114c46cdc6"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:09:34.381 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:09:34.384 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:09:34.385 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:09:35.213 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:35.2112134+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:09:35.280 +05:30 [INF] Received HTTP response headers after 894.3373ms - 200
2025-10-02 10:09:35.282 +05:30 [INF] End processing HTTP request after 897.9361ms - 200
2025-10-02 10:09:35.332 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:09:35.334 +05:30 [INF] [CustomAPI:"8e5d7b8c-0857-4409-877e-a5114c46cdc6"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:09:35.338 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:09:35.341 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:09:35.343 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:09:35.344 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:09:36.239 +05:30 [INF] Received HTTP response headers after 894.2264ms - 200
2025-10-02 10:09:36.241 +05:30 [INF] End processing HTTP request after 897.7866ms - 200
2025-10-02 10:09:36.263 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='edf2b076-6249-4766-a028-3ee18b535289', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T04:39:36.2430368Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T04:39:36.2430368Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:09:36.266 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageLogId_0='edf2b076-6249-4766-a028-3ee18b535289', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:09:36.270 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='1f47fccd-07de-4611-aa81-d1419b3d13b0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T04:39:36.2689895+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='edf2b076-6249-4766-a028-3ee18b535289' (Nullable = true), @p8='2025-10-02T04:39:36.2689903+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:09:36.272 +05:30 [INF] [CustomAPI:"8e5d7b8c-0857-4409-877e-a5114c46cdc6"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:09:36.274 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:09:36.275 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 1903.7201ms
2025-10-02 10:09:36.276 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:09:36.277 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 1912.2073ms
2025-10-02 10:09:45.230 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:45.2276806+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:09:48.248 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 479
2025-10-02 10:09:48.250 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:09:48.251 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:09:48.253 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVDNzk5NzY2RUI2QUZEQjM0QTZFQUM3RTI0NEUyRjUA","timestamp":"1759379989","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-10-02 10:09:48.255 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:09:48.255 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVDNzk5NzY2RUI2QUZEQjM0QTZFQUM3RTI0NEUyRjUA","timestamp":"1759379989","text":{"body":"Hi"},"type":"text"}]},"field":"messages"}]}]}
2025-10-02 10:09:48.255 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:09:48.256 +05:30 [INF] 💬 Routing to InboundMessageProcessor (type: text)
2025-10-02 10:09:48.257 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.6524ms
2025-10-02 10:09:48.259 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:09:48.260 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.4253ms
2025-10-02 10:09:48.266 +05:30 [WRN] Collection navigations are only considered null if their parent entity is null. Use 'Any' to check whether collection navigation 'Business.WhatsAppSettings' is empty.
2025-10-02 10:09:48.277 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."PlanId", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", w0."Id", w0."ApiKey", w0."ApiUrl", w0."BusinessId", w0."CreatedAt", w0."IsActive", w0."PhoneNumberId", w0."Provider", w0."SenderDisplayName", w0."UpdatedAt", w0."WabaId", w0."WebhookCallbackUrl", w0."WebhookSecret", w0."WebhookVerifyToken", w0."WhatsAppBusinessNumber"
FROM "Businesses" AS b
LEFT JOIN "WhatsAppSettings" AS w0 ON b."Id" = w0."BusinessId"
WHERE EXISTS (
    SELECT 1
    FROM "WhatsAppSettings" AS w
    WHERE b."Id" = w."BusinessId" AND w."WhatsAppBusinessNumber" IS NOT NULL)
ORDER BY b."Id"
2025-10-02 10:09:48.282 +05:30 [INF] FindOrCreateAsync: businessId="8390da76-10de-4d76-80f2-68b68f4e2b82", rawPhone=918974005240, normalized=+918974005240
2025-10-02 10:09:48.287 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82', @__normalized_1='+918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__normalized_1
LIMIT 1
2025-10-02 10:09:48.289 +05:30 [INF] Contact already exists: contactId="d33e1a11-bb37-4360-aacf-7c376a298d78"
2025-10-02 10:09:48.296 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82', @__phoneDigits_1='918974005240', @__phoneE164_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__phoneDigits_1 OR c."PhoneNumber" = @__phoneE164_2)
LIMIT 1
2025-10-02 10:09:48.304 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82', @__contactId_1='d33e1a11-bb37-4360-aacf-7c376a298d78'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ContactId", c."LastUpdatedAt", c."Mode", c."UpdatedBy"
FROM "ChatSessionStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."ContactId" = @__contactId_1
LIMIT 1
2025-10-02 10:09:48.320 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='b0ed4efb-3a54-457b-b40a-964bd3030feb', @p1='8390da76-10de-4d76-80f2-68b68f4e2b82', @p2=NULL, @p3=NULL (DbType = Guid), @p4=NULL (DbType = Guid), @p5=NULL (DbType = Guid), @p6='d33e1a11-bb37-4360-aacf-7c376a298d78' (Nullable = true), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T04:39:48.3062891Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='True', @p15=NULL, @p16='Hi' (Nullable = false), @p17=NULL, @p18=NULL (DbType = Decimal), @p19=NULL, @p20=NULL, @p21=NULL, @p22=NULL, @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T04:39:48.3062892Z' (Nullable = true) (DbType = DateTime), @p28=NULL, @p29='received' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:09:48.333 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82', @__keyword_2='hi'], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."BusinessId", a."CreatedAt", a."EdgesJson", a."IsActive", a."Name", a."NodesJson", a."TriggerKeyword", a."UpdatedAt"
FROM "AutomationFlows" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."TriggerKeyword" ILIKE @__keyword_2 ESCAPE '' AND a."IsActive"
LIMIT 1
2025-10-02 10:09:48.335 +05:30 [INF] TryRun: No matching automation flow found for keyword: 'hi'
2025-10-02 10:09:48.336 +05:30 [INF] 🕵️ No automation flow matched keyword: hi
2025-10-02 10:09:48.336 +05:30 [INF] 🚫 Skipping inbox sync: chat mode is not 'agent'
2025-10-02 10:09:55.244 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:39:55.2425283+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:05.249 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:05.2474792+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:15.260 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:15.2586935+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:21.978 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:10:21.981 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:10:21.981 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:10:21.987 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:21.989 +05:30 [INF] [CustomAPI:"afa25230-47cf-40ae-a77a-7f577f74998d"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:10:21.992 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:10:21.994 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:21.995 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:22.694 +05:30 [INF] Received HTTP response headers after 698.4836ms - 200
2025-10-02 10:10:22.695 +05:30 [INF] End processing HTTP request after 701.3453ms - 200
2025-10-02 10:10:22.747 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:10:22.749 +05:30 [INF] [CustomAPI:"afa25230-47cf-40ae-a77a-7f577f74998d"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:10:22.752 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:10:22.755 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:10:22.757 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:22.757 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:23.393 +05:30 [INF] Received HTTP response headers after 635.148ms - 200
2025-10-02 10:10:23.395 +05:30 [INF] End processing HTTP request after 638.2454ms - 200
2025-10-02 10:10:23.398 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='03619de6-bd22-41b6-9a38-06a1d6c4db94', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T04:40:23.3964364Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T04:40:23.3964364Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:10:23.402 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__messageLogId_0='03619de6-bd22-41b6-9a38-06a1d6c4db94', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:10:23.405 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='5615a817-28ef-4c00-8502-39561dfb28ca', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T04:40:23.4043149+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='03619de6-bd22-41b6-9a38-06a1d6c4db94' (Nullable = true), @p8='2025-10-02T04:40:23.4043159+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:10:23.407 +05:30 [INF] [CustomAPI:"afa25230-47cf-40ae-a77a-7f577f74998d"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:10:23.409 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:10:23.409 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 1426.5886ms
2025-10-02 10:10:23.410 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:10:23.411 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 1432.7452ms
2025-10-02 10:10:25.271 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:25.2697860+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:29.994 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:10:29.997 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:29.998 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:29.999 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"sent","timestamp":"1759380031","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","expiration_timestamp":"1759380031","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.000 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:30.001 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"sent","timestamp":"1759380031","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","expiration_timestamp":"1759380031","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.001 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:30.002 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:30.003 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.019ms
2025-10-02 10:10:30.005 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.006 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:30.008 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.009 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.3318ms
2025-10-02 10:10:30.011 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:30.016 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='edf2b076-6249-4766-a028-3ee18b535289', @p0='marketing', @p1='a7843cac69e479217654dc79b1732f37', @p2='2025-10-01T04:40:31.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='2f0c89c4-41ac-47e9-9cfe-21f74b9c1ee4', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='a7843cac69e479217654dc79b1732f37', @p9='2025-10-02T04:40:30.0104853+00:00' (DbType = DateTime), @p10='pricing_update' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T04:40:31.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"sent","timestamp":"1759380031","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","expiration_timestamp":"1759380031","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==', @p19='d0ad49d4-ffff-47f9-bb5b-0bb3724905f2', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='a7843cac69e479217654dc79b1732f37', @p23='2025-10-02T04:40:30.0077096+00:00' (DbType = DateTime), @p24='sent' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T04:40:31.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"sent","timestamp":"1759380031","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","expiration_timestamp":"1759380031","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:10:30.019 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:30.022 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:30.575 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:10:30.577 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:30.578 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:30.580 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"sent","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","expiration_timestamp":"1759380032","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.582 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:30.582 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"sent","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","expiration_timestamp":"1759380032","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.582 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:30.583 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:30.584 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.3013ms
2025-10-02 10:10:30.587 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.588 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:30.591 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.591 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.9002ms
2025-10-02 10:10:30.594 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:30.600 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='03619de6-bd22-41b6-9a38-06a1d6c4db94', @p0='marketing', @p1='e1f9981a4fd72ffcf39b06d85663dade', @p2='2025-10-01T04:40:32.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='52512878-2dc8-4dae-a3ec-09338971d302', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='e1f9981a4fd72ffcf39b06d85663dade', @p9='2025-10-02T04:40:30.5931488+00:00' (DbType = DateTime), @p10='pricing_update' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T04:40:32.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"sent","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","expiration_timestamp":"1759380032","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==', @p19='c2379822-aba8-436c-9499-508561cf8f75', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='e1f9981a4fd72ffcf39b06d85663dade', @p23='2025-10-02T04:40:30.5899183+00:00' (DbType = DateTime), @p24='sent' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T04:40:32.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"sent","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","expiration_timestamp":"1759380032","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:10:30.603 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:30.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:30.714 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:10:30.717 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:30.718 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:30.719 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.720 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:30.721 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:30.721 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:30.722 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:30.723 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.9639ms
2025-10-02 10:10:30.725 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.726 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:30.729 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:30.729 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.9399ms
2025-10-02 10:10:30.732 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:30.737 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='6f142ad7-caab-4155-98b9-26e3ba9462d1', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='a7843cac69e479217654dc79b1732f37', @p4='2025-10-02T04:40:30.7281897+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:32.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"a7843cac69e479217654dc79b1732f37","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:10:30.739 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:30.742 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzBBN0JDMjI4MzY1NjVEODZBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:30.745 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='edf2b076-6249-4766-a028-3ee18b535289', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:10:31.130 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:10:31.133 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:31.134 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:31.136 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:31.137 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:31.138 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:31.138 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:31.139 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:31.140 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.642ms
2025-10-02 10:10:31.144 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:31.144 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:31.147 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:31.148 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.7034ms
2025-10-02 10:10:31.151 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:31.157 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='a3d638ed-9b26-4f81-afb4-b23af855b814', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='e1f9981a4fd72ffcf39b06d85663dade', @p4='2025-10-02T04:40:31.1464538+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:32.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA==","status":"read","timestamp":"1759380032","recipient_id":"918974005240","conversation":{"id":"e1f9981a4fd72ffcf39b06d85663dade","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:10:31.160 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:31.164 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEY3MkFEMDUwQTEyMjQxNDYyAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:31.167 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='03619de6-bd22-41b6-9a38-06a1d6c4db94', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:10:35.292 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:35.2901197+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:36.414 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 601
2025-10-02 10:10:36.416 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:36.417 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:36.419 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2RDc4RkUyNjJDRERBRDNGN0I1RUE5REJEQ0QxQzYA","timestamp":"1759380037","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:10:36.421 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:36.421 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2RDc4RkUyNjJDRERBRDNGN0I1RUE5REJEQ0QxQzYA","timestamp":"1759380037","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:10:36.421 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:36.422 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:10:36.423 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.1843ms
2025-10-02 10:10:36.424 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:10:36.425 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:36.425 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2RDc4RkUyNjJDRERBRDNGN0I1RUE5REJEQ0QxQzYA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==, Text: No
2025-10-02 10:10:36.426 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.0827ms
2025-10-02 10:10:36.429 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:10:36.434 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:36.437 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:10:36.440 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:10:36.442 +05:30 [INF] 🟨 Falling back to single available link for step "f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:10:36.442 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:10:36.445 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:10:36.448 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:10:36.451 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='90d7adc3-f42b-4b0b-9998-199feba27ac9', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:40:36.4498706Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p9=NULL, @p10='142e72f8-8195-4c37-bc19-8554c265c046' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='No'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:10:36.454 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:10:36.457 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='4', @p1='Yes/Show Me Template 2/Show Me Template 3/No' (Nullable = false), @p2='No', @p3='2025-10-02T04:40:36.4562687Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:10:36.459 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:10:36.461 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:10:36.464 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:36.467 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:36.470 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:10:36.471 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:10:36.472 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:10:37.634 +05:30 [INF] Received HTTP response headers after 1160.4199ms - 200
2025-10-02 10:10:37.635 +05:30 [INF] End processing HTTP request after 1164.051ms - 200
2025-10-02 10:10:37.637 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:10:37.639 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:10:37.643 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:10:37.648 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:10:37.650 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:37.651 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:38.663 +05:30 [INF] Received HTTP response headers after 1011.1854ms - 200
2025-10-02 10:10:38.665 +05:30 [INF] End processing HTTP request after 1014.9097ms - 200
2025-10-02 10:10:38.727 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:38.730 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:10:38.733 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:10:38.737 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:10:38.739 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:38.741 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:39.807 +05:30 [INF] Received HTTP response headers after 1065.0585ms - 200
2025-10-02 10:10:39.808 +05:30 [INF] End processing HTTP request after 1068.6869ms - 200
2025-10-02 10:10:39.812 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='b36a0738-314a-4dad-8cc8-2d7a998438f1', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:40:39.8104227Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","message_status":"accepted"}]}', @p10='e5988888-1bfc-4762-a6f2-9b217e224fec' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:40:39.8102568Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:40:39.8102579Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:10:41.052 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:10:41.055 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:41.056 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:41.058 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"sent","timestamp":"1759380042","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","expiration_timestamp":"1759380042","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:41.059 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:41.059 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"sent","timestamp":"1759380042","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","expiration_timestamp":"1759380042","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:41.060 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:41.063 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:10:41.063 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.8913ms
2025-10-02 10:10:41.065 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:41.066 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:41.069 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:41.069 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.3293ms
2025-10-02 10:10:41.072 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:41.077 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:41.080 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='9163dd81bdc9639941b2cc82b3241536'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:41.083 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='5a07776c-bc5a-4bd3-8631-33c4d7901ee0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='9163dd81bdc9639941b2cc82b3241536', @p4='2025-10-02T04:40:41.0764526+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:42.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"sent","timestamp":"1759380042","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","expiration_timestamp":"1759380042","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==', @p14='d4aca3ef-5b25-4e4e-bb8e-333c17ea5d16', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='9163dd81bdc9639941b2cc82b3241536', @p18='2025-10-02T04:40:41.0713938+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:40:42.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"sent","timestamp":"1759380042","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","expiration_timestamp":"1759380042","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:10:41.106 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:41.110 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:41.614 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:10:41.616 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:41.617 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:41.619 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"read","timestamp":"1759380043","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:41.620 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:41.620 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"read","timestamp":"1759380043","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:41.621 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:41.622 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:41.623 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.1976ms
2025-10-02 10:10:41.626 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:41.626 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:41.629 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:41.629 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.2885ms
2025-10-02 10:10:41.632 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:41.638 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='9163dd81bdc9639941b2cc82b3241536'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:41.662 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@p0='9ddb035d-9f20-4a1a-95f2-c51ff7ba7000', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='9163dd81bdc9639941b2cc82b3241536', @p4='2025-10-02T04:40:41.6280463+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:43.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==","status":"read","timestamp":"1759380043","recipient_id":"918974005240","conversation":{"id":"9163dd81bdc9639941b2cc82b3241536","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:10:41.666 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:41.670 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:41.674 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:10:45.137 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:10:45.140 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:45.141 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:45.143 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOEYzQkYyRDQ3QkRGQTU4NUQ0RjQ0MzZBQTYzREEA","timestamp":"1759380046","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:10:45.145 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:45.145 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOEYzQkYyRDQ3QkRGQTU4NUQ0RjQ0MzZBQTYzREEA","timestamp":"1759380046","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:10:45.146 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:45.147 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:10:45.148 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.1621ms
2025-10-02 10:10:45.149 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:10:45.150 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:45.151 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOEYzQkYyRDQ3QkRGQTU4NUQ0RjQ0MzZBQTYzREEA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA==, Text: Show Me Template 2
2025-10-02 10:10:45.152 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.5972ms
2025-10-02 10:10:45.155 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:10:45.160 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQ0EyMDMwNkEwM0YzMDcwNUU3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:45.163 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:10:45.166 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:10:45.170 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:10:45.190 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p0='0c90d4c7-2021-48a0-a169-399275130a08', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:40:45.1722850Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80' (Nullable = true), @p9=NULL, @p10='3dc40cbd-67fb-490f-8f3c-38b5694971d3' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:10:45.194 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:10:45.198 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p3='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='5', @p1='Show Me Template 2', @p2='2025-10-02T04:40:45.1968708Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "LastButtonText" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
2025-10-02 10:10:45.200 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:10:45.203 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:10:45.206 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:45.209 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:45.212 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:10:45.214 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:10:45.215 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:10:45.305 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:45.3038878+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:10:46.540 +05:30 [INF] Received HTTP response headers after 1323.6325ms - 200
2025-10-02 10:10:46.541 +05:30 [INF] End processing HTTP request after 1327.0767ms - 200
2025-10-02 10:10:46.543 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:10:46.544 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:10:46.547 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:10:46.550 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:10:46.553 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:46.554 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:10:47.494 +05:30 [INF] Received HTTP response headers after 939.6133ms - 200
2025-10-02 10:10:47.496 +05:30 [INF] End processing HTTP request after 943.0722ms - 200
2025-10-02 10:10:47.545 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:10:47.547 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:10:47.550 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:10:47.552 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:10:47.555 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:47.555 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:10:48.994 +05:30 [INF] Received HTTP response headers after 1437.6136ms - 200
2025-10-02 10:10:48.995 +05:30 [INF] End processing HTTP request after 1440.7026ms - 200
2025-10-02 10:10:48.999 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='f43847ad-3bfb-4251-85a5-932e5aeaf6e5', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:40:48.9969801Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='e9781f97-dc13-46d5-a879-b2996dbb6526' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","message_status":"accepted"}]}', @p10='13a83e06-3ede-4e79-91eb-5282e30ae1f0' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='e9781f97-dc13-46d5-a879-b2996dbb6526', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:40:48.9967663Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='c3f00fb5-2158-4e5d-9ab0-b46d605bbf80' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:40:48.9967671Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:10:50.380 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:10:50.382 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:50.383 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:50.385 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"sent","timestamp":"1759380051","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","expiration_timestamp":"1759380051","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:50.386 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:50.386 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"sent","timestamp":"1759380051","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","expiration_timestamp":"1759380051","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:50.387 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:50.388 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:50.389 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.1468ms
2025-10-02 10:10:50.392 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:50.392 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:50.395 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:50.396 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.7243ms
2025-10-02 10:10:50.399 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:50.405 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='ba82981f541a475cbfb3a1bf56ca765e'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:50.409 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='c1ff1796-d3c6-4d6f-8adb-da759b41c95a', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='ba82981f541a475cbfb3a1bf56ca765e', @p4='2025-10-02T04:40:50.3980058+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:51.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"sent","timestamp":"1759380051","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","expiration_timestamp":"1759380051","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==', @p14='de9f1131-8069-4ade-bafb-8415f2685c80', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='ba82981f541a475cbfb3a1bf56ca765e', @p18='2025-10-02T04:40:50.3941952+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:40:51.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"sent","timestamp":"1759380051","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","expiration_timestamp":"1759380051","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:10:50.417 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:50.420 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:50.717 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:10:50.719 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:50.720 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:50.721 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"read","timestamp":"1759380052","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:50.722 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:50.723 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"read","timestamp":"1759380052","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:10:50.723 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:50.724 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:10:50.725 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.3334ms
2025-10-02 10:10:50.728 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:50.728 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:50.731 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:10:50.732 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.1256ms
2025-10-02 10:10:50.734 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:50.740 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='ba82981f541a475cbfb3a1bf56ca765e'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:50.760 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p0='b07285ff-2ddc-455a-804d-ab4c58cc4929', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='ba82981f541a475cbfb3a1bf56ca765e', @p4='2025-10-02T04:40:50.7304359+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:40:52.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==","status":"read","timestamp":"1759380052","recipient_id":"918974005240","conversation":{"id":"ba82981f541a475cbfb3a1bf56ca765e","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:10:50.764 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:10:50.767 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:10:50.771 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='e9781f97-dc13-46d5-a879-b2996dbb6526', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:10:54.957 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:10:54.960 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:54.961 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:10:54.963 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCQUM0RENGNjFFRTlFMjZCNDlCQzkxMTY3RDIxNUUA","timestamp":"1759380056","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:10:54.965 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:10:54.965 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCQUM0RENGNjFFRTlFMjZCNDlCQzkxMTY3RDIxNUUA","timestamp":"1759380056","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:10:54.965 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:10:54.966 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:10:54.968 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.137ms
2025-10-02 10:10:54.969 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:10:54.970 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:10:54.971 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCQUM0RENGNjFFRTlFMjZCNDlCQzkxMTY3RDIxNUUA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==, Text: Show Me Template 1
2025-10-02 10:10:54.972 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.6251ms
2025-10-02 10:10:54.975 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:10:54.980 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='e9781f97-dc13-46d5-a879-b2996dbb6526' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:10:54.983 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:10:54.986 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:10:54.988 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzI0NkNGOTk4ODgxMzM4NDVFAA==, Text='Show Me Template 1'
2025-10-02 10:10:55.338 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:40:55.3356258+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:05.408 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:41:05.3535057+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:15.417 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:41:15.4154472+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:20.194 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 601
2025-10-02 10:11:20.197 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:20.198 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:20.200 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyNDJFMDQxNjYwOUNDQjU3ODlGMkE0RjUyNzVDODQA","timestamp":"1759380081","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:11:20.201 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:20.201 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyNDJFMDQxNjYwOUNDQjU3ODlGMkE0RjUyNzVDODQA","timestamp":"1759380081","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:11:20.202 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:20.203 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:11:20.204 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.7467ms
2025-10-02 10:11:20.205 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:11:20.206 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:20.206 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUyNDJFMDQxNjYwOUNDQjU3ODlGMkE0RjUyNzVDODQA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==, Text: No
2025-10-02 10:11:20.207 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.0211ms
2025-10-02 10:11:20.211 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:11:20.216 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:20.218 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:11:20.221 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:11:20.223 +05:30 [INF] 🟨 Falling back to single available link for step "f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:11:20.224 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:11:20.226 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:11:20.229 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:11:20.232 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='4f4e2096-3d3f-4b18-8fd6-f2079052482d', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:41:20.2312838Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p9=NULL, @p10='63b13198-ad8f-400c-9f43-e11fae7e414a' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='No'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:11:20.235 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:11:20.238 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p3='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='6', @p1='No', @p2='2025-10-02T04:41:20.2372820Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "LastButtonText" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
2025-10-02 10:11:20.240 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:11:20.243 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:11:20.246 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:20.248 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:20.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:11:20.253 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:11:20.254 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:11:21.495 +05:30 [INF] Received HTTP response headers after 1240.1587ms - 200
2025-10-02 10:11:21.497 +05:30 [INF] End processing HTTP request after 1243.5976ms - 200
2025-10-02 10:11:21.498 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:11:21.499 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:11:21.503 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:11:21.507 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:11:21.509 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:11:21.510 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:11:22.268 +05:30 [INF] Received HTTP response headers after 756.9411ms - 200
2025-10-02 10:11:22.270 +05:30 [INF] End processing HTTP request after 760.8788ms - 200
2025-10-02 10:11:22.309 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:22.311 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:11:22.315 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:11:22.318 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:11:22.320 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:11:22.321 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:11:23.140 +05:30 [INF] Received HTTP response headers after 817.8408ms - 200
2025-10-02 10:11:23.141 +05:30 [INF] End processing HTTP request after 821.4787ms - 200
2025-10-02 10:11:23.146 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='7a9e8597-0d77-48de-b49e-c45e65d015ea', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:41:23.1434302Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='252f7aa9-e6ed-4469-ba5f-621565fe700f' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","message_status":"accepted"}]}', @p10='8a96601c-b295-4fb2-9d76-62e6e10b3cf9' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='252f7aa9-e6ed-4469-ba5f-621565fe700f', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:41:23.1431853Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:41:23.1431863Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:11:24.318 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:11:24.321 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:24.322 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:24.324 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"sent","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","expiration_timestamp":"1759380086","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:24.325 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:24.325 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"sent","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","expiration_timestamp":"1759380086","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:24.326 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:24.327 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:11:24.328 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.6804ms
2025-10-02 10:11:24.332 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:24.332 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:24.335 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:24.335 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.1916ms
2025-10-02 10:11:24.338 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:24.343 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='84e5f16ac53f3b829a75c7b2a8417eec'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:24.346 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='5b2527a7-c3ed-4b84-9a7c-1844b2d7b658', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='84e5f16ac53f3b829a75c7b2a8417eec', @p4='2025-10-02T04:41:24.3338985+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:41:26.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"sent","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","expiration_timestamp":"1759380086","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==', @p14='e41ebf28-f574-4664-b073-6a1410249e70', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='84e5f16ac53f3b829a75c7b2a8417eec', @p18='2025-10-02T04:41:24.3375514+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:41:26.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"sent","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","expiration_timestamp":"1759380086","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:11:24.369 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:11:24.373 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:11:25.087 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:11:25.090 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:25.091 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:25.092 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"read","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:25.094 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:25.094 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"read","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:25.095 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:25.095 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:11:25.097 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.5252ms
2025-10-02 10:11:25.099 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:25.100 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:25.103 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:25.104 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 16.8776ms
2025-10-02 10:11:25.107 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:25.112 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='84e5f16ac53f3b829a75c7b2a8417eec'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:25.134 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='ce6e9a45-d213-4fbf-8017-769beea0b177', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='84e5f16ac53f3b829a75c7b2a8417eec', @p4='2025-10-02T04:41:25.1023318+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:41:26.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==","status":"read","timestamp":"1759380086","recipient_id":"918974005240","conversation":{"id":"84e5f16ac53f3b829a75c7b2a8417eec","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:11:25.138 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:11:25.141 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:11:25.145 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='252f7aa9-e6ed-4469-ba5f-621565fe700f', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:11:25.430 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:41:25.4284143+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:35.435 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:41:35.4342528+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:40.120 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:11:40.123 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:40.124 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:40.126 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCN0E3MUVFQUExQ0Y0Q0Y0RUFCMDM5QjVGOUUwMUYA","timestamp":"1759380101","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:11:40.128 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:40.128 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCN0E3MUVFQUExQ0Y0Q0Y0RUFCMDM5QjVGOUUwMUYA","timestamp":"1759380101","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:11:40.128 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:40.129 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:11:40.131 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.9728ms
2025-10-02 10:11:40.131 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:11:40.132 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:40.133 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCN0E3MUVFQUExQ0Y0Q0Y0RUFCMDM5QjVGOUUwMUYA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA==, Text: Show Me Template 2
2025-10-02 10:11:40.134 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.0775ms
2025-10-02 10:11:40.137 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:11:40.142 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='252f7aa9-e6ed-4469-ba5f-621565fe700f' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjAzRTA0NkI1N0I4RDJDRTE2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:40.145 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:11:40.148 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:11:40.151 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:11:40.154 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='e7ca4700-6e9b-4675-bd23-6ee2dca391c0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:41:40.1529824Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='252f7aa9-e6ed-4469-ba5f-621565fe700f' (Nullable = true), @p9=NULL, @p10='e241205c-cf39-464b-851f-a9e7d54c7db4' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:11:40.157 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:11:40.160 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p3='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='7', @p1='Show Me Template 2', @p2='2025-10-02T04:41:40.1591253Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "LastButtonText" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
2025-10-02 10:11:40.162 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:11:40.164 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:11:40.167 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:40.170 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:40.173 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:11:40.174 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:11:40.176 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:11:41.391 +05:30 [INF] Received HTTP response headers after 1214.5521ms - 200
2025-10-02 10:11:41.393 +05:30 [INF] End processing HTTP request after 1218.1699ms - 200
2025-10-02 10:11:41.394 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:11:41.395 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:11:41.399 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:11:41.402 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:11:41.405 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:11:41.406 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:11:42.270 +05:30 [INF] Received HTTP response headers after 862.4256ms - 200
2025-10-02 10:11:42.271 +05:30 [INF] End processing HTTP request after 866.4011ms - 200
2025-10-02 10:11:42.398 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:11:42.400 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:11:42.404 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:11:42.407 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:11:42.409 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:11:42.410 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:11:43.289 +05:30 [INF] Received HTTP response headers after 877.8744ms - 200
2025-10-02 10:11:43.290 +05:30 [INF] End processing HTTP request after 881.5647ms - 200
2025-10-02 10:11:43.294 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='f2ef1cbd-32c9-4fcb-b3e8-3b4536795045', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:41:43.2922068Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='2124c368-4532-4b37-a827-5f83a556ada9' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","message_status":"accepted"}]}', @p10='656cd868-5fa3-4eab-b4ee-34d67b4e0cc6' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='2124c368-4532-4b37-a827-5f83a556ada9', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:41:43.2920712Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='252f7aa9-e6ed-4469-ba5f-621565fe700f' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:41:43.2920721Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:11:44.398 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:11:44.400 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:44.401 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:44.403 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"sent","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","expiration_timestamp":"1759380106","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:44.405 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:44.405 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"sent","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","expiration_timestamp":"1759380106","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:44.406 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:44.406 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:11:44.408 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.8504ms
2025-10-02 10:11:44.411 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:44.412 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:44.415 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:44.415 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.3288ms
2025-10-02 10:11:44.418 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:44.423 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='b89d21950a0f275ab98776634887019d'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:44.427 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='bd9192de-03a5-4b47-8034-33afcd11f33c', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='b89d21950a0f275ab98776634887019d', @p4='2025-10-02T04:41:44.4140763+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:41:46.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"sent","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","expiration_timestamp":"1759380106","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==', @p14='d00cba24-e7d1-4e97-b5b9-43ef0a5fbad6', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='b89d21950a0f275ab98776634887019d', @p18='2025-10-02T04:41:44.4174085+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:41:46.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"sent","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","expiration_timestamp":"1759380106","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:11:44.431 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:11:44.435 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:11:45.057 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:11:45.060 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:45.061 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:45.063 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"read","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:45.064 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:45.064 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"read","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:11:45.065 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:45.066 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:11:45.067 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.3721ms
2025-10-02 10:11:45.070 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:45.071 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:45.079 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:11:45.079 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.3921ms
2025-10-02 10:11:45.082 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:45.087 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='b89d21950a0f275ab98776634887019d'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:45.090 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='8274eef8-4d56-43bc-bb40-a9b505d68a40', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='b89d21950a0f275ab98776634887019d', @p4='2025-10-02T04:41:45.0777039+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:41:46.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==","status":"read","timestamp":"1759380106","recipient_id":"918974005240","conversation":{"id":"b89d21950a0f275ab98776634887019d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:11:45.094 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:11:45.097 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:11:45.100 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='2124c368-4532-4b37-a827-5f83a556ada9', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:11:45.445 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:41:45.4437891+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:11:54.184 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:11:54.186 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:54.187 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:11:54.188 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVENkYyNkMyOUE5ODRCOUM3NTBCREI0QTA4MjhBMjIA","timestamp":"1759380115","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:11:54.190 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:11:54.190 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVENkYyNkMyOUE5ODRCOUM3NTBCREI0QTA4MjhBMjIA","timestamp":"1759380115","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:11:54.190 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:11:54.191 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:11:54.192 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.9235ms
2025-10-02 10:11:54.193 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:11:54.194 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:11:54.194 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVENkYyNkMyOUE5ODRCOUM3NTBCREI0QTA4MjhBMjIA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==, Text: Show Me Template 1
2025-10-02 10:11:54.195 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 11.5364ms
2025-10-02 10:11:54.198 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:11:54.203 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='2124c368-4532-4b37-a827-5f83a556ada9' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:11:54.205 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:11:54.208 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:11:54.210 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQjBBRkE2MEREQUU1OEYwRDk2AA==, Text='Show Me Template 1'
2025-10-02 10:11:55.463 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:41:55.4612418+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:05.491 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:05.4887583+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:15.495 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:15.4931953+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:25.504 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:25.5022589+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:35.511 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:35.5094243+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:45.524 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:45.5224293+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:12:55.537 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:42:55.5360171+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:05.549 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:05.5469107+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:15.563 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:15.5617424+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:25.569 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:25.5679681+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:35.578 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:35.5767669+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:45.588 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:45.5853471+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:13:55.597 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:43:55.5954000+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:05.603 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:05.6019324+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:15.619 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:15.6175546+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:25.623 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:25.6215086+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:35.630 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:35.6287467+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:45.640 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:45.6384490+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:14:55.649 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:44:55.6473365+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:05.657 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:05.6553661+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:15.663 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:15.6622252+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:25.670 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:25.6686739+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:35.681 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:35.6786890+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:45.689 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:45.6881851+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:15:55.707 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:45:55.7052662+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:05.776 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:46:05.7228647+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:15.784 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:46:15.7826331+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:25.792 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:46:25.7909959+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:35.803 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:46:35.8010408+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:45.807 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:46:45.8046091+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:16:55.818 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:46:55.8166644+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:05.825 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:05.8233480+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:15.833 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:15.8316656+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:25.845 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:25.8432814+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:35.854 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:35.8519610+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:45.861 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:45.8599951+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:17:55.869 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:47:55.8676641+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:05.878 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:48:05.8770074+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:15.884 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:48:15.8819670+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:25.896 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:48:25.8948421+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:35.905 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:48:35.9038738+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:45.912 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:48:45.9101329+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:18:55.935 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:48:55.9336473+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:05.945 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:05.9429457+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:15.956 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:15.9545509+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:25.962 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:25.9608839+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:35.978 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:35.9767538+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:45.981 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:45.9800596+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:19:56.009 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:49:56.0073288+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:06.027 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:50:06.0251893+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:16.041 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:50:16.0389477+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:26.044 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:50:26.0415698+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:36.061 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:50:36.0594532+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:46.070 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:50:46.0682009+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:20:56.090 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:50:56.0883029+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:06.157 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:06.1013650+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:16.162 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:16.1601884+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:26.180 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:26.1786131+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:36.194 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:36.1924456+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:46.212 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:46.2107911+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:21:56.220 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:51:56.2184757+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:06.239 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:52:06.2367697+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:16.247 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:52:16.2453508+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:26.261 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:52:26.2597365+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:36.269 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:52:36.2673929+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:46.282 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:52:46.2801281+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:22:56.296 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:52:56.2939791+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:06.315 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:53:06.3138020+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:16.334 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:53:16.3325390+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:26.350 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:53:26.3481516+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:36.365 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:53:36.3625446+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:46.371 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:53:46.3691187+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:23:56.386 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:53:56.3849151+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:06.398 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:54:06.3964215+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:16.418 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:54:16.4157087+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:26.441 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:54:26.4395688+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:36.451 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:54:36.4493142+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:46.459 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:54:46.4567152+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:24:56.472 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:54:56.4708745+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:06.478 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:55:06.4751025+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:16.497 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:55:16.4955543+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:26.506 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:55:26.5048919+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:36.513 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:55:36.5115117+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:41.943 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:25:41.950 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:25:41.951 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:25:41.955 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:25:41.959 +05:30 [INF] [CustomAPI:"9078013f-47bf-4267-b082-5b8cd89526db"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:25:41.962 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:25:41.964 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:25:41.965 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:25:43.123 +05:30 [INF] Received HTTP response headers after 1156.6897ms - 200
2025-10-02 10:25:43.125 +05:30 [INF] End processing HTTP request after 1160.636ms - 200
2025-10-02 10:25:43.194 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:25:43.197 +05:30 [INF] [CustomAPI:"9078013f-47bf-4267-b082-5b8cd89526db"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:25:43.200 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:25:43.203 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:25:43.206 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:25:43.207 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:25:44.083 +05:30 [INF] Received HTTP response headers after 874.9912ms - 200
2025-10-02 10:25:44.084 +05:30 [INF] End processing HTTP request after 878.6443ms - 200
2025-10-02 10:25:44.109 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@p0='39be42dd-f8c3-4047-b6c6-f7a3fc927caf', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T04:55:44.0862749Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T04:55:44.0862749Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:25:44.114 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageLogId_0='39be42dd-f8c3-4047-b6c6-f7a3fc927caf', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:25:44.118 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='d9c21cbe-f32f-4e9a-ae04-d5dec25ea1f6', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T04:55:44.1162935+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='39be42dd-f8c3-4047-b6c6-f7a3fc927caf' (Nullable = true), @p8='2025-10-02T04:55:44.1162946+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:25:44.120 +05:30 [INF] [CustomAPI:"9078013f-47bf-4267-b082-5b8cd89526db"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:25:44.122 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:25:44.123 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 2170.5579ms
2025-10-02 10:25:44.124 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:25:44.125 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 2181.9195ms
2025-10-02 10:25:46.529 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:55:46.5275051+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:53.407 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:25:53.409 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:53.410 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:25:53.412 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"sent","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","expiration_timestamp":"1759380955","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:53.414 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:25:53.414 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"sent","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","expiration_timestamp":"1759380955","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:53.414 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:25:53.417 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:25:53.418 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.9705ms
2025-10-02 10:25:53.420 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:25:53.421 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:53.423 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:53.424 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 16.7109ms
2025-10-02 10:25:53.426 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:53.432 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:25:53.436 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='39be42dd-f8c3-4047-b6c6-f7a3fc927caf', @p0='marketing', @p1='06c0526ca17243291093d22579b99153', @p2='2025-10-01T04:55:55.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='87c85991-6d58-45f5-aa31-e2f71cd5358f', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='06c0526ca17243291093d22579b99153', @p9='2025-10-02T04:55:53.4309208+00:00' (DbType = DateTime), @p10='pricing_update' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T04:55:55.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"sent","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","expiration_timestamp":"1759380955","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==', @p19='aa3fa60a-4c7a-4038-8a0d-80e0e416915f', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='06c0526ca17243291093d22579b99153', @p23='2025-10-02T04:55:53.4257373+00:00' (DbType = DateTime), @p24='sent' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T04:55:55.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"sent","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","expiration_timestamp":"1759380955","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:25:53.459 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:25:53.462 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:25:53.846 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:25:53.849 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:53.850 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:25:53.852 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"read","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:53.853 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:25:53.853 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"read","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:53.854 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:25:53.855 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:25:53.856 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.8264ms
2025-10-02 10:25:53.860 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:53.860 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:53.863 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:53.864 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.7064ms
2025-10-02 10:25:53.867 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:25:53.890 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='de1b2afb-68b0-4d2c-92ef-34de2455c72f', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='06c0526ca17243291093d22579b99153', @p4='2025-10-02T04:55:53.8622924+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:55:55.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA==","status":"read","timestamp":"1759380955","recipient_id":"918974005240","conversation":{"id":"06c0526ca17243291093d22579b99153","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:25:53.893 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:25:53.897 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNEFFMDhCQjc2NUExOERBMzlDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:25:53.900 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='39be42dd-f8c3-4047-b6c6-f7a3fc927caf', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:25:55.766 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 601
2025-10-02 10:25:55.768 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:55.769 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:25:55.775 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOENGMjdGODc3OUFBMTcwRUIxQzc5N0QwQkM0RjgA","timestamp":"1759380957","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:25:55.778 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:25:55.778 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOENGMjdGODc3OUFBMTcwRUIxQzc5N0QwQkM0RjgA","timestamp":"1759380957","type":"button","button":{"payload":"No","text":"No"}}]},"field":"messages"}]}]}
2025-10-02 10:25:55.779 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:25:55.780 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:25:55.781 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.8425ms
2025-10-02 10:25:55.781 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:25:55.782 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:55.783 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCOENGMjdGODc3OUFBMTcwRUIxQzc5N0QwQkM0RjgA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA==, Text: No
2025-10-02 10:25:55.784 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 18.1898ms
2025-10-02 10:25:55.787 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:25:55.792 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMDc5MTMyMjBFQUY0MjVCMjA1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:25:55.795 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:25:55.798 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:25:55.800 +05:30 [INF] 🟨 Falling back to single available link for step "f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:25:55.801 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:25:55.804 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:25:55.807 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:25:55.828 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='d65fecf2-5ae9-4fe2-b83e-bf3d2ac15c33', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:55:55.8091431Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p9=NULL, @p10='90f43cf9-1cf0-4f38-80a9-3643ef93f4f6' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='No'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:25:55.832 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:25:55.835 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p3='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='8', @p1='No', @p2='2025-10-02T04:55:55.8341833Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "LastButtonText" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
2025-10-02 10:25:55.838 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:25:55.841 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:25:55.845 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:25:55.847 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:25:55.850 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:25:55.852 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:25:55.853 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:25:56.540 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:55:56.5389516+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:25:56.904 +05:30 [INF] Received HTTP response headers after 1050.0866ms - 200
2025-10-02 10:25:56.906 +05:30 [INF] End processing HTTP request after 1053.5311ms - 200
2025-10-02 10:25:56.907 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:25:56.908 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:25:56.912 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:25:56.916 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:25:56.919 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:25:56.920 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:25:57.684 +05:30 [INF] Received HTTP response headers after 762.4536ms - 200
2025-10-02 10:25:57.685 +05:30 [INF] End processing HTTP request after 766.2798ms - 200
2025-10-02 10:25:57.748 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:25:57.750 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:25:57.754 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:25:57.757 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:25:57.760 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:25:57.761 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:25:58.534 +05:30 [INF] Received HTTP response headers after 772.4434ms - 200
2025-10-02 10:25:58.535 +05:30 [INF] End processing HTTP request after 775.9269ms - 200
2025-10-02 10:25:58.539 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='9d2360e0-3473-4e44-8184-1febe3d9be44', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:55:58.5372960Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='fbc67b7b-c20b-433e-a5c2-0459f71bde28' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","message_status":"accepted"}]}', @p10='dbad011b-0813-47fc-80be-0c882b25e554' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='fbc67b7b-c20b-433e-a5c2-0459f71bde28', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:55:58.5371500Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='877bb569-3347-4cd5-b042-a7ae85ceda18' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:55:58.5371510Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:25:59.662 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:25:59.664 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:59.666 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:25:59.668 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"sent","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","expiration_timestamp":"1759380961","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:59.669 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:25:59.669 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"sent","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","expiration_timestamp":"1759380961","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:25:59.670 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:25:59.671 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:25:59.673 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.0335ms
2025-10-02 10:25:59.675 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:59.676 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:25:59.679 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:25:59.679 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.8014ms
2025-10-02 10:25:59.683 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:25:59.689 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='c26932004a8418c368ebe7dca7ba6474'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:25:59.692 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='74fcc3d5-5fdc-4d81-a2c8-80cce151e11f', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='c26932004a8418c368ebe7dca7ba6474', @p4='2025-10-02T04:55:59.6781857+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:56:01.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"sent","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","expiration_timestamp":"1759380961","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==', @p14='c1e919cc-d11c-4d60-8a4d-bcbdb537d296', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='c26932004a8418c368ebe7dca7ba6474', @p18='2025-10-02T04:55:59.6816311+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:56:01.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"sent","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","expiration_timestamp":"1759380961","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:25:59.696 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:25:59.700 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:26:00.028 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:26:00.031 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:00.031 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:26:00.033 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"read","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:00.034 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:26:00.035 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"read","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:00.035 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:26:00.036 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:26:00.037 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.8436ms
2025-10-02 10:26:00.040 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:00.040 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:00.043 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:00.044 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.1976ms
2025-10-02 10:26:00.047 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:00.053 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='c26932004a8418c368ebe7dca7ba6474'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:00.073 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p0='b18dbd3b-bc68-4a50-a252-dac6d3e5d86e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='c26932004a8418c368ebe7dca7ba6474', @p4='2025-10-02T04:56:00.0421902+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:56:01.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==","status":"read","timestamp":"1759380961","recipient_id":"918974005240","conversation":{"id":"c26932004a8418c368ebe7dca7ba6474","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:26:00.078 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:26:00.081 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:26:00.086 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='fbc67b7b-c20b-433e-a5c2-0459f71bde28', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:26:06.009 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:26:06.011 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:06.012 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:26:06.014 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVERDI0MUQ5MDg2RTU0QUExN0EzN0NEMkMyQzY1RUQA","timestamp":"1759380967","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:26:06.016 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:26:06.016 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVERDI0MUQ5MDg2RTU0QUExN0EzN0NEMkMyQzY1RUQA","timestamp":"1759380967","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:26:06.016 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:26:06.017 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:26:06.018 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.4384ms
2025-10-02 10:26:06.019 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:26:06.020 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:06.021 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVERDI0MUQ5MDg2RTU0QUExN0EzN0NEMkMyQzY1RUQA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA==, Text: Show Me Template 2
2025-10-02 10:26:06.021 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.6737ms
2025-10-02 10:26:06.024 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:26:06.029 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='fbc67b7b-c20b-433e-a5c2-0459f71bde28' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNjIzQkFGOEQzRTA3QTM0ODE4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:06.032 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:26:06.035 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:26:06.038 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:26:06.042 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='1900bd45-b6e4-499a-a3bc-dfa3a2e01b6b', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:56:06.0402356Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='fbc67b7b-c20b-433e-a5c2-0459f71bde28' (Nullable = true), @p9=NULL, @p10='f6fbb7d7-a551-47cd-8bb2-713126ea5128' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:26:06.045 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:26:06.048 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p3='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='9', @p1='Show Me Template 2', @p2='2025-10-02T04:56:06.0476022Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "LastButtonText" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
2025-10-02 10:26:06.050 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:26:06.053 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:26:06.056 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:26:06.059 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:26:06.061 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:26:06.063 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:26:06.064 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:26:06.602 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:06.5492833+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:26:07.460 +05:30 [INF] Received HTTP response headers after 1394.167ms - 200
2025-10-02 10:26:07.461 +05:30 [INF] End processing HTTP request after 1397.9414ms - 200
2025-10-02 10:26:07.463 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:26:07.464 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:26:07.469 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:26:07.474 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:26:07.476 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:26:07.478 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:26:08.404 +05:30 [INF] Received HTTP response headers after 924.8243ms - 200
2025-10-02 10:26:08.405 +05:30 [INF] End processing HTTP request after 928.9685ms - 200
2025-10-02 10:26:08.560 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:26:08.562 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:26:08.565 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:26:08.569 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:26:08.571 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:26:08.572 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:26:09.452 +05:30 [INF] Received HTTP response headers after 879.2765ms - 200
2025-10-02 10:26:09.454 +05:30 [INF] End processing HTTP request after 882.7614ms - 200
2025-10-02 10:26:09.458 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='d808df31-2e7b-408e-a8cc-2c191edc0eaa', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T04:56:09.4558308Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='a56cc3e7-9a5e-44f6-99e6-0e701a85611c' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","message_status":"accepted"}]}', @p10='74e5480e-1c3b-43b0-b636-ebcac5b43ea0' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='a56cc3e7-9a5e-44f6-99e6-0e701a85611c', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T04:56:09.4556986Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='fbc67b7b-c20b-433e-a5c2-0459f71bde28' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T04:56:09.4556997Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:26:10.521 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:26:10.524 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:10.525 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:26:10.527 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"sent","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","expiration_timestamp":"1759380972","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:10.528 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:26:10.528 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"sent","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","expiration_timestamp":"1759380972","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:10.529 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:26:10.530 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:26:10.531 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.6309ms
2025-10-02 10:26:10.535 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:10.535 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:10.538 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:10.539 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.9374ms
2025-10-02 10:26:10.542 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:10.548 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='da4cca5392edb647a7081aecc1f942e6'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:10.552 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='1945c5b1-0293-4127-9d41-63097c24b074', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='da4cca5392edb647a7081aecc1f942e6', @p4='2025-10-02T04:56:10.5375710+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:56:12.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"sent","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","expiration_timestamp":"1759380972","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==', @p14='3aaf678b-bc18-4b42-85ab-7168beaf9049', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='da4cca5392edb647a7081aecc1f942e6', @p18='2025-10-02T04:56:10.5411328+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T04:56:12.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"sent","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","expiration_timestamp":"1759380972","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:26:10.557 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:26:10.560 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:26:11.269 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:26:11.271 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:11.272 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:26:11.273 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"read","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:11.275 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:26:11.275 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"read","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:26:11.275 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:26:11.276 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:26:11.277 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.952ms
2025-10-02 10:26:11.280 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:11.280 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:11.283 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:26:11.284 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.0254ms
2025-10-02 10:26:11.286 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:11.292 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='da4cca5392edb647a7081aecc1f942e6'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:11.296 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='554e5b45-4275-4763-91a9-417b0ea23dc0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='da4cca5392edb647a7081aecc1f942e6', @p4='2025-10-02T04:56:11.2822767+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T04:56:12.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==","status":"read","timestamp":"1759380972","recipient_id":"918974005240","conversation":{"id":"da4cca5392edb647a7081aecc1f942e6","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:26:11.298 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:26:11.302 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:26:11.305 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='a56cc3e7-9a5e-44f6-99e6-0e701a85611c', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:26:16.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:16.6048825+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:26:26.622 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:26.6201406+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:26:33.048 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:26:33.051 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:33.052 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:26:33.054 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVEQTg1M0JBRjZEQTJDRjE5RDg5NTE3Q0RDNDMzNzgA","timestamp":"1759380994","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:26:33.055 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:26:33.055 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVEQTg1M0JBRjZEQTJDRjE5RDg5NTE3Q0RDNDMzNzgA","timestamp":"1759380994","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:26:33.056 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:26:33.056 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:26:33.058 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.3497ms
2025-10-02 10:26:33.058 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:26:33.059 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:26:33.060 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVEQTg1M0JBRjZEQTJDRjE5RDg5NTE3Q0RDNDMzNzgA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==, Text: Show Me Template 1
2025-10-02 10:26:33.061 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.7728ms
2025-10-02 10:26:33.064 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:26:33.069 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='a56cc3e7-9a5e-44f6-99e6-0e701a85611c' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:26:33.072 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:26:33.075 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:26:33.077 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOEZBMjg3MTM2Qzg0N0E5ODQ0AA==, Text='Show Me Template 1'
2025-10-02 10:26:36.637 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:36.6358301+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:26:46.644 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:46.6423972+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:26:56.651 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:56:56.6499037+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:06.668 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:57:06.6658754+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:16.688 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:57:16.6864553+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:26.695 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:57:26.6936464+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:36.714 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T04:57:36.7120131+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:46.729 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:57:46.7280813+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:27:56.743 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:57:56.7419805+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:06.759 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:06.7572769+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:16.764 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:16.7621419+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:26.771 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:26.7689060+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:36.775 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:36.7740106+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:46.780 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:46.7778711+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:28:56.786 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:58:56.7843005+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:06.792 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:06.7900792+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:16.796 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:16.7944492+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:26.805 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:26.8035101+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:36.822 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:36.8211712+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:46.835 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:46.8333603+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:29:56.848 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T04:59:56.8470462+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:06.854 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:06.8519627+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:16.871 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:16.8693735+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:26.888 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:26.8865803+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:36.902 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:36.9003562+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:46.916 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:46.9152352+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:30:56.932 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:00:56.9307158+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:07.082 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__now_0='2025-10-02T05:01:06.9448715+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:17.117 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:01:17.1156420+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:27.130 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:01:27.1286092+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:37.141 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:01:37.1394028+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:47.147 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:01:47.1462105+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:31:57.182 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:01:57.1800533+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:07.197 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:02:07.1957015+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:17.199 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:02:17.1981167+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:27.207 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:02:27.2050607+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:37.211 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:02:37.2091035+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:47.227 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:02:47.2256121+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:32:49.278 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 10:32:49.291 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 13.5431ms
2025-10-02 10:32:49.402 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 10:32:49.405 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 10:32:49.407 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 5.2513ms
2025-10-02 10:32:49.432 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.8367ms
2025-10-02 10:32:49.667 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 10:32:49.752 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 85.3507ms
2025-10-02 10:33:07.460 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 10:33:07.495 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 10:33:07.509 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 10:33:08.354 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 10:33:08.852 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 10:33:08.873 +05:30 [INF] ClickLogWorker started
2025-10-02 10:33:09.049 +05:30 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 10:33:09.060 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 10:33:09.061 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 10:33:09.062 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 10:33:09.063 +05:30 [INF] Hosting environment: Development
2025-10-02 10:33:09.064 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 10:33:09.065 +05:30 [INF] Executed DbCommand (69ms) [Parameters=[@__cutoff_0='2025-09-25T05:03:07.6017900Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 10:33:09.915 +05:30 [INF] ClickLogWorker stopped
2025-10-02 10:33:11.007 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 10:33:11.157 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 157.2812ms
2025-10-02 10:33:11.177 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 10:33:11.184 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 7.4711ms
2025-10-02 10:33:11.242 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 10:33:11.281 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.1558ms
2025-10-02 10:33:11.439 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 10:33:11.666 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 227.3363ms
2025-10-02 10:33:13.935 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='2025-10-02T05:03:13.8823215+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:33:18.913 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 10:33:18.944 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 10:33:18.960 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 10:33:18.964 +05:30 [INF] ⏭️ Skipping sync for "8390da76-10de-4d76-80f2-68b68f4e2b82"; TTL not expired.
2025-10-02 10:33:18.965 +05:30 [INF] TemplateSyncWorker: biz="8390da76-10de-4d76-80f2-68b68f4e2b82" added=0 updated=0 skipped=0 syncedAt="2025-10-02T04:26:09.1215710Z"
2025-10-02 10:33:18.971 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 10:33:18.975 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 10:33:19.013 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=100
2025-10-02 10:33:19.015 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=100
2025-10-02 10:33:20.187 +05:30 [INF] Received HTTP response headers after 1168.8421ms - 200
2025-10-02 10:33:20.189 +05:30 [INF] End processing HTTP request after 1177.7903ms - 200
2025-10-02 10:33:20.384 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerKey_1='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."Body", w."BusinessId", w."ButtonsJson", w."Category", w."CreatedAt", w."ExternalId", w."HasImageHeader", w."IsActive", w."Language", w."LastSyncedAt", w."Name", w."PlaceholderCount", w."Provider", w."RawJson", w."Status", w."UpdatedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__providerKey_1
2025-10-02 10:33:20.514 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@p1='011cbbb2-c2bb-4496-9192-a3d6b774b8d4', @p0='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p3='016d56cc-6729-4843-9959-d835d45f58fa', @p2='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p5='0370e011-5a1d-4a67-854a-0fbcf5648331', @p4='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p7='13493525-00e9-44ea-99a1-66796a44932e', @p6='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p9='165006ca-f706-435f-93c0-cd89ef7773fc', @p8='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p11='21533538-1fc0-41e8-aa1c-cf69db568733', @p10='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p13='2377d482-9fb9-4c93-ae00-3719af536b2a', @p12='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p15='29f5c5dc-6e02-4cee-ae04-f0aa3edc4d9a', @p14='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p17='2df07743-35ab-4a38-a40f-4a32a022334e', @p16='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p19='3027a02a-c6a7-4d5c-8520-3b7967cecb4b', @p18='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p21='3370ba3e-c344-4cf2-91f7-1924856ec046', @p20='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p23='38c67e31-0848-4149-a324-cdc34c04bc54', @p22='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p25='45bc982b-adcf-49fb-a888-e86412ae3aa7', @p24='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p27='4be5ea24-fa7b-4bc7-ac2c-ec460bd69972', @p26='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p29='5046cab8-e27a-4b52-841b-3218bec2f52b', @p28='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p31='519a3271-0786-4495-9a30-fe45b93b477b', @p30='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p33='5ed88fcc-3d15-4f82-af6f-e23e2d71fbb7', @p32='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p35='73267220-a9e5-44aa-8af9-84636f9919e8', @p34='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p37='832116b1-e2ab-48a8-bc91-29ffd3dea322', @p36='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p39='89c4fe4f-8060-41f1-ac86-9764a35100ba', @p38='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p41='90d4429e-23ae-42e2-8e68-82574e0a3284', @p40='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p45='9a3f869d-79ad-4c4a-aa4e-f59df48712ef', @p42='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p43='{"name":"pdf_template","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"DOCUMENT","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/534415257_508230149051927_6330429317144744326_n.pdf?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=6gmSIOfbwZUQ7kNvwEn4VCt&_nc_oc=Adn3Z7_4TVIKA6vumCYN6GF8Bwg2VbqceZRDxDrKTeRvUD4Zz-vDLWffVDdvvhTzIeZfdrDUGGevfjv_M9zJYcC2&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=ywit4njqTO5qGHwhmE_nSg&oh=01_Q5Aa2gHHafwfAjRbGtWKfRr23kVyvwLT_IpBM87MjAvULvkKhw&oe=69055E75"]}},{"type":"BODY","text":"Hello {{1}},\n\nPlease find your Invoice.","example":{"body_text":[["Usernmok"]]}},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Recieved"},{"type":"QUICK_REPLY","text":"No Received"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"508230145718594"}' (Nullable = false), @p44='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p49='9b4b4389-ff80-4861-bd61-1e01cf0a91ea', @p46='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p47='{"name":"welcome_video","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/534417141_1284099973020036_5812680847202991712_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=Enz6gVNgWYMQ7kNvwEMO0Wt&_nc_oc=AdmfR2Kr6hpOiuiygoJXoWX33ABv1W_zVP6tlCr_l26y5ucIAxNZCsPm3LLbmFFiD0mcFixvKKtYdQ1kTs2-FLCA&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=ywit4njqTO5qGHwhmE_nSg&oh=01_Q5Aa2gEoqu0cyswRmQVJhtfq3-LsUCYcQ9Y0bVB2LZABHdxfpg&oe=69058C83"]}},{"type":"BODY","text":"Hello {{1}} 👋\nAapka order successfully deliver ho chuka hai. 🚚✨\nKya aapne Nirvasa ka Vaji Amrit Vati lena start kar diya hai? 💊\nNeeche diye gaye options me se select karke bataye 👇","example":{"body_text":[["Nicolus"]]}},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes"},{"type":"QUICK_REPLY","text":"No"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1284099969686703"}' (Nullable = false), @p48='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p51='9b75c680-c36f-4cc1-a717-8dcbbdb09998', @p50='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p53='a24a8aa5-00d6-4e27-ae00-5251480ba7ee', @p52='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p57='a7690842-f899-4064-872f-42ee1e0ea934', @p54='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p55='{"name":"shoe_launch_offer","parameter_format":"NAMED","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/534420374_1100798475349987_2054812548274537975_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=TPhNUOFPIkQQ7kNvwH8pYnx&_nc_oc=AdmPFP4Hy-bTaTmy-HlXFvYM_u7MHIllOqka76BV_ZTCWo5bSqHXDjA93WHKclSa_x4GQwfiPIxaliNi6tbRfJ0R&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=ywit4njqTO5qGHwhmE_nSg&oh=01_Q5Aa2gE85CQ5tEzgPtvHnL5XWCtBlI6WLG4sqSF0jqMTZBVRBg&oe=6905848F"]}},{"type":"BODY","text":"Hello {{}}! The moment has arrived! 🎉\n\nOur new **[Shoe Model Name]** is officially here, and we're celebrating with a special offer just for our WhatsApp family!\n\nFor the next 48 hours, get an **exclusive 15% discount** on your purchase. Don't just follow the trend—set it.\n\nUse code: **LAUNCH15**\n\nThis offer won't last long. Step into the future today!"},{"type":"FOOTER","text":"The XploreByte Team"},{"type":"BUTTONS","buttons":[{"type":"URL","text":"Shop now","url":"https://xplorebytesolutions.com/"},{"type":"PHONE_NUMBER","text":"Call us","phone_number":"+917082156227"}]}],"language":"en_US","status":"APPROVED","category":"MARKETING","sub_category":"CUSTOM","id":"1100798472016654"}' (Nullable = false), @p56='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p59='be892679-3fc5-4687-85cc-0ca879983766', @p58='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p61='c2984897-fef2-4f79-a068-eca5a820bd5e', @p60='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p63='e14238a0-03ae-4130-9369-92c3948aaa0d', @p62='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p65='e679348c-7124-4f79-bea4-ddb5f147d596', @p64='2025-10-02T05:03:18.9738141Z' (DbType = DateTime), @p67='ef2d8d19-8144-475a-a2cd-51ed38c59af6', @p66='2025-10-02T05:03:18.9738141Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p0
WHERE "Id" = @p1;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p2
WHERE "Id" = @p3;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p4
WHERE "Id" = @p5;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p6
WHERE "Id" = @p7;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p8
WHERE "Id" = @p9;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p10
WHERE "Id" = @p11;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p12
WHERE "Id" = @p13;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p14
WHERE "Id" = @p15;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p16
WHERE "Id" = @p17;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p18
WHERE "Id" = @p19;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p20
WHERE "Id" = @p21;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p22
WHERE "Id" = @p23;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p24
WHERE "Id" = @p25;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p26
WHERE "Id" = @p27;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p28
WHERE "Id" = @p29;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p30
WHERE "Id" = @p31;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p32
WHERE "Id" = @p33;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p34
WHERE "Id" = @p35;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p36
WHERE "Id" = @p37;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p38
WHERE "Id" = @p39;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p40
WHERE "Id" = @p41;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p42, "RawJson" = @p43, "UpdatedAt" = @p44
WHERE "Id" = @p45;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p46, "RawJson" = @p47, "UpdatedAt" = @p48
WHERE "Id" = @p49;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p50
WHERE "Id" = @p51;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p52
WHERE "Id" = @p53;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p54, "RawJson" = @p55, "UpdatedAt" = @p56
WHERE "Id" = @p57;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p58
WHERE "Id" = @p59;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p60
WHERE "Id" = @p61;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p62
WHERE "Id" = @p63;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p64
WHERE "Id" = @p65;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p66
WHERE "Id" = @p67;
2025-10-02 10:33:20.533 +05:30 [INF] TemplateSyncWorker: biz="9841bcab-ca71-439f-8691-d85ada887b01" added=0 updated=3 skipped=28 syncedAt="2025-10-02T05:03:18.9738141Z"
2025-10-02 10:33:20.535 +05:30 [INF] TemplateSyncWorker: sweep finished in 1641 ms; processed=2; next run ~"2025-10-02T11:03:18.8933113Z"
2025-10-02 10:33:23.086 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:33:23.090 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 10:33:23.182 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:33:23.201 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:33:23.259 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:23.263 +05:30 [INF] [CustomAPI:"b2c9acb4-cbba-49b9-9436-43131f341a0f"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:33:23.276 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:33:23.305 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:23.306 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:23.948 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:03:23.9447489+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:33:24.077 +05:30 [INF] Received HTTP response headers after 769.8725ms - 200
2025-10-02 10:33:24.079 +05:30 [INF] End processing HTTP request after 773.7677ms - 200
2025-10-02 10:33:24.175 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:33:24.180 +05:30 [INF] [CustomAPI:"b2c9acb4-cbba-49b9-9436-43131f341a0f"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:33:24.194 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:33:24.203 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:33:24.216 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:24.217 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:25.182 +05:30 [INF] Received HTTP response headers after 963.9966ms - 200
2025-10-02 10:33:25.184 +05:30 [INF] End processing HTTP request after 967.5015ms - 200
2025-10-02 10:33:25.286 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='02508495-bf2d-4f70-bfc8-c2c9cb99edf8', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T05:03:25.1877019Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T05:03:25.1877019Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:33:25.306 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__messageLogId_0='02508495-bf2d-4f70-bfc8-c2c9cb99edf8', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:33:25.339 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='0465e958-5cc8-492a-a465-acfbb6f5597e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T05:03:25.3090518+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='02508495-bf2d-4f70-bfc8-c2c9cb99edf8' (Nullable = true), @p8='2025-10-02T05:03:25.3094490+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:33:25.341 +05:30 [INF] [CustomAPI:"b2c9acb4-cbba-49b9-9436-43131f341a0f"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:33:25.349 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:33:25.360 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 2154.6995ms
2025-10-02 10:33:25.362 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:33:25.368 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 2281.6274ms
2025-10-02 10:33:32.026 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:33:32.035 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:32.038 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:32.045 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"sent","timestamp":"1759381413","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","expiration_timestamp":"1759381413","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:32.047 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:32.048 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:32.051 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 12.0405ms
2025-10-02 10:33:32.053 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:32.054 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 27.9997ms
2025-10-02 10:33:32.137 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"sent","timestamp":"1759381413","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","expiration_timestamp":"1759381413","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:32.174 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:33:32.179 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:32.189 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:32.194 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:32.202 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:32.210 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='02508495-bf2d-4f70-bfc8-c2c9cb99edf8', @p0='marketing', @p1='2526bfca022b4467c79b52a9e77349e3', @p2='2025-10-01T05:03:33.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='004a8a80-8223-4dca-abf0-fd9a32db93f1', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='2526bfca022b4467c79b52a9e77349e3', @p9='2025-10-02T05:03:32.1920810+00:00' (DbType = DateTime), @p10='sent' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T05:03:33.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"sent","timestamp":"1759381413","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","expiration_timestamp":"1759381413","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==', @p19='e99e8d93-b938-4fab-bbb8-297a1dd8afc6', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='2526bfca022b4467c79b52a9e77349e3', @p23='2025-10-02T05:03:32.1958862+00:00' (DbType = DateTime), @p24='pricing_update' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T05:03:33.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"sent","timestamp":"1759381413","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","expiration_timestamp":"1759381413","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:33:32.245 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:32.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:32.597 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:33:32.602 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:32.603 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:32.605 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"read","timestamp":"1759381414","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:32.607 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:32.607 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:32.609 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 3.6636ms
2025-10-02 10:33:32.609 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"read","timestamp":"1759381414","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:32.610 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:32.611 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:32.611 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.5832ms
2025-10-02 10:33:32.615 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:32.619 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:32.622 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:32.627 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='78aaead2-a52e-420e-ac9a-ae6d0deafa7e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='2526bfca022b4467c79b52a9e77349e3', @p4='2025-10-02T05:03:32.6181495+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:03:34.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==","status":"read","timestamp":"1759381414","recipient_id":"918974005240","conversation":{"id":"2526bfca022b4467c79b52a9e77349e3","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:33:32.631 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:32.634 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:32.638 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='02508495-bf2d-4f70-bfc8-c2c9cb99edf8', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:33:33.961 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:03:33.9585745+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:33:35.183 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 603
2025-10-02 10:33:35.186 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:35.187 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:35.191 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCNUMyNkE0RTA3ODMwRDYxMkRDNUU1NDUyOTdCMDUA","timestamp":"1759381416","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:33:35.193 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:35.194 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:35.195 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.0373ms
2025-10-02 10:33:35.196 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:35.197 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.8081ms
2025-10-02 10:33:35.202 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCNUMyNkE0RTA3ODMwRDYxMkRDNUU1NDUyOTdCMDUA","timestamp":"1759381416","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:33:35.203 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:33:35.212 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:33:35.213 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVCNUMyNkE0RTA3ODMwRDYxMkRDNUU1NDUyOTdCMDUA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA==, Text: Yes
2025-10-02 10:33:35.221 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:33:35.228 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__origin_Id_0='02508495-bf2d-4f70-bfc8-c2c9cb99edf8' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODRDNzBFMzNDNjk2MDAyNzk4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:35.235 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:33:35.273 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:33:35.287 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:33:35.305 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:33:35.311 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:33:35.376 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='060f91f4-47cb-4a5a-85f8-35dee087fc76', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:03:35.3143198Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='02508495-bf2d-4f70-bfc8-c2c9cb99edf8' (Nullable = true), @p9=NULL, @p10='fa687223-e5b1-421d-8dec-66d9efb5d557' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Yes'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:33:35.386 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:33:35.404 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='10', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes' (Nullable = false), @p2='Yes', @p3='2025-10-02T05:03:35.3981202Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:33:35.406 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:33:35.411 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:33:35.416 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:35.421 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:35.430 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:33:35.434 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:33:35.435 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:33:36.704 +05:30 [INF] Received HTTP response headers after 1268.2607ms - 200
2025-10-02 10:33:36.706 +05:30 [INF] End processing HTTP request after 1271.6901ms - 200
2025-10-02 10:33:36.707 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:33:36.708 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:33:36.749 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:33:36.775 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:33:36.777 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:36.778 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:37.842 +05:30 [INF] Received HTTP response headers after 1063.2995ms - 200
2025-10-02 10:33:37.844 +05:30 [INF] End processing HTTP request after 1066.3818ms - 200
2025-10-02 10:33:37.925 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:37.928 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:33:37.931 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:33:37.935 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:33:37.939 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:37.940 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:38.840 +05:30 [INF] Received HTTP response headers after 899.2502ms - 200
2025-10-02 10:33:38.841 +05:30 [INF] End processing HTTP request after 902.5992ms - 200
2025-10-02 10:33:38.860 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='ea28dca0-f726-4579-abf8-3d3740d59dd7', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:03:38.8502809Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","message_status":"accepted"}]}', @p10='3fe2bd05-9e15-4fdf-bd4e-879fa8402577' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='689bc310-4395-4737-a0c6-ca52bf0e6d06', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:03:38.8496617Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='02508495-bf2d-4f70-bfc8-c2c9cb99edf8' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:03:38.8496633Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:33:39.842 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:33:39.844 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:39.845 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:39.847 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"sent","timestamp":"1759381421","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","expiration_timestamp":"1759381421","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:39.849 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:39.849 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"sent","timestamp":"1759381421","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","expiration_timestamp":"1759381421","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:39.850 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:39.851 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:39.852 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.1337ms
2025-10-02 10:33:39.855 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:39.855 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:39.856 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.5372ms
2025-10-02 10:33:39.859 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:39.865 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:39.873 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='45c6fe1cba7295f0e4425012090d38d2'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:39.877 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='6d6a77b6-44e3-4c1b-b7f2-6febef25469c', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='45c6fe1cba7295f0e4425012090d38d2', @p4='2025-10-02T05:03:39.8582431+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:03:41.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"sent","timestamp":"1759381421","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","expiration_timestamp":"1759381421","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==', @p14='a181c57c-f6e4-4735-bac7-b49fadbada0c', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='45c6fe1cba7295f0e4425012090d38d2', @p18='2025-10-02T05:03:39.8636390+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:03:41.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"sent","timestamp":"1759381421","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","expiration_timestamp":"1759381421","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:33:39.881 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:39.885 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:40.234 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:33:40.237 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:40.238 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:40.240 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"read","timestamp":"1759381422","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:40.242 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:40.242 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"read","timestamp":"1759381422","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:40.243 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:40.244 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:40.245 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.1986ms
2025-10-02 10:33:40.248 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:40.248 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:40.250 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.923ms
2025-10-02 10:33:40.253 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:40.258 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:40.262 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='45c6fe1cba7295f0e4425012090d38d2'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:40.285 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='f65f91f6-d4b6-4c7d-9546-a5d378969478', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='45c6fe1cba7295f0e4425012090d38d2', @p4='2025-10-02T05:03:40.2517054+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:03:42.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==","status":"read","timestamp":"1759381422","recipient_id":"918974005240","conversation":{"id":"45c6fe1cba7295f0e4425012090d38d2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:33:40.289 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:40.292 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:40.296 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='689bc310-4395-4737-a0c6-ca52bf0e6d06', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:33:41.900 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:33:41.902 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:41.903 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:41.906 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNTA2QzEyM0RFNjhEQTNCQzg0NkUxQTcxNEFFMDcA","timestamp":"1759381423","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:33:41.907 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:41.907 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNTA2QzEyM0RFNjhEQTNCQzg0NkUxQTcxNEFFMDcA","timestamp":"1759381423","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:33:41.908 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:41.909 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:33:41.910 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.48ms
2025-10-02 10:33:41.911 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:33:41.912 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:41.913 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNTA2QzEyM0RFNjhEQTNCQzg0NkUxQTcxNEFFMDcA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==, Text: Show Me Template 2
2025-10-02 10:33:41.914 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 14.7281ms
2025-10-02 10:33:41.917 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:33:41.923 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:41.925 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:33:41.930 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:33:41.934 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:33:41.955 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='4bfccea6-9b8e-4044-804b-67639f1906d6', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:03:41.9361080Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @p9=NULL, @p10='ecab3583-c16b-46bd-b1a8-e9b5e17262ec' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:33:41.959 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:33:41.962 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='11', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2' (Nullable = false), @p2='Show Me Template 2', @p3='2025-10-02T05:03:41.9614149Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:33:41.964 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:33:41.967 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:33:41.970 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:41.973 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:41.976 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:33:41.978 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:33:41.979 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:33:43.632 +05:30 [INF] Received HTTP response headers after 1651.9752ms - 200
2025-10-02 10:33:43.633 +05:30 [INF] End processing HTTP request after 1655.6895ms - 200
2025-10-02 10:33:43.635 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:33:43.636 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:33:43.640 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:33:43.643 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:33:43.646 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:43.647 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:33:43.980 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:03:43.9781304+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:33:44.332 +05:30 [INF] Received HTTP response headers after 683.657ms - 200
2025-10-02 10:33:44.334 +05:30 [INF] End processing HTTP request after 687.6127ms - 200
2025-10-02 10:33:44.403 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:33:44.406 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:33:44.409 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:33:44.413 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:33:44.415 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:44.416 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:33:45.197 +05:30 [INF] Received HTTP response headers after 779.4709ms - 200
2025-10-02 10:33:45.198 +05:30 [INF] End processing HTTP request after 782.9945ms - 200
2025-10-02 10:33:45.203 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='e89985ad-0107-4882-9390-1c6620bab88a', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:03:45.2006694Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='ae40fbc2-407f-4c83-8ec2-a879ddcce0f8' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","message_status":"accepted"}]}', @p10='959715a9-2238-45b0-bc40-894cb5afc70f' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='ae40fbc2-407f-4c83-8ec2-a879ddcce0f8', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:03:45.2002197Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:03:45.2002209Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:33:46.211 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:33:46.214 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:46.215 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:46.217 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"sent","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","expiration_timestamp":"1759381428","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:46.218 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:46.218 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"sent","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","expiration_timestamp":"1759381428","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:46.219 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:46.219 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:46.220 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.2764ms
2025-10-02 10:33:46.223 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:46.223 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:46.225 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.4634ms
2025-10-02 10:33:46.228 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:46.233 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:46.236 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='6945bc842f4f5e83778cc8964e434ab2'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:46.239 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='5f0b809d-08a3-45d6-a098-1cafba882f47', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='6945bc842f4f5e83778cc8964e434ab2', @p4='2025-10-02T05:03:46.2318692+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:03:48.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"sent","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","expiration_timestamp":"1759381428","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==', @p14='df7e4f4e-6ccd-4d39-b7a6-12d574db537e', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='6945bc842f4f5e83778cc8964e434ab2', @p18='2025-10-02T05:03:46.2267606+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:03:48.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"sent","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","expiration_timestamp":"1759381428","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:33:46.244 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:46.248 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:46.789 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:33:46.792 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:46.793 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:46.795 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"read","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:46.796 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:46.797 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"read","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:33:46.797 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:46.798 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:33:46.799 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.8133ms
2025-10-02 10:33:46.802 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:46.803 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:46.806 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:33:46.807 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.6922ms
2025-10-02 10:33:46.810 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:46.816 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='6945bc842f4f5e83778cc8964e434ab2'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:46.819 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='5b6fa6cc-cd42-49f2-8c6c-b92d552287d8', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='6945bc842f4f5e83778cc8964e434ab2', @p4='2025-10-02T05:03:46.8053155+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:03:48.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==","status":"read","timestamp":"1759381428","recipient_id":"918974005240","conversation":{"id":"6945bc842f4f5e83778cc8964e434ab2","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:33:46.823 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:33:46.827 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:33:46.830 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='ae40fbc2-407f-4c83-8ec2-a879ddcce0f8', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:33:48.661 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:33:48.664 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:48.665 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:33:48.668 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU0QkRBODZDOThFRkE2MEZEOTQzNTVFNjJDNzQ4Q0YA","timestamp":"1759381430","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:33:48.669 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:33:48.670 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU0QkRBODZDOThFRkE2MEZEOTQzNTVFNjJDNzQ4Q0YA","timestamp":"1759381430","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:33:48.670 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:33:48.671 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:33:48.673 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.5729ms
2025-10-02 10:33:48.673 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:33:48.675 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:33:48.675 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU0QkRBODZDOThFRkE2MEZEOTQzNTVFNjJDNzQ4Q0YA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==, Text: Show Me Template 1
2025-10-02 10:33:48.676 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 15.0872ms
2025-10-02 10:33:48.680 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:33:48.699 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='ae40fbc2-407f-4c83-8ec2-a879ddcce0f8' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:33:48.702 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:33:48.705 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:33:48.707 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMEMzNEIyQkI0N0YzRkUxQ0Y2AA==, Text='Show Me Template 1'
2025-10-02 10:33:53.988 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:03:53.9864581+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:00.265 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:34:00.268 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:00.269 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:34:00.271 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU4QTdDMjgzNDNEQzYyNzE4NzIzQkYyNjVCNEEwRkMA","timestamp":"1759381441","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:34:00.272 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:34:00.272 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU4QTdDMjgzNDNEQzYyNzE4NzIzQkYyNjVCNEEwRkMA","timestamp":"1759381441","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:34:00.273 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:34:00.274 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:34:00.275 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.6701ms
2025-10-02 10:34:00.275 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:34:00.276 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:00.277 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU4QTdDMjgzNDNEQzYyNzE4NzIzQkYyNjVCNEEwRkMA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA==, Text: Show Me Template 3
2025-10-02 10:34:00.278 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 12.7521ms
2025-10-02 10:34:00.281 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:34:00.287 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSODIyMzgwMjEwMjVCQTlBM0E1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:00.290 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:34:00.293 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:34:00.295 +05:30 [INF] 🟨 Falling back to single available link for step "00e8efb2-eb9d-4c6d-a516-1ea299da5c61"
2025-10-02 10:34:00.296 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61")
2025-10-02 10:34:00.299 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:34:00.302 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:34:00.323 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p0='0d9cc4b9-19bb-4068-b484-6c6dbeec907e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:04:00.3047855Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @p9=NULL, @p10='77e97042-73bf-4c27-b773-64728074556c' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 3'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:34:00.326 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:34:00.330 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='12', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3' (Nullable = false), @p2='Show Me Template 3', @p3='2025-10-02T05:04:00.3289269Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:34:00.332 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:34:00.335 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:34:00.338 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:34:00.341 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:34:00.344 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:34:00.347 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:34:00.347 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:34:01.458 +05:30 [INF] Received HTTP response headers after 1109.5242ms - 200
2025-10-02 10:34:01.459 +05:30 [INF] End processing HTTP request after 1112.883ms - 200
2025-10-02 10:34:01.461 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:34:01.462 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:34:01.465 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:34:01.469 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:34:01.472 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:34:01.473 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:34:02.541 +05:30 [INF] Received HTTP response headers after 1066.085ms - 200
2025-10-02 10:34:02.542 +05:30 [INF] End processing HTTP request after 1069.7445ms - 200
2025-10-02 10:34:02.547 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:34:02.549 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:34:02.553 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:34:02.556 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:34:02.559 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:34:02.560 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:34:03.416 +05:30 [INF] Received HTTP response headers after 855.7419ms - 200
2025-10-02 10:34:03.418 +05:30 [INF] End processing HTTP request after 858.9656ms - 200
2025-10-02 10:34:03.421 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='bdb59b0e-ca8d-4f7b-b3f3-486e80ea6d7b', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:04:03.4193502Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='4ccc424e-5bfd-41d6-a85e-faff5ecccb02' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","message_status":"accepted"}]}', @p10='48ef17ef-26f8-47ad-a2a3-ef347064988c' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='4ccc424e-5bfd-41d6-a85e-faff5ecccb02', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:04:03.4191946Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='689bc310-4395-4737-a0c6-ca52bf0e6d06' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:04:03.4191958Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:34:03.993 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:04:03.9910622+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:04.823 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:34:04.825 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:04.826 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:34:04.829 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"sent","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","expiration_timestamp":"1759381446","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:34:04.830 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:34:04.831 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"sent","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","expiration_timestamp":"1759381446","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:34:04.831 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:34:04.832 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:34:04.833 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.9118ms
2025-10-02 10:34:04.836 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:34:04.837 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:04.840 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:34:04.840 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.8975ms
2025-10-02 10:34:04.843 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:04.849 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='97e3d3f7be70cf99b31cc6b947a34859'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:04.852 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='130dd616-6baf-4b96-aaf0-91e812498ec1', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='97e3d3f7be70cf99b31cc6b947a34859', @p4='2025-10-02T05:04:04.8425036+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:04:06.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"sent","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","expiration_timestamp":"1759381446","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==', @p14='b9d2eb8e-7e27-436f-8a51-c7dc6c93f718', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='97e3d3f7be70cf99b31cc6b947a34859', @p18='2025-10-02T05:04:04.8391889+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:04:06.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"sent","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","expiration_timestamp":"1759381446","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:34:04.874 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:34:04.878 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:34:04.931 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:34:04.933 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:04.934 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:34:04.936 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"read","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:34:04.937 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:34:04.937 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"read","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:34:04.938 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:34:04.939 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:34:04.940 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 4.7665ms
2025-10-02 10:34:04.943 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:34:04.944 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:04.947 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:34:04.948 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 17.2571ms
2025-10-02 10:34:04.951 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:04.956 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='97e3d3f7be70cf99b31cc6b947a34859'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:04.959 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='a9c0a6c2-253a-405a-b3ed-65fe20f3939a', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='97e3d3f7be70cf99b31cc6b947a34859', @p4='2025-10-02T05:04:04.9462593+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:04:06.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==","status":"read","timestamp":"1759381446","recipient_id":"918974005240","conversation":{"id":"97e3d3f7be70cf99b31cc6b947a34859","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:34:04.963 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:34:04.966 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:34:04.969 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='4ccc424e-5bfd-41d6-a85e-faff5ecccb02', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:34:14.009 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:04:14.0079768+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:14.328 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:34:14.331 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:14.332 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:34:14.334 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2Q0UzMkQ4NjRDNjM1RUY3QjY1OUU2REI3M0UwRUEA","timestamp":"1759381455","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:34:14.336 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:34:14.336 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2Q0UzMkQ4NjRDNjM1RUY3QjY1OUU2REI3M0UwRUEA","timestamp":"1759381455","type":"button","button":{"payload":"Show Me Template 1","text":"Show Me Template 1"}}]},"field":"messages"}]}]}
2025-10-02 10:34:14.337 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:34:14.338 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:34:14.339 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 5.1082ms
2025-10-02 10:34:14.340 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:34:14.341 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:34:14.341 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2Q0UzMkQ4NjRDNjM1RUY3QjY1OUU2REI3M0UwRUEA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==, Text: Show Me Template 1
2025-10-02 10:34:14.342 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 13.9014ms
2025-10-02 10:34:14.345 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:34:14.351 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='4ccc424e-5bfd-41d6-a85e-faff5ecccb02' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:34:14.354 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:34:14.357 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:34:14.359 +05:30 [INF] 🟡 Button text not found in bundle or flow links. Ref=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRjVFMTYwOTlFMzVERjMwRjg5AA==, Text='Show Me Template 1'
2025-10-02 10:34:24.021 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:04:24.0190067+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:34.036 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:04:34.0342403+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:44.054 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:04:44.0523689+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:34:54.070 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:04:54.0684989+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:04.086 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:05:04.0843535+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:14.104 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:05:14.1017475+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:24.116 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:05:24.1149739+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:34.125 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:05:34.1240030+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:44.134 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:05:44.1318348+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:35:54.142 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:05:54.1405389+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:04.149 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:04.1470595+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:14.159 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:14.1571902+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:24.165 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:24.1637034+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:34.177 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:34.1750719+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:44.183 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:44.1810257+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:36:54.204 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:06:54.2022357+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:04.218 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:07:04.2161441+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:14.237 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:07:14.2340143+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:24.263 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:07:24.2601536+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:34.280 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:07:34.2771093+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:44.296 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:07:44.2935378+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:37:54.316 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:07:54.3136982+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:04.328 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:08:04.3254088+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:14.428 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:08:14.3384428+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:24.440 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:08:24.4378999+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:34.451 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:08:34.4482164+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:44.467 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:08:44.4645238+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:38:54.474 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:08:54.4714374+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:04.492 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:09:04.4891462+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:14.509 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:09:14.5062422+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:24.516 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:09:24.5138410+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:34.526 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:09:34.5239876+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:44.528 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:09:44.5262540+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:39:54.539 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:09:54.5341287+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:04.557 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:10:04.5551251+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:14.571 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:10:14.5678127+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:24.582 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:10:24.5797952+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:34.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:10:34.6037370+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:44.611 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:10:44.6088608+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:40:54.619 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:10:54.6165421+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:04.634 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:11:04.6318523+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:14.661 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:11:14.6573882+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:24.671 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:11:24.6689681+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:34.677 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:11:34.6726807+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:44.688 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:11:44.6854861+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:41:54.700 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:11:54.6985516+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:04.717 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:12:04.7151888+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:14.728 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:12:14.7256319+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:24.749 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:12:24.7463296+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:34.756 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:12:34.7540250+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:44.762 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:12:44.7599317+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:42:54.778 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:12:54.7756103+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:04.800 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:13:04.7981686+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:14.897 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:13:14.8064053+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:24.907 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:13:24.9040002+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:34.912 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:13:34.9097589+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:44.932 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:13:44.9295679+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:43:54.951 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:13:54.9485623+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:04.966 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:14:04.9637380+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:14.980 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:14:14.9770750+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:24.991 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:14:24.9881004+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:35.009 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:14:35.0064099+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:45.017 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:14:45.0149660+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:44:55.027 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:14:55.0246433+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:05.032 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:15:05.0300582+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:15.042 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:15:15.0405613+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:25.064 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:15:25.0618521+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:35.073 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:15:35.0703669+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:45.091 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:15:45.0880553+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:45:55.101 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:15:55.0991290+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:05.109 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:16:05.1065248+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:15.126 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:16:15.1235827+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:25.142 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:16:25.1395710+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:35.156 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:16:35.1536048+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:45.172 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:16:45.1693757+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:46:55.189 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='2025-10-02T05:16:55.1844130+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:05.199 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:17:05.1961120+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:15.226 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:17:15.2228742+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:25.241 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:17:25.2384617+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:35.260 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:17:35.2575612+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:45.276 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__now_0='2025-10-02T05:17:45.2713511+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:47:55.293 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:17:55.2905471+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:05.309 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:18:05.3061115+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:15.407 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:18:15.3111283+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:25.421 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:18:25.4183835+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:35.428 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:18:35.4258674+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:45.441 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:18:45.4381395+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:48:55.450 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:18:55.4480859+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:05.462 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:19:05.4589717+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:15.470 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:19:15.4678298+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:25.487 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:19:25.4848118+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:35.523 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@__now_0='2025-10-02T05:19:35.5041148+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:45.539 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:19:45.5370883+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:49:55.554 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:19:55.5519072+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:05.564 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:20:05.5623177+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:15.625 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:20:15.6234135+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:18.419 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:50:18.428 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:50:18.430 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:50:18.434 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA==","status":"sent","timestamp":"1759228126","recipient_id":"918974005240","conversation":{"id":"2364522cb962b1046da6975d9637be47","expiration_timestamp":"1759228127","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:50:18.436 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:50:18.437 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA==","status":"sent","timestamp":"1759228126","recipient_id":"918974005240","conversation":{"id":"2364522cb962b1046da6975d9637be47","expiration_timestamp":"1759228127","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:50:18.438 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:50:18.445 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:50:18.446 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 12.7582ms
2025-10-02 10:50:18.449 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:50:18.451 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:50:18.456 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:50:18.456 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 38.0599ms
2025-10-02 10:50:18.480 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:50:18.489 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:50:18.497 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='d515543f-17af-4764-8b68-a4eec0ce1fad', @p0='2025-09-29T10:28:47.0000000+00:00' (Nullable = true) (DbType = DateTime), @p2='0f791669-367f-4233-b9d4-7a8738854267', @p3='9841bcab-ca71-439f-8691-d85ada887b01', @p4='marketing', @p5='2364522cb962b1046da6975d9637be47', @p6='2025-10-02T05:20:18.4594463+00:00' (DbType = DateTime), @p7='sent' (Nullable = false), @p8='True' (Nullable = true), @p9=NULL (DbType = Guid), @p10='2025-09-30T10:28:46.0000000+00:00' (DbType = DateTime), @p11='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA==","status":"sent","timestamp":"1759228126","recipient_id":"918974005240","conversation":{"id":"2364522cb962b1046da6975d9637be47","expiration_timestamp":"1759228127","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p12=NULL (DbType = Decimal), @p13=NULL, @p14='META_CLOUD' (Nullable = false), @p15='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationStartedAt" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
2025-10-02 10:50:18.507 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:50:18.515 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNDVGRkMxMjIxQkU3Q0FCMDdBAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:50:18.521 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='d515543f-17af-4764-8b68-a4eec0ce1fad', @p0='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:50:25.641 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:20:25.6383830+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:35.659 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:20:35.6548419+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:45.670 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:20:45.6667936+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:50:55.681 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:20:55.6789250+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:05.699 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__now_0='2025-10-02T05:21:05.6926845+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:15.707 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:21:15.7036039+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:25.717 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:21:25.7144992+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:35.726 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:21:35.7241475+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:45.735 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:21:45.7325708+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:51:55.751 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:21:55.7491663+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:05.759 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:22:05.7562778+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:15.773 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:22:15.7714688+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:25.774 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:22:25.7718970+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:35.785 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:22:35.7820955+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:45.802 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:22:45.7980859+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:52:55.820 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:22:55.8180938+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:53:05.824 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:23:05.8215371+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:53:31.075 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 10:53:31.130 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 10:53:31.153 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 10:53:32.385 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 10:53:33.192 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 10:53:33.229 +05:30 [INF] ClickLogWorker started
2025-10-02 10:53:33.460 +05:30 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 10:53:33.501 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 10:53:33.502 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 10:53:33.505 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 10:53:33.506 +05:30 [INF] Hosting environment: Development
2025-10-02 10:53:33.507 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 10:53:33.512 +05:30 [INF] Executed DbCommand (119ms) [Parameters=[@__cutoff_0='2025-09-25T05:23:31.3010587Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 10:53:34.290 +05:30 [INF] ClickLogWorker stopped
2025-10-02 10:53:34.662 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 10:53:34.916 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 262.5468ms
2025-10-02 10:53:34.955 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 10:53:34.988 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 32.925ms
2025-10-02 10:53:35.049 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 10:53:35.098 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 48.9866ms
2025-10-02 10:53:35.366 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 10:53:35.722 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 356.8561ms
2025-10-02 10:53:38.367 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__now_0='2025-10-02T05:23:38.2534230+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:53:40.505 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 10:53:40.512 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 10:53:40.654 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:53:40.682 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 10:53:40.793 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:53:40.820 +05:30 [INF] [CustomAPI:"4c847d8f-4772-47b5-9e6d-a601e998a161"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 10:53:40.867 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:53:40.970 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:53:40.975 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:53:42.593 +05:30 [INF] Received HTTP response headers after 1612.0673ms - 200
2025-10-02 10:53:42.596 +05:30 [INF] End processing HTTP request after 1629.808ms - 200
2025-10-02 10:53:43.128 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 10:53:43.138 +05:30 [INF] [CustomAPI:"4c847d8f-4772-47b5-9e6d-a601e998a161"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 10:53:43.191 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:53:43.212 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:53:43.237 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:53:43.239 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:53:43.285 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 10:53:43.309 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 10:53:43.326 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 10:53:43.332 +05:30 [INF] ⏭️ Skipping sync for "8390da76-10de-4d76-80f2-68b68f4e2b82"; TTL not expired.
2025-10-02 10:53:43.334 +05:30 [INF] TemplateSyncWorker: biz="8390da76-10de-4d76-80f2-68b68f4e2b82" added=0 updated=0 skipped=0 syncedAt="2025-10-02T04:26:09.1215710Z"
2025-10-02 10:53:43.346 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 10:53:43.351 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 10:53:43.355 +05:30 [INF] ⏭️ Skipping sync for "9841bcab-ca71-439f-8691-d85ada887b01"; TTL not expired.
2025-10-02 10:53:43.356 +05:30 [INF] TemplateSyncWorker: biz="9841bcab-ca71-439f-8691-d85ada887b01" added=0 updated=0 skipped=0 syncedAt="2025-10-02T05:03:18.9738140Z"
2025-10-02 10:53:43.359 +05:30 [INF] TemplateSyncWorker: sweep finished in 98 ms; processed=2; next run ~"2025-10-02T11:23:43.2614994Z"
2025-10-02 10:53:44.271 +05:30 [INF] Received HTTP response headers after 1030.0641ms - 200
2025-10-02 10:53:44.285 +05:30 [INF] End processing HTTP request after 1047.623ms - 200
2025-10-02 10:53:44.574 +05:30 [INF] Executed DbCommand (24ms) [Parameters=[@p0='428bd168-08b7-45b0-8ef9-3bd7f3dbd682', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T05:23:44.2931146Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T05:23:44.2931146Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 10:53:44.659 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__messageLogId_0='428bd168-08b7-45b0-8ef9-3bd7f3dbd682', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 10:53:44.716 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='cbb2c44a-0d79-4984-8462-d5221b0a68bb', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T05:23:44.6636963+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='428bd168-08b7-45b0-8ef9-3bd7f3dbd682' (Nullable = true), @p8='2025-10-02T05:23:44.6642872+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:53:44.722 +05:30 [INF] [CustomAPI:"4c847d8f-4772-47b5-9e6d-a601e998a161"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 10:53:44.733 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 10:53:44.756 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 4066.1486ms
2025-10-02 10:53:44.760 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 10:53:44.769 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 4264.9353ms
2025-10-02 10:53:48.379 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:23:48.3752924+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:53:55.590 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:53:55.607 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:53:55.612 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:53:55.623 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"sent","timestamp":"1759382637","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","expiration_timestamp":"1759382637","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:53:55.628 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:53:55.630 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:53:55.637 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 22.0288ms
2025-10-02 10:53:55.639 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:53:55.642 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 51.6839ms
2025-10-02 10:53:55.787 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"sent","timestamp":"1759382637","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","expiration_timestamp":"1759382637","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:53:55.853 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 10:53:55.861 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:53:55.878 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:53:55.885 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:53:55.901 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:53:55.932 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p4='428bd168-08b7-45b0-8ef9-3bd7f3dbd682', @p0='marketing', @p1='e60a66268db51b68d52f81d8a990798d', @p2='2025-10-01T05:23:57.0000000+00:00' (Nullable = true) (DbType = DateTime), @p3='True' (Nullable = true), @p5='45d6cbdc-7280-472e-82b5-42ca64b09e88', @p6='9841bcab-ca71-439f-8691-d85ada887b01', @p7='marketing', @p8='e60a66268db51b68d52f81d8a990798d', @p9='2025-10-02T05:23:55.8822273+00:00' (DbType = DateTime), @p10='sent' (Nullable = false), @p11='True' (Nullable = true), @p12=NULL (DbType = Guid), @p13='2025-10-02T05:23:57.0000000+00:00' (DbType = DateTime), @p14='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"sent","timestamp":"1759382637","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","expiration_timestamp":"1759382637","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p15=NULL (DbType = Decimal), @p16=NULL, @p17='META_CLOUD' (Nullable = false), @p18='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==', @p19='ff2d1f70-a336-41cb-a0e3-d13b07a0481f', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='marketing', @p22='e60a66268db51b68d52f81d8a990798d', @p23='2025-10-02T05:23:55.8886825+00:00' (DbType = DateTime), @p24='pricing_update' (Nullable = false), @p25='True' (Nullable = true), @p26=NULL (DbType = Guid), @p27='2025-10-02T05:23:57.0000000+00:00' (DbType = DateTime), @p28='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"sent","timestamp":"1759382637","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","expiration_timestamp":"1759382637","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p29=NULL (DbType = Decimal), @p30=NULL, @p31='META_CLOUD' (Nullable = false), @p32='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "ConversationStartedAt" = @p2, "IsChargeable" = @p3
WHERE "Id" = @p4
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32);
2025-10-02 10:53:55.970 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:53:55.983 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:53:57.528 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-10-02 10:53:57.536 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:53:57.539 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:53:57.543 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"delivered","timestamp":"1759382638","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:53:57.547 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:53:57.549 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:53:57.552 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"delivered","timestamp":"1759382638","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:53:57.552 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.7802ms
2025-10-02 10:53:57.557 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:53:57.560 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:53:57.563 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 35.2213ms
2025-10-02 10:53:57.566 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='delivered', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:53:57.575 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:53:57.580 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:53:57.609 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='41ddb0c1-d8f8-44c4-9ce2-9965a2dfc998', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='e60a66268db51b68d52f81d8a990798d', @p4='2025-10-02T05:23:57.5729886+00:00' (DbType = DateTime), @p5='delivered' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:23:58.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"delivered","timestamp":"1759382638","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:53:57.615 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:53:57.620 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:53:57.627 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='428bd168-08b7-45b0-8ef9-3bd7f3dbd682', @p0='Delivered' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:53:58.404 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:23:58.4004555+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:01.939 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:54:01.943 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:01.944 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:01.950 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"read","timestamp":"1759382643","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:01.953 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:01.954 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:01.956 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.4275ms
2025-10-02 10:54:01.959 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:01.961 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.9866ms
2025-10-02 10:54:01.968 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"read","timestamp":"1759382643","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:01.970 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:01.975 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:01.979 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:01.986 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:02.012 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='e0111851-9320-41b7-bba9-0d35fe7c9ce1', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='e60a66268db51b68d52f81d8a990798d', @p4='2025-10-02T05:24:01.9783178+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:03.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==","status":"read","timestamp":"1759382643","recipient_id":"918974005240","conversation":{"id":"e60a66268db51b68d52f81d8a990798d","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:54:02.018 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:02.024 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:02.030 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='428bd168-08b7-45b0-8ef9-3bd7f3dbd682', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:54:03.671 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 603
2025-10-02 10:54:03.677 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:03.678 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:03.682 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxMzc2RTkwNUU1NjIzNURDQTY3MjE1QTBDRkE2QUYA","timestamp":"1759382644","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:54:03.684 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:03.685 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:03.687 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.3361ms
2025-10-02 10:54:03.686 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxMzc2RTkwNUU1NjIzNURDQTY3MjE1QTBDRkE2QUYA","timestamp":"1759382644","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 10:54:03.691 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:03.692 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:54:03.693 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.0058ms
2025-10-02 10:54:03.711 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:54:03.713 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxMzc2RTkwNUU1NjIzNURDQTY3MjE1QTBDRkE2QUYA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA==, Text: Yes
2025-10-02 10:54:03.726 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:54:03.736 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='428bd168-08b7-45b0-8ef9-3bd7f3dbd682' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSOUExQzIxQzIxMEFFOTlGRjY4AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:03.748 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:54:03.818 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:54:03.842 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 10:54:03.873 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:54:03.882 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:54:03.956 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='a2a8302d-44ee-4cf6-81ba-4675c0048498', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:03.8873053Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='428bd168-08b7-45b0-8ef9-3bd7f3dbd682' (Nullable = true), @p9=NULL, @p10='3c6c8ab2-e136-4546-a069-485be14a709e' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Yes'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:54:03.970 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:54:04.009 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='13', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes' (Nullable = false), @p2='Yes', @p3='2025-10-02T05:24:03.9968132Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:54:04.013 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:54:04.022 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:54:04.031 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:04.038 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:04.053 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:54:04.059 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:04.062 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:06.845 +05:30 [INF] Received HTTP response headers after 2781.1867ms - 200
2025-10-02 10:54:06.847 +05:30 [INF] End processing HTTP request after 2787.3442ms - 200
2025-10-02 10:54:06.850 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:54:06.852 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:54:06.918 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:54:06.961 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:54:06.964 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:06.966 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:07.956 +05:30 [INF] Received HTTP response headers after 988.8386ms - 200
2025-10-02 10:54:07.958 +05:30 [INF] End processing HTTP request after 994.0022ms - 200
2025-10-02 10:54:08.083 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:08.087 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:54:08.092 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:54:08.097 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:54:08.103 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:08.105 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:08.418 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:24:08.4143447+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:09.092 +05:30 [INF] Received HTTP response headers after 985.4309ms - 200
2025-10-02 10:54:09.094 +05:30 [INF] End processing HTTP request after 990.8067ms - 200
2025-10-02 10:54:09.131 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='95ed1d33-bdfc-428d-91f7-f320ea4a68af', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:09.1112546Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","message_status":"accepted"}]}', @p10='b30a9bc5-3e85-4919-80f2-1f90e01f37cc' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='da8bf615-ee53-4769-9a54-85070eaefce0', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:24:09.1098424Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='428bd168-08b7-45b0-8ef9-3bd7f3dbd682' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:24:09.1098447Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:54:10.241 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:54:10.246 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:10.248 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:10.251 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"sent","timestamp":"1759382651","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","expiration_timestamp":"1759382652","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:10.253 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:10.254 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"sent","timestamp":"1759382651","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","expiration_timestamp":"1759382652","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:10.255 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:10.256 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:10.258 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.1973ms
2025-10-02 10:54:10.262 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:10.262 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:10.264 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.9971ms
2025-10-02 10:54:10.270 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:10.279 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:10.293 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='82a2fc22d56bee0ae6ead07c61d1e314'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:10.299 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='a0bc2a16-9e01-49a9-b545-e41679a3d421', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='82a2fc22d56bee0ae6ead07c61d1e314', @p4='2025-10-02T05:24:10.2766369+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:11.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"sent","timestamp":"1759382651","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","expiration_timestamp":"1759382652","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==', @p14='b15d8599-d62a-408d-bd9d-deba119407b4', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='82a2fc22d56bee0ae6ead07c61d1e314', @p18='2025-10-02T05:24:10.2679740+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:24:11.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"sent","timestamp":"1759382651","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","expiration_timestamp":"1759382652","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:54:10.313 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:10.318 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:10.994 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:54:10.999 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:11.000 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:11.004 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"read","timestamp":"1759382652","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:11.006 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:11.007 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"read","timestamp":"1759382652","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:11.007 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:11.009 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:11.010 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.3741ms
2025-10-02 10:54:11.015 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:11.017 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:11.018 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.915ms
2025-10-02 10:54:11.023 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:11.031 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:11.037 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='82a2fc22d56bee0ae6ead07c61d1e314'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:11.061 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='28cfcb5a-bbde-4b79-bed6-2811493546e4', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='82a2fc22d56bee0ae6ead07c61d1e314', @p4='2025-10-02T05:24:11.0218579+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:12.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==","status":"read","timestamp":"1759382652","recipient_id":"918974005240","conversation":{"id":"82a2fc22d56bee0ae6ead07c61d1e314","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:54:11.069 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:11.074 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:11.079 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='da8bf615-ee53-4769-9a54-85070eaefce0', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:54:12.582 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:54:12.586 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:12.588 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:12.591 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxODJDRDlGOUYxNzY3MkZEOUI2Rjc1REVCMkY0NkEA","timestamp":"1759382654","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:54:12.594 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:12.594 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxODJDRDlGOUYxNzY3MkZEOUI2Rjc1REVCMkY0NkEA","timestamp":"1759382654","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 10:54:12.595 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:12.596 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:54:12.598 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.6641ms
2025-10-02 10:54:12.600 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:54:12.601 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:12.602 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTUxODJDRDlGOUYxNzY3MkZEOUI2Rjc1REVCMkY0NkEA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==, Text: Show Me Template 2
2025-10-02 10:54:12.604 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.0511ms
2025-10-02 10:54:12.609 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:54:12.618 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__origin_Id_0='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:12.623 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:54:12.631 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:54:12.636 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:54:12.660 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@p0='f1dc78d3-a49e-4256-a6e1-8c7b808758ae', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:12.6400761Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @p9=NULL, @p10='374d18b8-9383-4308-bd8a-818aba38db4f' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:54:12.667 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:54:12.673 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='14', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2' (Nullable = false), @p2='Show Me Template 2', @p3='2025-10-02T05:24:12.6710096Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:54:12.676 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:54:12.680 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:54:12.685 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:12.689 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:12.695 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:54:12.698 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:12.700 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:14.935 +05:30 [INF] Received HTTP response headers after 2232.9185ms - 200
2025-10-02 10:54:14.937 +05:30 [INF] End processing HTTP request after 2238.7269ms - 200
2025-10-02 10:54:14.938 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:54:14.940 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:54:14.945 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:54:14.950 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:54:14.954 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:14.955 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:15.962 +05:30 [INF] Received HTTP response headers after 1005.4099ms - 200
2025-10-02 10:54:15.964 +05:30 [INF] End processing HTTP request after 1010.2831ms - 200
2025-10-02 10:54:16.079 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:16.083 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:54:16.092 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:54:16.100 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:54:16.103 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:16.105 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:17.082 +05:30 [INF] Received HTTP response headers after 975.599ms - 200
2025-10-02 10:54:17.086 +05:30 [INF] End processing HTTP request after 983.5491ms - 200
2025-10-02 10:54:17.092 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='7a02f523-330d-47c3-a48e-9e5ed5be737d', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:17.0894928Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='66b5865a-2bb0-4b72-8bd1-c56cbe4a2196' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","message_status":"accepted"}]}', @p10='75c10239-57bf-425b-b7b3-748617153105' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='66b5865a-2bb0-4b72-8bd1-c56cbe4a2196', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:24:17.0889789Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:24:17.0889798Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:54:17.970 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:54:17.974 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:17.976 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:17.979 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"sent","timestamp":"1759382659","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","expiration_timestamp":"1759382659","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:17.981 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:17.982 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"sent","timestamp":"1759382659","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","expiration_timestamp":"1759382659","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:17.983 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:17.984 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:17.986 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.2694ms
2025-10-02 10:54:17.990 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:17.991 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:17.992 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.853ms
2025-10-02 10:54:17.997 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:18.006 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:18.011 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='cc17222d8a35be316d650e6f8d2dc2cd'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:18.017 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='5cd06df6-de17-43ce-a3b0-c923c7725391', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='cc17222d8a35be316d650e6f8d2dc2cd', @p4='2025-10-02T05:24:18.0039556+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:19.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"sent","timestamp":"1759382659","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","expiration_timestamp":"1759382659","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==', @p14='e0ddb9db-5c66-4a84-ad68-92c90f870e32', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='cc17222d8a35be316d650e6f8d2dc2cd', @p18='2025-10-02T05:24:17.9956992+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:24:19.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"sent","timestamp":"1759382659","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","expiration_timestamp":"1759382659","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:54:18.024 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:18.030 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:18.434 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:24:18.4315672+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:18.659 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:54:18.664 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:18.665 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:18.678 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"read","timestamp":"1759382660","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:18.680 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:18.681 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"read","timestamp":"1759382660","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:18.682 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:18.683 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:18.685 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.4784ms
2025-10-02 10:54:18.689 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:18.689 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:18.694 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:18.695 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 36.0064ms
2025-10-02 10:54:18.700 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:18.707 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='cc17222d8a35be316d650e6f8d2dc2cd'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:18.730 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='c195708c-fcb5-4556-8e47-de9583d68f39', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='cc17222d8a35be316d650e6f8d2dc2cd', @p4='2025-10-02T05:24:18.6930998+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:20.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA==","status":"read","timestamp":"1759382660","recipient_id":"918974005240","conversation":{"id":"cc17222d8a35be316d650e6f8d2dc2cd","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:54:18.735 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:18.742 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQzM3QTJFMDRCNEIyMDEyNDI3AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:18.748 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='66b5865a-2bb0-4b72-8bd1-c56cbe4a2196', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:54:20.495 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 10:54:20.501 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:20.502 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:20.505 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVDMEYzRjNDMUQ1NENEMzg4Q0JDODFERkNFMDY3RTYA","timestamp":"1759382661","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:54:20.508 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:20.508 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVDMEYzRjNDMUQ1NENEMzg4Q0JDODFERkNFMDY3RTYA","timestamp":"1759382661","type":"button","button":{"payload":"Show Me Template 3","text":"Show Me Template 3"}}]},"field":"messages"}]}]}
2025-10-02 10:54:20.509 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:20.510 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 10:54:20.513 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.9215ms
2025-10-02 10:54:20.514 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 10:54:20.516 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:20.517 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVDMEYzRjNDMUQ1NENEMzg4Q0JDODFERkNFMDY3RTYA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA==, Text: Show Me Template 3
2025-10-02 10:54:20.518 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 23.7134ms
2025-10-02 10:54:20.523 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 10:54:20.532 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__origin_Id_0='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMjg4Qzk2OTJFRTAwRjAyNzNCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:20.536 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 10:54:20.541 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 10:54:20.545 +05:30 [INF] 🟨 Falling back to single available link for step "00e8efb2-eb9d-4c6d-a516-1ea299da5c61"
2025-10-02 10:54:20.546 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61")
2025-10-02 10:54:20.550 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 10:54:20.555 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 10:54:20.561 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='0faeff6a-bc47-49db-b5d0-b800e5c0efe0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:20.5583974Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @p9=NULL, @p10='6f8300fb-ddb6-49ee-9751-3036461a4e9a' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 3'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 10:54:20.565 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 10:54:20.571 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='15', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3' (Nullable = false), @p2='Show Me Template 3', @p3='2025-10-02T05:24:20.5693264Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 10:54:20.574 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 10:54:20.579 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."PhoneNumber" = @__fromDigits_1
LIMIT 1
2025-10-02 10:54:20.583 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."PhoneNumberId"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."PhoneNumberId" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:20.588 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:20.593 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 10:54:20.596 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:20.598 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 10:54:21.633 +05:30 [INF] Received HTTP response headers after 1034.2526ms - 200
2025-10-02 10:54:21.635 +05:30 [INF] End processing HTTP request after 1038.8987ms - 200
2025-10-02 10:54:21.637 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 10:54:21.639 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 10:54:21.662 +05:30 [INF] Executed DbCommand (21ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 10:54:21.669 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 10:54:21.677 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:21.678 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 10:54:22.614 +05:30 [INF] Received HTTP response headers after 932.7864ms - 200
2025-10-02 10:54:22.616 +05:30 [INF] End processing HTTP request after 938.8405ms - 200
2025-10-02 10:54:22.831 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 10:54:22.834 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 10:54:22.841 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 10:54:22.846 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 10:54:22.849 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:22.851 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 10:54:24.294 +05:30 [INF] Received HTTP response headers after 1441.4763ms - 200
2025-10-02 10:54:24.296 +05:30 [INF] End processing HTTP request after 1446.5425ms - 200
2025-10-02 10:54:24.302 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='1074e8fc-41db-48fb-aca3-f9bf0943492d', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:24:24.2983173Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='10c97227-6527-4237-92f8-99cca07e2969' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","message_status":"accepted"}]}', @p10='5dc9c84f-bd64-4a43-9534-d75ec20c16b3' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='10c97227-6527-4237-92f8-99cca07e2969', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:24:24.2979863Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='da8bf615-ee53-4769-9a54-85070eaefce0' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:24:24.2979874Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 10:54:25.181 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 10:54:25.202 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:25.208 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:25.212 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"sent","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","expiration_timestamp":"1759382667","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:25.215 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:25.215 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"sent","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","expiration_timestamp":"1759382667","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:25.216 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:25.217 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:25.219 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.6931ms
2025-10-02 10:54:25.224 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:25.226 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:25.226 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 45.9467ms
2025-10-02 10:54:25.233 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:25.241 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:25.246 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='78962c345284e40709250eebcd27cee9'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:25.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p0='0034ac6a-5283-4d8a-a038-d2ab8f188785', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='78962c345284e40709250eebcd27cee9', @p4='2025-10-02T05:24:25.2303970+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:27.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"sent","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","expiration_timestamp":"1759382667","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==', @p14='b2625e25-1908-4e44-b1f4-c52b20649ce4', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='78962c345284e40709250eebcd27cee9', @p18='2025-10-02T05:24:25.2393589+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:24:27.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"sent","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","expiration_timestamp":"1759382667","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 10:54:25.259 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:25.264 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:25.893 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 10:54:25.897 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:25.899 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 10:54:25.902 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"read","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:25.904 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 10:54:25.904 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"read","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 10:54:25.905 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 10:54:25.906 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 10:54:25.908 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 7.2403ms
2025-10-02 10:54:25.912 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 10:54:25.912 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:25.914 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 21.0841ms
2025-10-02 10:54:25.920 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 10:54:25.927 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:25.932 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='78962c345284e40709250eebcd27cee9'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 10:54:25.939 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='e274b26a-982f-4113-87eb-37bf3024c597', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='78962c345284e40709250eebcd27cee9', @p4='2025-10-02T05:24:25.9186355+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:24:27.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA==","status":"read","timestamp":"1759382667","recipient_id":"918974005240","conversation":{"id":"78962c345284e40709250eebcd27cee9","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 10:54:25.943 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 10:54:25.948 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMzA2RjBGNDVGREYyMjkwRjc1AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 10:54:25.954 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p1='10c97227-6527-4237-92f8-99cca07e2969', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 10:54:28.436 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:24:28.4336071+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:38.455 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:24:38.4524157+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:48.471 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:24:48.4684547+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:54:58.487 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:24:58.4857149+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:08.492 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:25:08.4903252+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:18.510 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:25:18.5070409+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:28.532 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:25:28.5299507+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:38.544 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:25:38.5422535+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:48.561 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:25:48.5588533+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:55:58.579 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:25:58.5762723+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:08.596 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:26:08.5933296+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:18.613 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:26:18.6108583+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:28.615 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:26:28.6124216+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:38.628 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__now_0='2025-10-02T05:26:38.6221669+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:48.695 +05:30 [INF] Executed DbCommand (30ms) [Parameters=[@__now_0='2025-10-02T05:26:48.6652091+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:56:58.709 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:26:58.7071034+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:08.723 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:27:08.7213708+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:18.733 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:27:18.7311087+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:28.742 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:27:28.7392496+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:38.764 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:27:38.7613246+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:48.772 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:27:48.7703081+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:57:58.784 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:27:58.7817308+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:08.795 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:28:08.7923643+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:18.809 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:28:18.8066219+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:28.813 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:28:28.8108940+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:38.914 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:28:38.8194396+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:48.925 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:28:48.9220597+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:58:58.939 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:28:58.9376755+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:08.949 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:29:08.9468740+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:18.959 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:29:18.9560635+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:28.965 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:29:28.9631768+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:38.981 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:29:38.9790673+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:49.001 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:29:48.9979614+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 10:59:59.014 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:29:59.0112016+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:09.025 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:30:09.0233556+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:19.073 +05:30 [INF] Executed DbCommand (25ms) [Parameters=[@__now_0='2025-10-02T05:30:19.0470759+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:29.081 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:30:29.0781543+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:39.091 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:30:39.0880136+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:49.100 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:30:49.0959154+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:00:59.121 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:30:59.1179748+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:09.130 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:31:09.1278109+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:19.150 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:31:19.1474554+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:29.174 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__now_0='2025-10-02T05:31:29.1647202+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:39.191 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:31:39.1888089+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:49.211 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:31:49.2087459+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:01:59.223 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:31:59.2213172+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:09.241 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:32:09.2389139+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:19.249 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:32:19.2466024+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:29.256 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:32:29.2538272+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:39.265 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:32:39.2628241+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:49.282 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:32:49.2800488+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:02:59.289 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:32:59.2870619+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:09.300 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:33:09.2979139+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:19.309 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:33:19.3070255+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:29.318 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:33:29.3146721+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:39.430 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:33:39.3288528+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:49.448 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:33:49.4460817+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:03:59.466 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:33:59.4631971+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:09.474 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:34:09.4717936+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:19.491 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:34:19.4882830+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:29.505 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:34:29.5031933+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:39.516 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:34:39.5136079+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:49.525 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:34:49.5240579+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:04:59.529 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:34:59.5276357+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:09.538 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:09.5369024+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:19.544 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:19.5427686+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:29.554 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:29.5526921+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:39.566 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:39.5644616+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:49.589 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:49.5879761+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:05:59.598 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:35:59.5968447+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:09.612 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:36:09.6111845+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:19.625 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__now_0='2025-10-02T05:36:19.6177995+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:29.653 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:36:29.6522698+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:39.668 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:36:39.6658923+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:49.691 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:36:49.6884456+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:06:59.697 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:36:59.6956742+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:09.699 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:37:09.6975658+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:19.713 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:37:19.7114348+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:29.724 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:37:29.7225447+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:39.736 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:37:39.7339569+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:49.741 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:37:49.7382911+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:07:59.748 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:37:59.7464029+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:09.757 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:38:09.7547405+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:19.764 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:38:19.7620446+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:29.773 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:38:29.7705728+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:39.876 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:38:39.7882688+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:49.882 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:38:49.8803217+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:08:59.892 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:38:59.8893661+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:09:09.906 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:39:09.9039294+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:09:19.954 +05:30 [INF] Executed DbCommand (17ms) [Parameters=[@__now_0='2025-10-02T05:39:19.9357392+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:09:29.973 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:39:29.9713886+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:09:39.998 +05:30 [INF] Executed DbCommand (14ms) [Parameters=[@__now_0='2025-10-02T05:39:39.9826435+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:09:50.016 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:39:50.0132795+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:00.026 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:40:00.0236092+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:10.034 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:40:10.0306107+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:20.054 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:40:20.0519592+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:30.065 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:40:30.0628933+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:40.075 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:40:40.0725674+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:10:50.086 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:40:50.0848237+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:00.103 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:41:00.1009462+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:10.111 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:41:10.1090099+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:20.118 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:41:20.1168564+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:30.137 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:41:30.1347087+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:40.159 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:41:40.1574743+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:11:50.188 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='2025-10-02T05:41:50.1788615+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:00.205 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:42:00.2023647+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:10.222 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:42:10.2206945+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:20.239 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:42:20.2370444+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:30.251 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:42:30.2492099+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:40.257 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:42:40.2551691+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:12:50.268 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:42:50.2656978+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:00.275 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:43:00.2722750+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:10.296 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:43:10.2937572+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:20.309 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:43:20.3068353+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:30.316 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:43:30.3146501+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:40.408 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:43:40.3226613+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:13:50.414 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:43:50.4114826+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:00.423 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:44:00.4214119+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:10.431 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:44:10.4294413+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:20.442 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:44:20.4377518+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:30.490 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@__now_0='2025-10-02T05:44:30.4694486+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:40.502 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:44:40.5002630+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:14:50.510 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:44:50.5072382+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:15:00.523 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:45:00.5208128+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:15:31.974 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 11:15:32.037 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 11:15:32.060 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 11:15:33.375 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:15:34.189 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 11:15:34.216 +05:30 [INF] ClickLogWorker started
2025-10-02 11:15:34.894 +05:30 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 11:15:34.916 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 11:15:34.917 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__cutoff_0='2025-09-25T05:45:32.2064146Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 11:15:34.917 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 11:15:34.921 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 11:15:34.922 +05:30 [INF] Hosting environment: Development
2025-10-02 11:15:34.923 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 11:15:35.255 +05:30 [INF] ClickLogWorker stopped
2025-10-02 11:15:36.197 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 11:15:36.426 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 239.5513ms
2025-10-02 11:15:36.607 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 11:15:36.607 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:15:36.621 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 13.7848ms
2025-10-02 11:15:36.657 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 50.424ms
2025-10-02 11:15:36.824 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 11:15:37.151 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 327.4521ms
2025-10-02 11:15:39.329 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__now_0='2025-10-02T05:45:39.2318675+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:15:44.262 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 11:15:44.317 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 11:15:44.345 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__businessId_0='8390da76-10de-4d76-80f2-68b68f4e2b82'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 11:15:44.352 +05:30 [INF] ⏭️ Skipping sync for "8390da76-10de-4d76-80f2-68b68f4e2b82"; TTL not expired.
2025-10-02 11:15:44.354 +05:30 [INF] TemplateSyncWorker: biz="8390da76-10de-4d76-80f2-68b68f4e2b82" added=0 updated=0 skipped=0 syncedAt="2025-10-02T04:26:09.1215710Z"
2025-10-02 11:15:44.367 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 11:15:44.372 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 11:15:44.376 +05:30 [INF] ⏭️ Skipping sync for "9841bcab-ca71-439f-8691-d85ada887b01"; TTL not expired.
2025-10-02 11:15:44.378 +05:30 [INF] TemplateSyncWorker: biz="9841bcab-ca71-439f-8691-d85ada887b01" added=0 updated=0 skipped=0 syncedAt="2025-10-02T05:03:18.9738140Z"
2025-10-02 11:15:44.382 +05:30 [INF] TemplateSyncWorker: sweep finished in 151 ms; processed=2; next run ~"2025-10-02T11:45:44.2304751Z"
2025-10-02 11:15:49.345 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__now_0='2025-10-02T05:45:49.3380570+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:15:59.363 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:45:59.3585628+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:15:59.920 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - application/json 354
2025-10-02 11:15:59.927 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 11:16:00.054 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 11:16:00.076 +05:30 [INF] Route matched with {action = "SendTemplate", controller = "CustomApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplate(xbytechat.api.Features.CustomeApi.DTOs.DirectTemplateSendRequest, System.Threading.CancellationToken) on controller xbytechat.api.Features.CustomeApi.Controllers.CustomApiController (xbytechat.api).
2025-10-02 11:16:00.153 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__req_PhoneNumberId_0='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."IsActive" AND w."PhoneNumberId" = @__req_PhoneNumberId_0
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 11:16:00.160 +05:30 [INF] [CustomAPI:"104bb1d2-a939-4639-9911-5241c0aebfc0"] Begin send. biz="9841bcab-ca71-439f-8691-d85ada887b01" pnid=673199269218077 to=********5240 template=welcome_video
2025-10-02 11:16:00.201 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 11:16:00.291 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:00.295 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:02.315 +05:30 [INF] Received HTTP response headers after 2014.0617ms - 200
2025-10-02 11:16:02.318 +05:30 [INF] End processing HTTP request after 2030.2967ms - 200
2025-10-02 11:16:02.867 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__req_FlowConfigId_Value_0='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__req_FlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 11:16:02.874 +05:30 [INF] [CustomAPI:"104bb1d2-a939-4639-9911-5241c0aebfc0"] Sending welcome_video to ********5240 via META_CLOUD (PNID=673199269218077) video=true
2025-10-02 11:16:02.901 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 11:16:02.919 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 11:16:02.942 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:02.944 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:04.167 +05:30 [INF] Received HTTP response headers after 1220.6376ms - 200
2025-10-02 11:16:04.173 +05:30 [INF] End processing HTTP request after 1231.2274ms - 200
2025-10-02 11:16:04.485 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@p0='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='[{"i":0,"position":1,"text":"Yes","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"No","type":"QUICK_REPLY","subType":"quick_reply"}]', @p3='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p4='f468d694-c120-4e84-8ef1-024085736ca8' (Nullable = true), @p5=NULL (DbType = Guid), @p6=NULL (DbType = Guid), @p7=NULL, @p8=NULL, @p9=NULL (DbType = DateTime), @p10='2025-10-02T05:46:04.1847705Z' (DbType = DateTime), @p11=NULL, @p12=NULL (DbType = Int32), @p13=NULL (DbType = Boolean), @p14='False', @p15='https://whatsappdata.s3.ap-south-1.amazonaws.com/userMedia/dab49080d80c724aad5ebf158d63df41/vde_templ.mp4', @p16='welcome_video' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==', @p18=NULL (DbType = Decimal), @p19=NULL, @p20='META_CLOUD', @p21='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==', @p22='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","message_status":"accepted"}]}', @p23='918974005240' (Nullable = false), @p24=NULL (DbType = Guid), @p25=NULL, @p26=NULL (DbType = Guid), @p27='2025-10-02T05:46:04.1847705Z' (Nullable = true) (DbType = DateTime), @p28='custom_api', @p29='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29)
RETURNING "MessageTime";
2025-10-02 11:16:04.542 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__messageLogId_0='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @__businessId_1='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 11:16:04.602 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='1e0f05c9-2639-429f-bf3f-ba9173ee37e3', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2=NULL, @p3=NULL, @p4='2025-10-02T05:46:04.5470050+00:00' (DbType = DateTime), @p5='send_response' (Nullable = false), @p6=NULL (DbType = Boolean), @p7='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4' (Nullable = true), @p8='2025-10-02T05:46:04.5475404+00:00' (DbType = DateTime), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","message_status":"accepted"}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 11:16:04.608 +05:30 [INF] [CustomAPI:"104bb1d2-a939-4639-9911-5241c0aebfc0"] Done. success=true msgId=wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA== flow="0c5e1825-c899-41f0-b947-388dbffed015" step="f468d694-c120-4e84-8ef1-024085736ca8"
2025-10-02 11:16:04.619 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 11:16:04.641 +05:30 [INF] Executed action xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api) in 4556.5819ms
2025-10-02 11:16:04.643 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CustomeApi.Controllers.CustomApiController.SendTemplate (xbytechat.api)'
2025-10-02 11:16:04.652 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/custom/sendflow - 200 null application/json; charset=utf-8 4732.5068ms
2025-10-02 11:16:09.372 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:46:09.3679847+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:16:19.378 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:46:19.3743329+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:16:21.799 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 571
2025-10-02 11:16:21.800 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 11:16:21.817 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.817 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.822 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:21.823 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:21.835 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"delivered","timestamp":"1759383977","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:21.835 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"sent","timestamp":"1759383976","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","expiration_timestamp":"1759383976","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:21.841 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:21.841 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:21.843 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:21.844 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:21.851 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 23.3707ms
2025-10-02 11:16:21.851 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 26.0073ms
2025-10-02 11:16:21.853 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.855 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.857 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 56.8095ms
2025-10-02 11:16:21.859 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 59.8959ms
2025-10-02 11:16:21.873 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 603
2025-10-02 11:16:21.873 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 11:16:21.882 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.882 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.884 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:21.888 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:21.899 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"read","timestamp":"1759383978","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:21.899 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2N0Y0QjdCRDg2OTU2MEU5RTMxQkMxMDI2QjRBNkMA","timestamp":"1759383980","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 11:16:21.901 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:21.904 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:21.905 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:21.906 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:21.908 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 13.1796ms
2025-10-02 11:16:21.910 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 13.0101ms
2025-10-02 11:16:21.911 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.913 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:21.916 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 42.8882ms
2025-10-02 11:16:21.914 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 40.9665ms
2025-10-02 11:16:22.042 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"delivered","timestamp":"1759383977","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:22.117 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__provider_0='meta_cloud'], CommandType='"Text"', CommandTimeout='30']
SELECT w."BusinessId", w."PhoneNumberId", w."WhatsAppBusinessNumber", w."WabaId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND lower(w."Provider") = @__provider_0
2025-10-02 11:16:22.124 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:22.143 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='delivered', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.150 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.167 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:22.208 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p3='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p0='marketing', @p1='1430d474cfa9ba5d7fcf943077701849', @p2='True' (Nullable = true), @p4='1430364e-313f-4d41-9a18-6d856056896a', @p5='9841bcab-ca71-439f-8691-d85ada887b01', @p6='marketing', @p7='1430d474cfa9ba5d7fcf943077701849', @p8='2025-10-02T05:46:22.1470850+00:00' (DbType = DateTime), @p9='delivered' (Nullable = false), @p10='True' (Nullable = true), @p11=NULL (DbType = Guid), @p12='2025-10-02T05:46:17.0000000+00:00' (DbType = DateTime), @p13='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"delivered","timestamp":"1759383977","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p14=NULL (DbType = Decimal), @p15=NULL, @p16='META_CLOUD' (Nullable = false), @p17='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==', @p18='51efca8f-558e-40ae-8044-b96579172afc', @p19='9841bcab-ca71-439f-8691-d85ada887b01', @p20='marketing', @p21='1430d474cfa9ba5d7fcf943077701849', @p22='2025-10-02T05:46:22.1552303+00:00' (DbType = DateTime), @p23='pricing_update' (Nullable = false), @p24='True' (Nullable = true), @p25=NULL (DbType = Guid), @p26='2025-10-02T05:46:17.0000000+00:00' (DbType = DateTime), @p27='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"delivered","timestamp":"1759383977","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p28=NULL (DbType = Decimal), @p29=NULL, @p30='META_CLOUD' (Nullable = false), @p31='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationCategory" = @p0, "ConversationId" = @p1, "IsChargeable" = @p2
WHERE "Id" = @p3
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31);
2025-10-02 11:16:22.290 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:22.307 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:22.316 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p1='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p0='Delivered' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 11:16:22.326 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"sent","timestamp":"1759383976","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","expiration_timestamp":"1759383976","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:22.328 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:22.333 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.339 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.344 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:22.352 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p0='2025-10-01T05:46:16.0000000+00:00' (Nullable = true) (DbType = DateTime), @p2='9e5fcba2-64fe-4d11-8528-f12efe008845', @p3='9841bcab-ca71-439f-8691-d85ada887b01', @p4='marketing', @p5='1430d474cfa9ba5d7fcf943077701849', @p6='2025-10-02T05:46:22.3370294+00:00' (DbType = DateTime), @p7='sent' (Nullable = false), @p8='True' (Nullable = true), @p9=NULL (DbType = Guid), @p10='2025-10-02T05:46:16.0000000+00:00' (DbType = DateTime), @p11='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"sent","timestamp":"1759383976","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","expiration_timestamp":"1759383976","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p12=NULL (DbType = Decimal), @p13=NULL, @p14='META_CLOUD' (Nullable = false), @p15='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "ConversationStartedAt" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15);
2025-10-02 11:16:22.361 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:22.366 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:22.374 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p0='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 11:16:22.390 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"read","timestamp":"1759383978","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:22.391 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:22.397 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.404 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:22.409 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:22.416 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='a27f75a4-e123-4d0f-b835-38c5a1494151', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='1430d474cfa9ba5d7fcf943077701849', @p4='2025-10-02T05:46:22.4013464+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:46:18.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==","status":"read","timestamp":"1759383978","recipient_id":"918974005240","conversation":{"id":"1430d474cfa9ba5d7fcf943077701849","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 11:16:22.423 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:22.429 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:22.436 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 11:16:22.440 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2N0Y0QjdCRDg2OTU2MEU5RTMxQkMxMDI2QjRBNkMA","timestamp":"1759383980","type":"button","button":{"payload":"Yes","text":"Yes"}}]},"field":"messages"}]}]}
2025-10-02 11:16:22.441 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 11:16:22.458 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 11:16:22.460 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTU2N0Y0QjdCRDg2OTU2MEU5RTMxQkMxMDI2QjRBNkMA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA==, Text: Yes
2025-10-02 11:16:22.478 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 11:16:22.493 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__origin_Id_0='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSNUE4ODEzOTM4RDREMDRDMThDAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:22.509 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 11:16:22.573 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
WHERE f."CTAFlowStepId" = @__stepId_0
ORDER BY f."ButtonIndex"
2025-10-02 11:16:22.596 +05:30 [INF] ✅ Mapped click by TEXT to index 0 (flow="0c5e1825-c899-41f0-b947-388dbffed015", step="f468d694-c120-4e84-8ef1-024085736ca8")
2025-10-02 11:16:22.628 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__sourceStepId_0='f468d694-c120-4e84-8ef1-024085736ca8', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 11:16:22.640 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__stepId_0='f468d694-c120-4e84-8ef1-024085736ca8'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 11:16:22.745 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='dd7e20b3-919e-44f3-9fc7-1e3527275ee0', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:46:22.6459545Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4' (Nullable = true), @p9=NULL, @p10='e30f6ce1-9943-4a28-b84c-e5df7e1defdd' (Nullable = true), @p11=NULL (DbType = Guid), @p12='f468d694-c120-4e84-8ef1-024085736ca8', @p13='welcome_video' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Yes'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 11:16:22.762 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 11:16:22.802 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='16', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes' (Nullable = false), @p2='Yes', @p3='2025-10-02T05:46:22.7888540Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 11:16:22.806 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 11:16:22.817 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__8__locals1_fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__8__locals1_businessId_0 AND c."PhoneNumber" = @__8__locals1_fromDigits_1
LIMIT 1
2025-10-02 11:16:22.827 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__8__locals1_businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 11:16:22.847 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 11:16:22.855 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 11:16:22.857 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 11:16:28.525 +05:30 [INF] Received HTTP response headers after 5666.4273ms - 200
2025-10-02 11:16:28.528 +05:30 [INF] End processing HTTP request after 5673.6762ms - 200
2025-10-02 11:16:28.531 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 11:16:28.532 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 11:16:28.598 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 11:16:28.642 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 11:16:28.646 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:28.648 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:29.387 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:46:29.3842433+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:16:29.630 +05:30 [INF] Received HTTP response headers after 980.9492ms - 200
2025-10-02 11:16:29.632 +05:30 [INF] End processing HTTP request after 986.6882ms - 200
2025-10-02 11:16:29.747 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 11:16:29.750 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="00e8efb2-eb9d-4c6d-a516-1ea299da5c61" tmpl=template_1 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 11:16:29.756 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 11:16:29.760 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 11:16:29.766 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:29.768 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:31.538 +05:30 [INF] Received HTTP response headers after 1768.7145ms - 200
2025-10-02 11:16:31.541 +05:30 [INF] End processing HTTP request after 1775.2473ms - 200
2025-10-02 11:16:31.576 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@p0='ee15cc22-60b3-48e5-97e9-71bac0a17d97', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:46:31.5578471Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='3249225a-5665-4e7b-84d2-1931eb0b253c' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","message_status":"accepted"}]}', @p10='92384ac2-b3cc-45d4-970b-3e524125281d' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='3249225a-5665-4e7b-84d2-1931eb0b253c', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21='[{"i":0,"t":"Show Me Template 2","ty":"QUICK_REPLY","v":"","ns":"0f631cc5-7088-49ad-82c6-2f7a13484896"}]', @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='00e8efb2-eb9d-4c6d-a516-1ea299da5c61' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:46:31.5568076Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_1' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='19fe52b8-8f2f-4b6f-a137-923c3f1f67d4' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:46:31.5568101Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 11:16:32.673 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 11:16:32.678 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:32.680 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:32.683 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"sent","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","expiration_timestamp":"1759383994","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:32.685 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:32.686 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"sent","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","expiration_timestamp":"1759383994","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:32.687 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:32.691 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.849ms
2025-10-02 11:16:32.689 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:32.693 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:32.698 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 24.28ms
2025-10-02 11:16:32.698 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:32.707 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:32.713 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:32.725 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='634699f2bee153cd968f210f93b740ac'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:32.731 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='139718d3-5077-4a5e-be95-77bc27cd1c55', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='634699f2bee153cd968f210f93b740ac', @p4='2025-10-02T05:46:32.7059672+00:00' (DbType = DateTime), @p5='sent' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:46:34.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"sent","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","expiration_timestamp":"1759383994","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==', @p14='76f22595-c5cf-41b5-9b7a-213bb18389ab', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='634699f2bee153cd968f210f93b740ac', @p18='2025-10-02T05:46:32.7110634+00:00' (DbType = DateTime), @p19='pricing_update' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:46:34.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"sent","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","expiration_timestamp":"1759383994","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 11:16:32.738 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:32.743 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:33.053 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 11:16:33.059 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:33.062 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:33.065 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"read","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:33.068 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:33.068 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"read","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:33.069 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:33.070 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:33.072 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 6.9695ms
2025-10-02 11:16:33.076 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:33.078 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:33.083 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:33.084 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 30.4018ms
2025-10-02 11:16:33.088 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:33.097 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='634699f2bee153cd968f210f93b740ac'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:33.103 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='e3aac4c3-e090-4ac1-b87f-5cf028aa63ed', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='634699f2bee153cd968f210f93b740ac', @p4='2025-10-02T05:46:33.0811569+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:46:34.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==","status":"read","timestamp":"1759383994","recipient_id":"918974005240","conversation":{"id":"634699f2bee153cd968f210f93b740ac","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 11:16:33.109 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:33.114 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:33.120 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='3249225a-5665-4e7b-84d2-1931eb0b253c', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 11:16:39.406 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:46:39.4027315+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:16:49.418 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:46:49.4136924+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:16:53.344 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 633
2025-10-02 11:16:53.349 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:53.350 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:53.354 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNUJFN0I1OUMxQkNDQUIxN0QxQTJDQUM4MzZBMzcA","timestamp":"1759384014","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 11:16:53.356 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:53.356 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"contacts":[{"profile":{"name":"S K"},"wa_id":"918974005240"}],"messages":[{"context":{"from":"15551622077","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=="},"from":"918974005240","id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNUJFN0I1OUMxQkNDQUIxN0QxQTJDQUM4MzZBMzcA","timestamp":"1759384014","type":"button","button":{"payload":"Show Me Template 2","text":"Show Me Template 2"}}]},"field":"messages"}]}]}
2025-10-02 11:16:53.357 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:53.359 +05:30 [INF] 👉 Routing to Click Processor (legacy 'button')
2025-10-02 11:16:53.362 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 8.664ms
2025-10-02 11:16:53.363 +05:30 [WRN] 📥 [ENTERED CLICK PROCESSOR]
2025-10-02 11:16:53.364 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:53.365 +05:30 [INF] 🖱️ Button Click → From: 918974005240, ClickId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAEhggQTVBNUJFN0I1OUMxQkNDQUIxN0QxQTJDQUM4MzZBMzcA, OrigMsgId: wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA==, Text: Show Me Template 2
2025-10-02 11:16:53.367 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 22.702ms
2025-10-02 11:16:53.372 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__originalMessageId_0='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."MessageId" = @__originalMessageId_0 AND m."CTAFlowConfigId" IS NOT NULL AND m."CTAFlowStepId" IS NOT NULL
LIMIT 1
2025-10-02 11:16:53.382 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__origin_Id_0='3249225a-5665-4e7b-84d2-1931eb0b253c' (Nullable = true), @__originalMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSN0ExQkQ0OTJCQUYwQTFCODJCAA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."RunId"
FROM "CampaignSendLogs" AS c
WHERE c."MessageLogId" = @__origin_Id_0 OR c."MessageId" = @__originalMessageId_1
ORDER BY c."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:53.387 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__fromDigits_1='918974005240', @__fromRaw_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__businessId_0 AND (c."PhoneNumber" = @__fromDigits_1 OR c."PhoneNumber" = @__fromRaw_2)
LIMIT 1
2025-10-02 11:16:53.397 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__sourceStepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__buttonIndex_2='0'], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM "FlowButtonLinks" AS f
INNER JOIN "CTAFlowSteps" AS c ON f."CTAFlowStepId" = c."Id"
WHERE f."CTAFlowStepId" = @__sourceStepId_0 AND f."NextStepId" IS NOT NULL AND c."CTAFlowConfigId" = @__flowId_1 AND f."ButtonIndex" = @__buttonIndex_2
LIMIT 2
2025-10-02 11:16:53.403 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__stepId_0='00e8efb2-eb9d-4c6d-a516-1ea299da5c61'], CommandType='"Text"', CommandTimeout='30']
SELECT c."TemplateToSend"
FROM "CTAFlowSteps" AS c
WHERE c."Id" = @__stepId_0
LIMIT 1
2025-10-02 11:16:53.409 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='9efca9e3-b69a-4ad9-b857-baf7ca15d70e', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:46:53.4062257Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='3249225a-5665-4e7b-84d2-1931eb0b253c' (Nullable = true), @p9=NULL, @p10='c1d49cec-b94b-41cc-b5a6-0cde01758de6' (Nullable = true), @p11=NULL (DbType = Guid), @p12='00e8efb2-eb9d-4c6d-a516-1ea299da5c61', @p13='template_1' (Nullable = false), @p14='True', @p15=NULL, @p16='quick_reply', @p17=NULL (DbType = Guid), @p18='Show Me Template 2'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-10-02 11:16:53.414 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__flowId_1='0c5e1825-c899-41f0-b947-388dbffed015', @__fromDigits_2='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BusinessId", c."ClickCount", c."ContactPhone", c."CreatedAt", c."FlowId", c."JourneyText", c."LastButtonText", c."UpdatedAt"
FROM "ContactJourneyStates" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."FlowId" = @__flowId_1 AND c."ContactPhone" = @__fromDigits_2
LIMIT 2
2025-10-02 11:16:53.420 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@p4='40194c10-13c3-45ed-94fb-99a8912e265e', @p0='17', @p1='Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2' (Nullable = false), @p2='Show Me Template 2', @p3='2025-10-02T05:46:53.4179940Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "ContactJourneyStates" SET "ClickCount" = @p0, "JourneyText" = @p1, "LastButtonText" = @p2, "UpdatedAt" = @p3
WHERE "Id" = @p4;
2025-10-02 11:16:53.424 +05:30 [INF] 🧵 Journey update: Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", flow="0c5e1825-c899-41f0-b947-388dbffed015", phone=918974005240)
2025-10-02 11:16:53.429 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__8__locals1_businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__8__locals1_fromDigits_1='918974005240'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AssignedAgentId", c."BusinessId", c."CreatedAt", c."Email", c."Group", c."IsActive", c."IsArchived", c."IsAutomationPaused", c."IsFavorite", c."LastCTAInteraction", c."LastCTAType", c."LastClickedProductId", c."LastContactedAt", c."LeadSource", c."Name", c."NextFollowUpAt", c."Notes", c."PhoneNumber", c."ProfileName", c."ProfileNameUpdatedAt", c."Tags"
FROM "Contacts" AS c
WHERE c."BusinessId" = @__8__locals1_businessId_0 AND c."PhoneNumber" = @__8__locals1_fromDigits_1
LIMIT 1
2025-10-02 11:16:53.435 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_businessId_0 AND w."IsActive" AND w."WhatsAppBusinessNumber" IS NOT NULL
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 11:16:53.440 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."BearerToken", c."BusinessId", c."CreatedAt", c."IsActive", c."UpdatedAt", c."Url"
FROM "CustomerWebhookConfigs" AS c
WHERE c."BusinessId" = @__businessId_0 AND c."IsActive"
2025-10-02 11:16:53.444 +05:30 [INF] Start processing HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 11:16:53.445 +05:30 [INF] Sending HTTP request POST https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca
2025-10-02 11:16:54.726 +05:30 [INF] Received HTTP response headers after 1278.8912ms - 200
2025-10-02 11:16:54.728 +05:30 [INF] End processing HTTP request after 1284.0047ms - 200
2025-10-02 11:16:54.729 +05:30 [INF] CTA Journey posted to https://webhook.site/c5a8e6f1-509b-4b4a-b090-68f3d96c99ca | 200
2025-10-02 11:16:54.731 +05:30 [INF] 📤 CTAJourney posted (running): Yes/Show Me Template 2/Show Me Template 3/No/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2/Show Me Template 3/Yes/Show Me Template 2 (biz="9841bcab-ca71-439f-8691-d85ada887b01", phone=918974005240)
2025-10-02 11:16:54.736 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_TargetStepId_0='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @__8__locals1_context_FlowId_1='0c5e1825-c899-41f0-b947-388dbffed015'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."CTAFlowConfigId", t."PositionX", t."PositionY", t."ProfileNameSlot", t."RequiredSource", t."RequiredTag", t."StepOrder", t."TemplateToSend", t."TemplateType", t."TriggerButtonText", t."TriggerButtonType", t."UseProfileName", f."Id", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
FROM (
    SELECT c."Id", c."CTAFlowConfigId", c."PositionX", c."PositionY", c."ProfileNameSlot", c."RequiredSource", c."RequiredTag", c."StepOrder", c."TemplateToSend", c."TemplateType", c."TriggerButtonText", c."TriggerButtonType", c."UseProfileName"
    FROM "CTAFlowSteps" AS c
    WHERE c."Id" = @__8__locals1_context_TargetStepId_0 AND c."CTAFlowConfigId" = @__8__locals1_context_FlowId_1
    LIMIT 1
) AS t
LEFT JOIN "FlowButtonLinks" AS f ON t."Id" = f."CTAFlowStepId"
ORDER BY t."Id"
2025-10-02 11:16:54.741 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 11:16:54.744 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:54.745 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 11:16:55.751 +05:30 [INF] Received HTTP response headers after 1004.3696ms - 200
2025-10-02 11:16:55.754 +05:30 [INF] End processing HTTP request after 1010.2145ms - 200
2025-10-02 11:16:56.064 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_context_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__8__locals1_context_BusinessId_0 AND w."IsActive"
ORDER BY COALESCE(w."UpdatedAt", w."CreatedAt") DESC
LIMIT 1
2025-10-02 11:16:56.068 +05:30 [INF] ➡️ SEND-INTENT flow="0c5e1825-c899-41f0-b947-388dbffed015" step="0f631cc5-7088-49ad-82c6-2f7a13484896" tmpl=template_2 to=918974005240 provider=META_CLOUD/673199269218077
2025-10-02 11:16:56.073 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 11:16:56.079 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 11:16:56.083 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:56.085 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 11:16:57.183 +05:30 [INF] Received HTTP response headers after 1096.41ms - 200
2025-10-02 11:16:57.185 +05:30 [INF] End processing HTTP request after 1102.2263ms - 200
2025-10-02 11:16:57.191 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='cadd3dfe-2f1a-47e6-8e23-1cf3033dc6c5', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='0' (Nullable = true), @p3=NULL (DbType = Guid), @p4='918974005240', @p5=NULL, @p6='2025-10-02T05:46:57.1883432Z' (DbType = DateTime), @p7='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p8='3645e561-562d-4a2f-84ee-5b6b4fb309ec' (Nullable = true), @p9='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","message_status":"accepted"}]}', @p10='891e5626-8be2-48d9-bef0-75ad6842f28d' (Nullable = true), @p11=NULL (DbType = Guid), @p12='0f631cc5-7088-49ad-82c6-2f7a13484896', @p13='template_2' (Nullable = false), @p14='True', @p15=NULL, @p16=NULL, @p17=NULL (DbType = Guid), @p18=NULL, @p19='3645e561-562d-4a2f-84ee-5b6b4fb309ec', @p20='9841bcab-ca71-439f-8691-d85ada887b01', @p21=NULL, @p22='0c5e1825-c899-41f0-b947-388dbffed015' (Nullable = true), @p23='0f631cc5-7088-49ad-82c6-2f7a13484896' (Nullable = true), @p24=NULL (DbType = Guid), @p25=NULL (DbType = Guid), @p26=NULL, @p27=NULL, @p28=NULL (DbType = DateTime), @p29='2025-10-02T05:46:57.1875343Z' (DbType = DateTime), @p30=NULL, @p31='1' (Nullable = true), @p32=NULL (DbType = Boolean), @p33='False', @p34=NULL, @p35='template_2' (Nullable = false), @p36='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==', @p37=NULL (DbType = Decimal), @p38=NULL, @p39=NULL, @p40=NULL, @p41='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","message_status":"accepted"}]}', @p42='918974005240' (Nullable = false), @p43='3249225a-5665-4e7b-84d2-1931eb0b253c' (Nullable = true), @p44=NULL, @p45=NULL (DbType = Guid), @p46='2025-10-02T05:46:57.1875361Z' (Nullable = true) (DbType = DateTime), @p47='flow', @p48='Sent' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "FlowExecutionLogs" ("Id", "BusinessId", "ButtonIndex", "CampaignSendLogId", "ContactPhone", "ErrorMessage", "ExecutedAt", "FlowId", "MessageLogId", "RawResponse", "RequestId", "RunId", "StepId", "StepName", "Success", "TemplateName", "TemplateType", "TrackingLogId", "TriggeredByButton")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46, @p47, @p48)
RETURNING "MessageTime";
2025-10-02 11:16:58.161 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 602
2025-10-02 11:16:58.166 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:58.167 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:58.198 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"sent","timestamp":"1759384019","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","expiration_timestamp":"1759384019","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:58.201 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:58.203 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"sent","timestamp":"1759384019","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","expiration_timestamp":"1759384019","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:58.213 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:58.212 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:58.218 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='sent', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:58.226 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 28.1868ms
2025-10-02 11:16:58.231 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:58.232 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:58.240 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:58.242 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 81.6049ms
2025-10-02 11:16:58.249 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='341b17ef445a00e9e49972e4748509c8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:58.278 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p0='59902bac-38e6-4a00-9313-ecb6de3d827f', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='341b17ef445a00e9e49972e4748509c8', @p4='2025-10-02T05:46:58.2355252+00:00' (DbType = DateTime), @p5='pricing_update' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:46:59.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"sent","timestamp":"1759384019","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","expiration_timestamp":"1759384019","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==', @p14='cc5e34b1-586c-4fb9-8ec9-028197ff884a', @p15='9841bcab-ca71-439f-8691-d85ada887b01', @p16='marketing', @p17='341b17ef445a00e9e49972e4748509c8', @p18='2025-10-02T05:46:58.2282471+00:00' (DbType = DateTime), @p19='sent' (Nullable = false), @p20='True' (Nullable = true), @p21=NULL (DbType = Guid), @p22='2025-10-02T05:46:59.0000000+00:00' (DbType = DateTime), @p23='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"sent","timestamp":"1759384019","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","expiration_timestamp":"1759384019","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p24=NULL (DbType = Decimal), @p25=NULL, @p26='META_CLOUD' (Nullable = false), @p27='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27);
2025-10-02 11:16:58.304 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:58.310 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:59.026 +05:30 [INF] Request starting HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - application/json 566
2025-10-02 11:16:59.031 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:59.034 +05:30 [INF] Route matched with {action = "HandleStatus", controller = "WhatsAppWebhook"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult HandleStatus(System.Text.Json.JsonElement) on controller xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController (xbytechat.api).
2025-10-02 11:16:59.039 +05:30 [WRN] 📥 Webhook received at controller:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"read","timestamp":"1759384020","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:59.042 +05:30 [INF] 📥 Webhook payload enqueued successfully.
2025-10-02 11:16:59.043 +05:30 [WRN] 📦 Dispatcher Raw Payload:
{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"read","timestamp":"1759384020","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}
2025-10-02 11:16:59.044 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType186`1[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 11:16:59.045 +05:30 [INF] 📦 Routing to Unified Status Updater (provider=meta, businessId="9841bcab-ca71-439f-8691-d85ada887b01")
2025-10-02 11:16:59.048 +05:30 [INF] Executed action xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api) in 9.7398ms
2025-10-02 11:16:59.052 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='read', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:59.053 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Webhooks.Controllers.WhatsAppWebhookController.HandleStatus (xbytechat.api)'
2025-10-02 11:16:59.060 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__provider_1='META_CLOUD', @__eventType_2='pricing_update', @__providerMessageId_3='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "ProviderBillingEvents" AS p
    WHERE p."BusinessId" = @__businessId_0 AND p."Provider" = @__provider_1 AND p."EventType" = @__eventType_2 AND p."ProviderMessageId" = @__providerMessageId_3)
2025-10-02 11:16:59.061 +05:30 [INF] Request finished HTTP/1.1 POST http://393ba082ed25.ngrok-free.app/api/webhooks/whatsapp - 200 null application/json; charset=utf-8 35.3913ms
2025-10-02 11:16:59.066 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__providerMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ProviderMessageId" = @__providerMessageId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:59.079 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__businessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__conversationId_1='341b17ef445a00e9e49972e4748509c8'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__businessId_0 AND m."ConversationId" = @__conversationId_1
ORDER BY m."CreatedAt" DESC
LIMIT 1
2025-10-02 11:16:59.103 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[@p0='31a678a9-503c-48d9-afa2-52aa12929cc1', @p1='9841bcab-ca71-439f-8691-d85ada887b01', @p2='marketing', @p3='341b17ef445a00e9e49972e4748509c8', @p4='2025-10-02T05:46:59.0579746+00:00' (DbType = DateTime), @p5='read' (Nullable = false), @p6='True' (Nullable = true), @p7=NULL (DbType = Guid), @p8='2025-10-02T05:47:00.0000000+00:00' (DbType = DateTime), @p9='{"object":"whatsapp_business_account","entry":[{"id":"744548247936621","changes":[{"value":{"messaging_product":"whatsapp","metadata":{"display_phone_number":"15551622077","phone_number_id":"673199269218077"},"statuses":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA==","status":"read","timestamp":"1759384020","recipient_id":"918974005240","conversation":{"id":"341b17ef445a00e9e49972e4748509c8","origin":{"type":"marketing"}},"pricing":{"billable":true,"pricing_model":"PMP","category":"marketing","type":"regular"}}]},"field":"messages"}]}]}' (Nullable = false), @p10=NULL (DbType = Decimal), @p11=NULL, @p12='META_CLOUD' (Nullable = false), @p13='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-10-02 11:16:59.110 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AllowRetry", c."Browser", c."BusinessId", c."ButtonBundleJson", c."CTAFlowConfigId", c."CTAFlowStepId", c."CampaignId", c."City", c."ClickType", c."ClickedAt", c."ContactId", c."Country", c."CreatedAt", c."CreatedBy", c."DeliveredAt", c."DeviceInfo", c."DeviceType", c."ErrorMessage", c."IpAddress", c."IsClicked", c."LastRetryAt", c."LastRetryStatus", c."MacAddress", c."MessageBody", c."MessageId", c."MessageLogId", c."ReadAt", c."RecipientId", c."RetryCount", c."RunId", c."SendStatus", c."SentAt", c."SourceChannel", c."TemplateId", c."UserId"
FROM "CampaignSendLogs" AS c
WHERE c."BusinessId" = @__ev_BusinessId_0 AND c."MessageId" = @__ev_ProviderMessageId_1
LIMIT 1
2025-10-02 11:16:59.115 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__ev_BusinessId_0='9841bcab-ca71-439f-8691-d85ada887b01', @__ev_ProviderMessageId_1='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSQUJGNUI5NUY2NkM0RDg2RDk2AA=='], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."BusinessId" = @__ev_BusinessId_0 AND (m."ProviderMessageId" = @__ev_ProviderMessageId_1 OR m."MessageId" = @__ev_ProviderMessageId_1)
LIMIT 1
2025-10-02 11:16:59.120 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p1='3645e561-562d-4a2f-84ee-5b6b4fb309ec', @p0='Read' (Nullable = false)], CommandType='"Text"', CommandTimeout='30']
UPDATE "MessageLogs" SET "Status" = @p0
WHERE "Id" = @p1
RETURNING "MessageTime";
2025-10-02 11:16:59.436 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:46:59.4337614+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:09.445 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:47:09.4423677+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:19.457 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:47:19.4535917+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:29.480 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:47:29.4784177+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:39.496 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:47:39.4936603+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:49.509 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__now_0='2025-10-02T05:47:49.5046021+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:17:59.525 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:47:59.5218915+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:09.531 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:48:09.5284293+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:19.533 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:48:19.5296908+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:29.547 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:48:29.5436070+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:39.560 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__now_0='2025-10-02T05:48:39.5581082+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:49.580 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:48:49.5785502+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:18:59.594 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:48:59.5913622+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:19:08.624 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 11:19:08.641 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 17.1769ms
2025-10-02 11:19:08.695 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 11:19:08.697 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 11:19:08.705 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 8.172ms
2025-10-02 11:19:08.728 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.848ms
2025-10-02 11:19:09.211 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 11:19:09.342 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 130.6191ms
2025-10-02 11:19:09.606 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__now_0='2025-10-02T05:49:09.6033832+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 11:20:06.355 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:20:33.711 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:20:34.387 +05:30 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:20:34.415 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:20:34.498 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:20:34.567 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:20:34.568 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:20:34.578 +05:30 [INF] Applying migration '20251002055008_ContactJourneyStateRemote'.
2025-10-02 11:20:34.735 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251002055008_ContactJourneyStateRemote', '8.0.18');
2025-10-02 11:21:48.858 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:21:50.587 +05:30 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:21:50.601 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:22:05.307 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:22:06.108 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:22:06.127 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:22:06.321 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:22:06.403 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:22:06.404 +05:30 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:22:06.415 +05:30 [INF] No migrations were applied. The database is already up to date.
2025-10-02 11:22:43.784 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:23:17.068 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:23:49.986 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:24:15.474 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 11:24:32.912 +05:30 [INF] Executed DbCommand (235ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:24:33.075 +05:30 [INF] Executed DbCommand (141ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:24:41.473 +05:30 [INF] Executed DbCommand (132ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:24:49.747 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-02 11:24:49.868 +05:30 [INF] Executed DbCommand (120ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-02 11:24:49.882 +05:30 [INF] Applying migration '20251002040402_ContactJourneyStateLocal'.
2025-10-02 11:24:50.210 +05:30 [INF] Executed DbCommand (124ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "ContactJourneyStates" (
    "Id" uuid NOT NULL,
    "BusinessId" uuid NOT NULL,
    "FlowId" uuid NOT NULL,
    "ContactPhone" character varying(32) NOT NULL,
    "JourneyText" text NOT NULL,
    "ClickCount" integer NOT NULL,
    "LastButtonText" character varying(256),
    "CreatedAt" timestamp with time zone NOT NULL,
    "UpdatedAt" timestamp with time zone NOT NULL,
    CONSTRAINT "PK_ContactJourneyStates" PRIMARY KEY ("Id")
);
2025-10-02 11:24:50.380 +05:30 [INF] Executed DbCommand (169ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_ContactJourneyStates_BusinessId_FlowId_ContactPhone" ON "ContactJourneyStates" ("BusinessId", "FlowId", "ContactPhone");
2025-10-02 11:24:50.482 +05:30 [INF] Executed DbCommand (102ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251002040402_ContactJourneyStateLocal', '8.0.18');
2025-10-02 11:24:50.589 +05:30 [INF] Applying migration '20251002055008_ContactJourneyStateRemote'.
2025-10-02 11:24:50.892 +05:30 [INF] Executed DbCommand (178ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251002055008_ContactJourneyStateRemote', '8.0.18');
2025-10-02 11:24:50.994 +05:30 [INF] Applying migration '20251002055351_ContactJourneyStateHostinger'.
2025-10-02 11:24:51.301 +05:30 [INF] Executed DbCommand (196ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20251002055351_ContactJourneyStateHostinger', '8.0.18');
2025-10-02 12:58:18.826 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 12:58:18.870 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 12:58:18.885 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 12:58:19.734 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 12:58:20.293 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 12:58:20.309 +05:30 [INF] ClickLogWorker started
2025-10-02 12:58:20.515 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 12:58:20.516 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 12:58:20.517 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 12:58:20.517 +05:30 [INF] Hosting environment: Development
2025-10-02 12:58:20.518 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 12:58:21.353 +05:30 [INF] ClickLogWorker stopped
2025-10-02 12:58:22.431 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 12:58:22.596 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 171.9194ms
2025-10-02 12:58:22.616 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 12:58:22.623 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 6.7516ms
2025-10-02 12:58:22.681 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 12:58:22.710 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.6802ms
2025-10-02 12:58:22.921 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 12:58:23.152 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 230.5605ms
2025-10-02 12:58:28.981 +05:30 [INF] Executed DbCommand (142ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 12:58:29.055 +05:30 [INF] Executed DbCommand (181ms) [Parameters=[@__cutoff_0='2025-09-25T07:28:18.9997143Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 12:58:30.472 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 12:58:30.704 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 12:58:30.892 +05:30 [INF] Executed DbCommand (169ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 12:58:30.978 +05:30 [INF] Start processing HTTP request GET https://partnersv1.pinbot.ai/v3/1739729380310347/message_templates?limit=100
2025-10-02 12:58:30.986 +05:30 [INF] Sending HTTP request GET https://partnersv1.pinbot.ai/v3/1739729380310347/message_templates?limit=100
2025-10-02 12:58:33.000 +05:30 [INF] Received HTTP response headers after 2010.9704ms - 200
2025-10-02 12:58:33.001 +05:30 [INF] End processing HTTP request after 2027.0829ms - 200
2025-10-02 12:58:33.617 +05:30 [INF] Executed DbCommand (225ms) [Parameters=[@__now_0='2025-10-02T07:28:25.3204767+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:58:33.627 +05:30 [INF] Executed DbCommand (194ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b', @__providerKey_1='pinnacle'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."Body", w."BusinessId", w."ButtonsJson", w."Category", w."CreatedAt", w."ExternalId", w."HasImageHeader", w."IsActive", w."Language", w."LastSyncedAt", w."Name", w."PlaceholderCount", w."Provider", w."RawJson", w."Status", w."UpdatedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__providerKey_1
2025-10-02 12:58:34.022 +05:30 [INF] Executed DbCommand (145ms) [Parameters=[@p3='035c7d5e-f958-4406-9560-473ce409e23f', @p0='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p1='{"name":"komalji_success","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/491876204_1677615129527866_3417219256703638441_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=kBOxWhi_Jy8Q7kNvwHbyC4d&_nc_oc=AdnA3Bcj2EcWgsuRPFNnFJQ2IzluCae121skCBpjeQM-nz9MX_Lc5IkHQjocbPbNeEw&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gFLcdF3_-Ivh1soaQwoSmP-v7wJME2RdWYn8MwWVrF54Q&oe=6905A86E"]}},{"type":"BODY","text":"Komal ji ne prakritik tareeke se apna diabetes control kiya 🙌\nNirvasa Diabetic Care Tablets ke saath – 100% Ayurvedic aur doctor se approved!\nAap bhi shuruat kijiye aaj se"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"How To Use"},{"type":"QUICK_REPLY","text":"Price"},{"type":"QUICK_REPLY","text":"Ingredients"}]}],"language":"en","status":"APPROVED","category":"MARKETING","id":"1677615126194533"}' (Nullable = false), @p2='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p7='2845fa10-bbc2-43d0-95ff-74fe94258faf', @p4='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p5='{"name":"amarnath_ji_success","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/491870437_1725292538109063_7207233851851458384_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=Eh7W_PqW5fgQ7kNvwEgHNrD&_nc_oc=AdkivBjl2ntABR1wY3VXXdZmk4dibQvUa4W6SG0I1srEoIx6aebEOanOmMxo6yBfVuI&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gGGw70-t1WPNzc9fggkNLqPf-uAl5BI-bMEjaNLBbIVyw&oe=6905945F"]}},{"type":"BODY","text":"Amarnath ji ne sugar control kiya naturally 💚\nNirvasa Diabetic Care Tablets se!\nAap bhi try karo"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"How To Use"},{"type":"QUICK_REPLY","text":"Price"},{"type":"QUICK_REPLY","text":"Ingredients"}]}],"language":"en","status":"APPROVED","category":"MARKETING","id":"1725292534775730"}' (Nullable = false), @p6='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p9='3757bb82-0bcc-4a8a-b807-077c8b3b6322', @p8='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p11='3d3af58b-a56f-4078-a03d-cd7ec86240f7', @p10='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p15='5acb83bf-73c3-44dd-a1e8-12278aa29168', @p12='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p13='{"name":"diabetes_ingredients","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/491974282_1208578127278948_7902516058982473270_n.jpg?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=MeHGLL9y62QQ7kNvwFVxsB0&_nc_oc=Adls-tMD5jU5pVful1pfoTJFf8cLkTlb7MqSa5Tme7KnNNrbfKSSEHxgwAdFnkFOBEA&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gFM_UDbu-GEpRLezqgTyf1pN8T9_7KTv_fy3OWKqOXI3Q&oe=69059BA5"]}},{"type":"BODY","text":"Yeh Ayurvedic Tablet karela, jamun aur 11+ powerful ingredients se milkar bani hai 🤩\nIsme shamil hain nature ke best herbs jaise – Gudmar, Giloy, Tulsi, Haritaki, Vijaysar, Ashwagandha, Methi, Shilajit, Harad, Beheda aur Amla – jo aapke blood sugar levels ko manage karne mein madad karte hain aur din bhar aapko energetic banaye rakhte hain! 🌿💪\n\nClick the option below to continue 👇"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"How To Use"},{"type":"QUICK_REPLY","text":"Price"},{"type":"QUICK_REPLY","text":"Buy Now"}]}],"language":"en","status":"APPROVED","category":"MARKETING","id":"1208578123945615"}' (Nullable = false), @p14='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p17='5b94dfa1-b900-4638-914a-566a2c3a5138', @p16='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p21='613db7e1-26c6-46bd-b22a-b0cf8e3e6ea1', @p18='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p19='{"name":"doctor_card","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"IMAGE","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/491870559_767977292387620_7742696761859400074_n.png?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=pEpSTeFq9a8Q7kNvwGAOAnR&_nc_oc=AdlM-qx7JUBhskmkvrNemL_mjwVVtH6YLGIeycbsHn-uJqdCK-klALlEw7jQweddNTc&_nc_zt=3&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gEc2NAZgfFcMTergIWp8gMSY9gwKcYsWi0Bb-mKrT1OQg&oe=6905AFA7"]}},{"type":"BODY","text":"Hello *{{1}}* ,\n\nYour personal consultation with our expert doctor is starting now!\nYour journey to better health begins here.","example":{"body_text":[["Aquib"]]}},{"type":"FOOTER","text":"Nirvasa Health"}],"language":"en","status":"APPROVED","category":"UTILITY","id":"767977279054288"}' (Nullable = false), @p20='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p23='7f47b2c6-b04d-426c-9485-65ca588ee21e', @p22='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p25='ba290a48-3dd8-4df9-8ef0-2f62060172c4', @p24='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p29='c232ef98-ba74-4982-9705-8ba432e46a94', @p26='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p27='{"name":"vaji_amrit_order_deliver","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/551784661_821082360351530_6190586438851339174_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=9s-2rhX8gI0Q7kNvwHijqqW&_nc_oc=AdkqPLEweKZET57-PGfkVVIGWCWnFUcOvu9etbeHyfRV2zQNIizRcTPSX0LJZQHMmf0&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gHkzyW66f21DGAQVVZSir1Q2ZWbNTkDAEMTOqA4PgZE9w&oe=6905B319"]}},{"type":"BODY","text":"Hello {{1}} 👋\nAapka order successfully deliver ho chuka hai. 🚚✨\nKya aapne Nirvasa ka Vaji Amrit Vati lena start kar diya hai? 💊\nNeeche diye gaye options me se select karke bataye 👇","example":{"body_text":[["Gaurav Sharma (Name which is shown on customers whatsapp)"]]}},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Yes"},{"type":"QUICK_REPLY","text":"No"}]}],"language":"en","status":"APPROVED","category":"MARKETING","id":"821082357018197"}' (Nullable = false), @p28='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p31='cb1c5a94-e6e5-4ec7-b9f4-4e06ecfa866f', @p30='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p35='cff87328-c306-4321-9f0c-179cc33a756c', @p32='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p33='{"name":"how_to_use","parameter_format":"POSITIONAL","components":[{"type":"HEADER","format":"VIDEO","example":{"header_handle":["https://scontent.whatsapp.net/v/t61.29466-34/473400026_1161660809082606_2266358353344959137_n.mp4?ccb=1-7&_nc_sid=8b1bef&_nc_ohc=Zs2VwpkfS9cQ7kNvwFjmzuO&_nc_oc=Adn_enyOP7yJQ3nqyQywzSY0jX7IlBLFQnKXoCO7OJ1xwNsRIfwFgSP_YIQpiNLSLuI&_nc_zt=28&_nc_ht=scontent.whatsapp.net&edm=AH51TzQEAAAA&_nc_gid=AmL84iWp0jXLBawVWmEDPQ&oh=01_Q5Aa2gEr04oPLm9qWgdgvybAyIJBSW1MIjHh1ybLT0LcHct-uQ&oe=690596DD"]}},{"type":"BODY","text":"Ye hai medicine use karne ke simple steps:\n\nStep 1: Take 1 scoop (5 gms) of Suwasthi Karela Jamun Powder\n\nStep 2: Mix it with 1 cup of Lukewarm Water\n\nStep 3: Consume twice a day on empty stomach to get the best results 😊\n\nClick the option below to continue 👇"},{"type":"BUTTONS","buttons":[{"type":"QUICK_REPLY","text":"Ingredients"},{"type":"QUICK_REPLY","text":"Price"},{"type":"QUICK_REPLY","text":"Buy Now"}]}],"language":"en","status":"APPROVED","category":"MARKETING","id":"1161660805749273"}' (Nullable = false), @p34='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p37='e04b0d1d-8e26-4c79-98e6-11c929e544bd', @p36='2025-10-02T07:28:30.7163841Z' (DbType = DateTime), @p39='e8792eb6-c387-42b7-b746-cd7537e43261', @p38='2025-10-02T07:28:30.7163841Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p0, "RawJson" = @p1, "UpdatedAt" = @p2
WHERE "Id" = @p3;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p4, "RawJson" = @p5, "UpdatedAt" = @p6
WHERE "Id" = @p7;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p8
WHERE "Id" = @p9;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p10
WHERE "Id" = @p11;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p12, "RawJson" = @p13, "UpdatedAt" = @p14
WHERE "Id" = @p15;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p16
WHERE "Id" = @p17;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p18, "RawJson" = @p19, "UpdatedAt" = @p20
WHERE "Id" = @p21;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p22
WHERE "Id" = @p23;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p24
WHERE "Id" = @p25;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p26, "RawJson" = @p27, "UpdatedAt" = @p28
WHERE "Id" = @p29;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p30
WHERE "Id" = @p31;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p32, "RawJson" = @p33, "UpdatedAt" = @p34
WHERE "Id" = @p35;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p36
WHERE "Id" = @p37;
UPDATE "WhatsAppTemplates" SET "LastSyncedAt" = @p38
WHERE "Id" = @p39;
2025-10-02 12:58:34.112 +05:30 [INF] TemplateSyncWorker: biz="16d308c9-adcc-4ea9-8e9a-0724d11b5d7b" added=0 updated=6 skipped=8 syncedAt="2025-10-02T07:28:30.7163841Z"
2025-10-02 12:58:34.184 +05:30 [INF] Executed DbCommand (66ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 12:58:34.248 +05:30 [INF] Executed DbCommand (61ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 12:58:34.250 +05:30 [INF] ⏭️ Skipping sync for "11f41b5f-f92c-4b6e-855b-62036779dee4"; TTL not expired.
2025-10-02 12:58:34.252 +05:30 [INF] TemplateSyncWorker: biz="11f41b5f-f92c-4b6e-855b-62036779dee4" added=0 updated=0 skipped=0 syncedAt="2025-10-02T06:47:39.2167560Z"
2025-10-02 12:58:34.254 +05:30 [INF] TemplateSyncWorker: sweep finished in 3934 ms; processed=2; next run ~"2025-10-02T13:28:30.3194183Z"
2025-10-02 12:58:43.738 +05:30 [INF] Executed DbCommand (116ms) [Parameters=[@__now_0='2025-10-02T07:28:43.6212893+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:58:53.818 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:28:53.7459728+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:01.891 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - null null
2025-10-02 12:59:01.916 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 12:59:02.086 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:02.090 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/auth/login - 204 null null 199.6308ms
2025-10-02 12:59:02.093 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/auth/login - application/json 48
2025-10-02 12:59:02.101 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:02.626 +05:30 [INF] Executing endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-10-02 12:59:02.692 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(xbytechat.api.AuthModule.DTOs.UserLoginDto) on controller xbytechat.api.AuthModule.Controllers.AuthController (xbytechat.api).
2025-10-02 12:59:02.872 +05:30 [INF] 🔑 Login attempt for email: test@gmail.com
2025-10-02 12:59:03.120 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__dto_Email_0='test@gmail.com', @__hashedPassword_1='JAvlGPq9JyTdtvBO6x2llnRI1+gxwIyPqCKAn3THIKk='], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."BusinessId", u."CreatedAt", u."DeletedAt", u."Email", u."IsDeleted", u."Name", u."PasswordHash", u."RefreshToken", u."RefreshTokenExpiry", u."RoleId", u."Status", r."Id", r."CreatedAt", r."Description", r."IsActive", r."IsSystemDefined", r."Name"
FROM "Users" AS u
LEFT JOIN "Roles" AS r ON u."RoleId" = r."Id"
WHERE u."Email" = @__dto_Email_0 AND u."PasswordHash" = @__hashedPassword_1 AND NOT (u."IsDeleted")
LIMIT 1
2025-10-02 12:59:03.356 +05:30 [INF] Executed DbCommand (118ms) [Parameters=[@__user_BusinessId_Value_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT b."Id", b."Address", b."ApprovedAt", b."ApprovedBy", b."BusinessEmail", b."BusinessName", b."CompanyName", b."CompanyPhone", b."CreatedAt", b."CreatedBy", b."CreatedByPartnerId", b."DeletedAt", b."DeletedBy", b."Industry", b."IsApproved", b."IsDeleted", b."LastLoginAt", b."LogoUrl", b."Notes", b."Phone", b."PlanId", b."RepresentativeName", b."Source", b."Status", b."Tags", b."Website", p."Id", p."Code", p."CreatedAt", p."Description", p."IsActive", p."Name"
FROM "Businesses" AS b
LEFT JOIN "Plans" AS p ON b."PlanId" = p."Id"
WHERE b."Id" = @__user_BusinessId_Value_0
LIMIT 1
2025-10-02 12:59:03.621 +05:30 [INF] Executed DbCommand (94ms) [Parameters=[@__userId_0='a5678bcc-20f4-44f0-be61-f42a264b937c'], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT t0."Code", t0."Group"
FROM "Users" AS u
INNER JOIN "Businesses" AS b ON u."BusinessId" = b."Id"
INNER JOIN (
    SELECT p."PermissionId", p."PlanId"
    FROM "PlanPermissions" AS p
    WHERE p."IsActive"
) AS t ON b."PlanId" = t."PlanId"
INNER JOIN (
    SELECT p0."Id", p0."Code", p0."Group"
    FROM "Permissions" AS p0
    WHERE p0."IsActive"
) AS t0 ON t."PermissionId" = t0."Id"
WHERE u."Id" = @__userId_0 AND EXISTS (
    SELECT 1
    FROM "RolePermissions" AS r
    WHERE r."IsActive" AND NOT (r."IsRevoked") AND r."RoleId" = u."RoleId" AND r."PermissionId" = t0."Id")
2025-10-02 12:59:03.631 +05:30 [INF] ✅ Token generated for: test@gmail.com
2025-10-02 12:59:03.869 +05:30 [INF] 🔎 JWT includes plan_id: 5f9f5de1-a0b2-48ba-b03d-77b27345613f
2025-10-02 12:59:03.871 +05:30 [INF] ✅ Login successful for test@gmail.com, Role: business, PlanId: "5f9f5de1-a0b2-48ba-b03d-77b27345613f"
2025-10-02 12:59:03.889 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 12:59:03.939 +05:30 [INF] Executed DbCommand (119ms) [Parameters=[@__now_0='2025-10-02T07:29:03.8206551+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:03.941 +05:30 [INF] Executed action xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api) in 1207.7256ms
2025-10-02 12:59:03.943 +05:30 [INF] Executed endpoint 'xbytechat.api.AuthModule.Controllers.AuthController.Login (xbytechat.api)'
2025-10-02 12:59:03.949 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/auth/login - 200 null application/json; charset=utf-8 1855.8472ms
2025-10-02 12:59:03.953 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 12:59:03.956 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:03.957 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.8897ms
2025-10-02 12:59:04.050 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 12:59:04.054 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:04.084 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.095 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 12:59:04.213 +05:30 [INF] Executed DbCommand (108ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Id", p0."Code", p0."CreatedAt", p0."Description", p0."Group", p0."IsActive", p0."Name"
FROM "PlanPermissions" AS p
INNER JOIN "Permissions" AS p0 ON p."PermissionId" = p0."Id"
WHERE p."PlanId" = @__planId_0 AND p."IsActive"
2025-10-02 12:59:04.333 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 12:59:04.337 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 12:59:04.412 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 314.5558ms
2025-10-02 12:59:04.413 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.414 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 364.3571ms
2025-10-02 12:59:04.427 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 12:59:04.430 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:04.431 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.1492ms
2025-10-02 12:59:04.437 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 12:59:04.440 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:04.446 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.447 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 12:59:04.713 +05:30 [INF] Executed DbCommand (228ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 12:59:04.716 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 12:59:04.718 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 269.1621ms
2025-10-02 12:59:04.719 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.721 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 283.3038ms
2025-10-02 12:59:04.779 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 12:59:04.782 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:04.784 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.786 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 12:59:04.867 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 12:59:04.870 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 12:59:04.872 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 84.0343ms
2025-10-02 12:59:04.873 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 12:59:04.874 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 95.1817ms
2025-10-02 12:59:10.275 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/facets - null null
2025-10-02 12:59:10.278 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:10.279 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/facets - 204 null null 4.2972ms
2025-10-02 12:59:10.292 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/report/message-logs/facets - null null
2025-10-02 12:59:10.296 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:10.298 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/report/message-logs/facets - 404 0 null 6.2155ms
2025-10-02 12:59:10.303 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/report/message-logs/facets, Response status code: 404
2025-10-02 12:59:10.502 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/search - null null
2025-10-02 12:59:10.504 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:10.505 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/search - 204 null null 3.1815ms
2025-10-02 12:59:10.508 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/report/message-logs/search - application/json 131
2025-10-02 12:59:10.510 +05:30 [INF] CORS policy execution successful.
2025-10-02 12:59:10.511 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api)'
2025-10-02 12:59:10.514 +05:30 [INF] Route matched with {action = "Search", controller = "MessageLogsReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(xbytechat.api.Features.Tracking.DTOs.MessageLogReportQueryDto, System.Threading.CancellationToken) on controller xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController (xbytechat.api).
2025-10-02 12:59:10.665 +05:30 [INF] Executed DbCommand (105ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__q_FromUtc_Value_1='2025-09-25T18:30:00.0000000Z' (DbType = DateTime), @__q_ToUtc_Value_2='2025-10-02T07:29:10.2370000Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND COALESCE(m."SentAt", m."CreatedAt") >= @__q_FromUtc_Value_1 AND COALESCE(m."SentAt", m."CreatedAt") <= @__q_ToUtc_Value_2
2025-10-02 12:59:11.140 +05:30 [INF] Executed DbCommand (459ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__q_FromUtc_Value_1='2025-09-25T18:30:00.0000000Z' (DbType = DateTime), @__q_ToUtc_Value_2='2025-10-02T07:29:10.2370000Z' (DbType = DateTime), @__p_4='25', @__p_3='0'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CampaignId", c."Name" AS "CampaignName", m."RecipientNumber", c."PhoneNumberId" AS "SenderId", CASE
    WHEN c."Id" IS NOT NULL AND c."Provider" IS NOT NULL THEN c."Provider"
    ELSE m."Provider"
END AS "SourceChannel", m."Status", NULL AS "MessageType", m."MessageContent", COALESCE(m."ProviderMessageId", m."MessageId") AS "ProviderMessageId", m."ErrorMessage", m."CreatedAt", m."SentAt", NULL AS "DeliveredAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND COALESCE(m."SentAt", m."CreatedAt") >= @__q_FromUtc_Value_1 AND COALESCE(m."SentAt", m."CreatedAt") <= @__q_ToUtc_Value_2
ORDER BY COALESCE(m."SentAt", m."CreatedAt") DESC
LIMIT @__p_4 OFFSET @__p_3
2025-10-02 12:59:11.146 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.Tracking.DTOs.MessageLogListItemDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 12:59:11.157 +05:30 [INF] Executed action xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api) in 641.5445ms
2025-10-02 12:59:11.159 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api)'
2025-10-02 12:59:11.160 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/report/message-logs/search - 200 null application/json; charset=utf-8 651.8435ms
2025-10-02 12:59:14.033 +05:30 [INF] Executed DbCommand (85ms) [Parameters=[@__now_0='2025-10-02T07:29:13.9472866+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:24.119 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:29:24.0395351+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:34.219 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__now_0='2025-10-02T07:29:34.1377043+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:44.303 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:29:44.2230584+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 12:59:54.385 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__now_0='2025-10-02T07:29:54.3117414+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:04.477 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__now_0='2025-10-02T07:30:04.4022155+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:14.742 +05:30 [INF] Executed DbCommand (260ms) [Parameters=[@__now_0='2025-10-02T07:30:14.4818815+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:24.981 +05:30 [INF] Executed DbCommand (225ms) [Parameters=[@__now_0='2025-10-02T07:30:24.7547109+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:35.091 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:30:34.9952680+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:45.180 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:30:45.1025177+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:00:55.278 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:30:55.1986563+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:05.348 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__now_0='2025-10-02T07:31:05.2748634+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:15.456 +05:30 [INF] Executed DbCommand (83ms) [Parameters=[@__now_0='2025-10-02T07:31:15.3725321+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:25.579 +05:30 [INF] Executed DbCommand (122ms) [Parameters=[@__now_0='2025-10-02T07:31:25.4566015+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:35.672 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[@__now_0='2025-10-02T07:31:35.5842603+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:45.767 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[@__now_0='2025-10-02T07:31:45.6792292+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:01:55.951 +05:30 [INF] Executed DbCommand (177ms) [Parameters=[@__now_0='2025-10-02T07:31:55.7733960+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:06.016 +05:30 [INF] Executed DbCommand (67ms) [Parameters=[@__now_0='2025-10-02T07:32:05.9488338+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:16.335 +05:30 [INF] Executed DbCommand (296ms) [Parameters=[@__now_0='2025-10-02T07:32:16.0384625+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:26.441 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:32:26.3515446+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:36.612 +05:30 [INF] Executed DbCommand (160ms) [Parameters=[@__now_0='2025-10-02T07:32:36.4521033+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:46.690 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__now_0='2025-10-02T07:32:46.6172692+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:02:56.836 +05:30 [INF] Executed DbCommand (125ms) [Parameters=[@__now_0='2025-10-02T07:32:56.7104707+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:03:07.011 +05:30 [INF] Executed DbCommand (167ms) [Parameters=[@__now_0='2025-10-02T07:33:06.8442448+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:03:17.108 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__now_0='2025-10-02T07:33:17.0224634+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:03:27.221 +05:30 [INF] Executed DbCommand (101ms) [Parameters=[@__now_0='2025-10-02T07:33:27.1197177+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:03:45.253 +05:30 [INF] Executed DbCommand (57ms) [Parameters=[@__now_0='2025-10-02T07:33:37.2199600+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:03:55.336 +05:30 [INF] Executed DbCommand (65ms) [Parameters=[@__now_0='2025-10-02T07:33:55.2713916+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:05.420 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__now_0='2025-10-02T07:34:05.3456256+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:15.518 +05:30 [INF] Executed DbCommand (85ms) [Parameters=[@__now_0='2025-10-02T07:34:15.4323604+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:25.614 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__now_0='2025-10-02T07:34:25.5236416+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:35.737 +05:30 [INF] Executed DbCommand (116ms) [Parameters=[@__now_0='2025-10-02T07:34:35.6194218+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:45.825 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:34:45.7455990+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:04:55.909 +05:30 [INF] Executed DbCommand (72ms) [Parameters=[@__now_0='2025-10-02T07:34:55.8358546+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:05.988 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__now_0='2025-10-02T07:35:05.9130491+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:16.055 +05:30 [INF] Executed DbCommand (65ms) [Parameters=[@__now_0='2025-10-02T07:35:15.9898475+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:26.166 +05:30 [INF] Executed DbCommand (80ms) [Parameters=[@__now_0='2025-10-02T07:35:26.0849343+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:36.264 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[@__now_0='2025-10-02T07:35:36.1718871+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:46.359 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:35:46.2797596+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:05:56.425 +05:30 [INF] Executed DbCommand (58ms) [Parameters=[@__now_0='2025-10-02T07:35:56.3668875+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:06.509 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__now_0='2025-10-02T07:36:06.4332808+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:16.624 +05:30 [INF] Executed DbCommand (107ms) [Parameters=[@__now_0='2025-10-02T07:36:16.5173687+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:26.711 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:36:26.6348141+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:36.836 +05:30 [INF] Executed DbCommand (97ms) [Parameters=[@__now_0='2025-10-02T07:36:36.7390305+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:46.922 +05:30 [INF] Executed DbCommand (69ms) [Parameters=[@__now_0='2025-10-02T07:36:46.8520392+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:06:57.010 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__now_0='2025-10-02T07:36:56.9253099+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:07.091 +05:30 [INF] Executed DbCommand (70ms) [Parameters=[@__now_0='2025-10-02T07:37:07.0213175+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:17.188 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:37:17.1087745+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:27.285 +05:30 [INF] Executed DbCommand (86ms) [Parameters=[@__now_0='2025-10-02T07:37:27.1992557+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:37.390 +05:30 [INF] Executed DbCommand (98ms) [Parameters=[@__now_0='2025-10-02T07:37:37.2926740+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:47.480 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:37:47.4013557+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:07:57.561 +05:30 [INF] Executed DbCommand (67ms) [Parameters=[@__now_0='2025-10-02T07:37:57.4937682+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:08:07.651 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__now_0='2025-10-02T07:38:07.5700008+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:08:17.745 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[@__now_0='2025-10-02T07:38:17.6635769+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:08:27.839 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[@__now_0='2025-10-02T07:38:27.7569980+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:08:37.912 +05:30 [INF] Executed DbCommand (69ms) [Parameters=[@__now_0='2025-10-02T07:38:37.8426358+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:08:56.938 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:38:47.9209284+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:09:07.055 +05:30 [ERR] Failed executing DbCommand (100ms) [Parameters=[@__now_0='2025-10-02T07:39:06.9538700+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:09:07.095 +05:30 [ERR] An exception occurred while iterating over the results of a query for context type 'xbytechat.api.AppDbContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host..
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](CancellationToken cancellationToken, Int32 estimatedSize)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](Memory`1 buffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host..
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](CancellationToken cancellationToken, Int32 estimatedSize)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](Memory`1 buffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-10-02 13:09:07.185 +05:30 [WRN] Send queue sweep failed
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Exception while reading from stream
 ---> System.IO.IOException: Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host..
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.ThrowException(SocketError error, CancellationToken cancellationToken)
   at System.Net.Sockets.Socket.AwaitableSocketAsyncEventArgs.System.Threading.Tasks.Sources.IValueTaskSource<System.Int32>.GetResult(Int16 token)
   at System.Net.Security.SslStream.EnsureFullTlsFrameAsync[TIOAdapter](CancellationToken cancellationToken, Int32 estimatedSize)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.Security.SslStream.ReadAsyncInternal[TIOAdapter](Memory`1 buffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at Npgsql.Internal.NpgsqlReadBuffer.<Ensure>g__EnsureLong|55_0(NpgsqlReadBuffer buffer, Int32 count, Boolean async, Boolean readingNotifications)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.Internal.NpgsqlConnector.ReadMessageLong(Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlDataReader.NextResult(Boolean async, Boolean isConsuming, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteReader(Boolean async, CommandBehavior behavior, CancellationToken cancellationToken)
   at Npgsql.NpgsqlCommand.ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at xbytechat.api.Features.CampaignModule.Services.OutboundCampaignSendWorker.ExecuteAsync(CancellationToken stoppingToken) in D:\xbytechat\xbytechat-api\xbytechat-api\Features\CampaignModule\Services\OutboundCampaignSendWorker.cs:line 46
2025-10-02 13:09:25.246 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:39:17.2130504+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:09:35.338 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:39:35.2501635+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:09:45.427 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:39:45.3387722+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:09:55.521 +05:30 [INF] Executed DbCommand (86ms) [Parameters=[@__now_0='2025-10-02T07:39:55.4343214+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:05.593 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:40:05.5210900+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:15.674 +05:30 [INF] Executed DbCommand (78ms) [Parameters=[@__now_0='2025-10-02T07:40:15.5956279+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:25.771 +05:30 [INF] Executed DbCommand (80ms) [Parameters=[@__now_0='2025-10-02T07:40:25.6916244+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:35.871 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:40:35.7816506+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:45.973 +05:30 [INF] Executed DbCommand (90ms) [Parameters=[@__now_0='2025-10-02T07:40:45.8824599+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:10:56.048 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[@__now_0='2025-10-02T07:40:55.9655179+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:06.123 +05:30 [INF] Executed DbCommand (64ms) [Parameters=[@__now_0='2025-10-02T07:41:06.0590645+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:16.221 +05:30 [INF] Executed DbCommand (90ms) [Parameters=[@__now_0='2025-10-02T07:41:16.1311357+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:26.352 +05:30 [INF] Executed DbCommand (115ms) [Parameters=[@__now_0='2025-10-02T07:41:26.2373275+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:36.452 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__now_0='2025-10-02T07:41:36.3678542+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:46.542 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[@__now_0='2025-10-02T07:41:46.4604613+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:11:56.621 +05:30 [INF] Executed DbCommand (68ms) [Parameters=[@__now_0='2025-10-02T07:41:56.5532218+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:06.690 +05:30 [INF] Executed DbCommand (64ms) [Parameters=[@__now_0='2025-10-02T07:42:06.6261022+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:16.775 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:42:16.7035344+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:26.854 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__now_0='2025-10-02T07:42:26.7804886+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:37.117 +05:30 [INF] Executed DbCommand (247ms) [Parameters=[@__now_0='2025-10-02T07:42:36.8701720+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:47.201 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__now_0='2025-10-02T07:42:47.1191966+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:12:57.282 +05:30 [INF] Executed DbCommand (78ms) [Parameters=[@__now_0='2025-10-02T07:42:57.2032333+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:07.354 +05:30 [INF] Executed DbCommand (56ms) [Parameters=[@__now_0='2025-10-02T07:43:07.2980636+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:17.425 +05:30 [INF] Executed DbCommand (70ms) [Parameters=[@__now_0='2025-10-02T07:43:17.3551071+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:27.524 +05:30 [INF] Executed DbCommand (93ms) [Parameters=[@__now_0='2025-10-02T07:43:27.4303240+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:37.635 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:43:37.5385780+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:47.734 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:43:47.6454504+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:13:57.849 +05:30 [INF] Executed DbCommand (104ms) [Parameters=[@__now_0='2025-10-02T07:43:57.7446709+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:14:08.079 +05:30 [INF] Executed DbCommand (213ms) [Parameters=[@__now_0='2025-10-02T07:44:07.8664977+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:14:18.196 +05:30 [INF] Executed DbCommand (102ms) [Parameters=[@__now_0='2025-10-02T07:44:18.0936243+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:14:36.260 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[@__now_0='2025-10-02T07:44:28.2118398+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:14:46.356 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:44:46.2769939+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:14:56.473 +05:30 [INF] Executed DbCommand (105ms) [Parameters=[@__now_0='2025-10-02T07:44:56.3682708+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:06.570 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:45:06.4819494+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:16.649 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:45:16.5783807+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:26.729 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:45:26.6521237+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:36.855 +05:30 [INF] Executed DbCommand (110ms) [Parameters=[@__now_0='2025-10-02T07:45:36.7446686+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:46.930 +05:30 [INF] Executed DbCommand (65ms) [Parameters=[@__now_0='2025-10-02T07:45:46.8651809+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:15:57.003 +05:30 [INF] Executed DbCommand (63ms) [Parameters=[@__now_0='2025-10-02T07:45:56.9397911+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:07.270 +05:30 [INF] Executed DbCommand (254ms) [Parameters=[@__now_0='2025-10-02T07:46:07.0158853+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:17.371 +05:30 [INF] Executed DbCommand (95ms) [Parameters=[@__now_0='2025-10-02T07:46:17.2762186+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:27.471 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[@__now_0='2025-10-02T07:46:27.3784556+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:37.566 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:46:37.4767263+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:47.667 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:46:47.5707470+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:16:57.770 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:46:57.6740961+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:07.853 +05:30 [INF] Executed DbCommand (80ms) [Parameters=[@__now_0='2025-10-02T07:47:07.7725910+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:17.973 +05:30 [INF] Executed DbCommand (112ms) [Parameters=[@__now_0='2025-10-02T07:47:17.8606203+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:28.063 +05:30 [INF] Executed DbCommand (86ms) [Parameters=[@__now_0='2025-10-02T07:47:27.9772109+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:38.211 +05:30 [INF] Executed DbCommand (132ms) [Parameters=[@__now_0='2025-10-02T07:47:38.0790931+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:48.398 +05:30 [INF] Executed DbCommand (178ms) [Parameters=[@__now_0='2025-10-02T07:47:48.2198333+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:17:58.507 +05:30 [INF] Executed DbCommand (94ms) [Parameters=[@__now_0='2025-10-02T07:47:58.4133446+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:08.679 +05:30 [INF] Executed DbCommand (159ms) [Parameters=[@__now_0='2025-10-02T07:48:08.5193671+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:19.132 +05:30 [INF] Executed DbCommand (435ms) [Parameters=[@__now_0='2025-10-02T07:48:18.6969928+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:29.213 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__now_0='2025-10-02T07:48:29.1382734+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:39.428 +05:30 [INF] Executed DbCommand (197ms) [Parameters=[@__now_0='2025-10-02T07:48:39.2310131+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:49.534 +05:30 [INF] Executed DbCommand (93ms) [Parameters=[@__now_0='2025-10-02T07:48:49.4408924+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:18:59.616 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:48:59.5445454+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:19:09.721 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:49:09.6324515+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:19:19.815 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:49:19.7384235+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:19:29.921 +05:30 [INF] Executed DbCommand (101ms) [Parameters=[@__now_0='2025-10-02T07:49:29.8199265+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:19:47.980 +05:30 [INF] Executed DbCommand (72ms) [Parameters=[@__now_0='2025-10-02T07:49:39.9296584+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:19:58.085 +05:30 [INF] Executed DbCommand (97ms) [Parameters=[@__now_0='2025-10-02T07:49:57.9882592+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:08.175 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__now_0='2025-10-02T07:50:08.0938114+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:18.258 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:50:18.1790647+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:28.336 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:50:28.2579124+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:38.435 +05:30 [INF] Executed DbCommand (83ms) [Parameters=[@__now_0='2025-10-02T07:50:38.3513249+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:48.557 +05:30 [INF] Executed DbCommand (113ms) [Parameters=[@__now_0='2025-10-02T07:50:48.4444307+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:20:59.070 +05:30 [INF] Executed DbCommand (500ms) [Parameters=[@__now_0='2025-10-02T07:50:58.5702542+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:09.215 +05:30 [INF] Executed DbCommand (136ms) [Parameters=[@__now_0='2025-10-02T07:51:09.0788223+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:19.309 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:51:19.2215467+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:29.440 +05:30 [INF] Executed DbCommand (115ms) [Parameters=[@__now_0='2025-10-02T07:51:29.3240427+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:39.531 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__now_0='2025-10-02T07:51:39.4534808+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:49.666 +05:30 [INF] Executed DbCommand (122ms) [Parameters=[@__now_0='2025-10-02T07:51:49.5437425+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:21:59.821 +05:30 [INF] Executed DbCommand (137ms) [Parameters=[@__now_0='2025-10-02T07:51:59.6841320+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:22:09.917 +05:30 [INF] Executed DbCommand (90ms) [Parameters=[@__now_0='2025-10-02T07:52:09.8272516+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:22:19.992 +05:30 [INF] Executed DbCommand (71ms) [Parameters=[@__now_0='2025-10-02T07:52:19.9206413+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:22:30.156 +05:30 [INF] Executed DbCommand (161ms) [Parameters=[@__now_0='2025-10-02T07:52:29.9954033+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:22:40.253 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[@__now_0='2025-10-02T07:52:40.1602100+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:22:50.383 +05:30 [INF] Executed DbCommand (119ms) [Parameters=[@__now_0='2025-10-02T07:52:50.2630017+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:00.500 +05:30 [INF] Executed DbCommand (100ms) [Parameters=[@__now_0='2025-10-02T07:53:00.4004940+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:10.626 +05:30 [INF] Executed DbCommand (109ms) [Parameters=[@__now_0='2025-10-02T07:53:10.5166842+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:20.724 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:53:20.6354885+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:30.854 +05:30 [INF] Executed DbCommand (112ms) [Parameters=[@__now_0='2025-10-02T07:53:30.7416478+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:40.951 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[@__now_0='2025-10-02T07:53:40.8688207+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:23:51.179 +05:30 [INF] Executed DbCommand (214ms) [Parameters=[@__now_0='2025-10-02T07:53:50.9641554+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:24:01.308 +05:30 [INF] Executed DbCommand (119ms) [Parameters=[@__now_0='2025-10-02T07:54:01.1891387+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:24:11.412 +05:30 [INF] Executed DbCommand (99ms) [Parameters=[@__now_0='2025-10-02T07:54:11.3131420+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:24:21.526 +05:30 [INF] Executed DbCommand (103ms) [Parameters=[@__now_0='2025-10-02T07:54:21.4230568+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:24:31.628 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:54:31.5490444+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:24:42.125 +05:30 [INF] Executed DbCommand (494ms) [Parameters=[@__now_0='2025-10-02T07:54:41.6309434+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:00.380 +05:30 [INF] Executed DbCommand (108ms) [Parameters=[@__now_0='2025-10-02T07:54:52.1289030+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:10.468 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__now_0='2025-10-02T07:55:10.3838865+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:20.542 +05:30 [INF] Executed DbCommand (67ms) [Parameters=[@__now_0='2025-10-02T07:55:20.4753164+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:30.631 +05:30 [INF] Executed DbCommand (78ms) [Parameters=[@__now_0='2025-10-02T07:55:30.5516666+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:40.740 +05:30 [INF] Executed DbCommand (102ms) [Parameters=[@__now_0='2025-10-02T07:55:40.6375209+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:25:50.832 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T07:55:50.7523608+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:00.937 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[@__now_0='2025-10-02T07:56:00.8495097+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:11.035 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__now_0='2025-10-02T07:56:10.9442011+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:21.135 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T07:56:21.0380419+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:31.275 +05:30 [INF] Executed DbCommand (122ms) [Parameters=[@__now_0='2025-10-02T07:56:31.1528377+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:41.376 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__now_0='2025-10-02T07:56:41.2859455+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:26:51.457 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__now_0='2025-10-02T07:56:51.3819815+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:01.551 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:57:01.4627791+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:11.638 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T07:57:11.5503572+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:21.757 +05:30 [INF] Executed DbCommand (103ms) [Parameters=[@__now_0='2025-10-02T07:57:21.6539616+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:31.872 +05:30 [INF] Executed DbCommand (115ms) [Parameters=[@__now_0='2025-10-02T07:57:31.7566420+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:41.999 +05:30 [INF] Executed DbCommand (118ms) [Parameters=[@__now_0='2025-10-02T07:57:41.8810817+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:27:52.118 +05:30 [INF] Executed DbCommand (112ms) [Parameters=[@__now_0='2025-10-02T07:57:52.0067543+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:28:02.272 +05:30 [INF] Executed DbCommand (143ms) [Parameters=[@__now_0='2025-10-02T07:58:02.1281071+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:28:12.364 +05:30 [INF] Executed DbCommand (81ms) [Parameters=[@__now_0='2025-10-02T07:58:12.2828406+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:28:29.338 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 13:28:29.372 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 13:28:29.385 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 13:28:30.146 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 13:28:30.642 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 13:28:30.658 +05:30 [INF] ClickLogWorker started
2025-10-02 13:28:30.843 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 13:28:30.844 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 13:28:30.845 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 13:28:30.846 +05:30 [INF] Hosting environment: Development
2025-10-02 13:28:30.847 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 13:28:31.691 +05:30 [INF] ClickLogWorker stopped
2025-10-02 13:28:32.878 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 13:28:33.029 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 158.6081ms
2025-10-02 13:28:33.056 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 13:28:33.063 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 7.2017ms
2025-10-02 13:28:33.116 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 13:28:33.148 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.3386ms
2025-10-02 13:28:33.296 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 13:28:33.498 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 201.7372ms
2025-10-02 13:28:39.021 +05:30 [INF] Executed DbCommand (99ms) [Parameters=[@__cutoff_0='2025-09-25T07:58:29.4717144Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 13:28:39.021 +05:30 [INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 13:28:40.774 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 13:28:40.914 +05:30 [INF] Executed DbCommand (106ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:28:41.002 +05:30 [INF] Executed DbCommand (68ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 13:28:41.006 +05:30 [INF] ⏭️ Skipping sync for "16d308c9-adcc-4ea9-8e9a-0724d11b5d7b"; TTL not expired.
2025-10-02 13:28:41.008 +05:30 [INF] TemplateSyncWorker: biz="16d308c9-adcc-4ea9-8e9a-0724d11b5d7b" added=0 updated=0 skipped=0 syncedAt="2025-10-02T07:28:30.7163840Z"
2025-10-02 13:28:41.099 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:28:41.188 +05:30 [INF] Executed DbCommand (85ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 13:28:41.190 +05:30 [INF] ⏭️ Skipping sync for "11f41b5f-f92c-4b6e-855b-62036779dee4"; TTL not expired.
2025-10-02 13:28:41.191 +05:30 [INF] TemplateSyncWorker: biz="11f41b5f-f92c-4b6e-855b-62036779dee4" added=0 updated=0 skipped=0 syncedAt="2025-10-02T06:47:39.2167560Z"
2025-10-02 13:28:41.193 +05:30 [INF] TemplateSyncWorker: sweep finished in 524 ms; processed=2; next run ~"2025-10-02T13:58:40.6695519Z"
2025-10-02 13:28:43.873 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__now_0='2025-10-02T07:58:35.6781317+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:28:53.974 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__now_0='2025-10-02T07:58:53.8832872+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:04.152 +05:30 [INF] Executed DbCommand (175ms) [Parameters=[@__now_0='2025-10-02T07:59:03.9762221+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:14.248 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[@__now_0='2025-10-02T07:59:14.1551218+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:24.334 +05:30 [INF] Executed DbCommand (66ms) [Parameters=[@__now_0='2025-10-02T07:59:24.2665409+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:34.433 +05:30 [INF] Executed DbCommand (80ms) [Parameters=[@__now_0='2025-10-02T07:59:34.3519208+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:44.534 +05:30 [INF] Executed DbCommand (85ms) [Parameters=[@__now_0='2025-10-02T07:59:44.4484630+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:29:54.733 +05:30 [INF] Executed DbCommand (192ms) [Parameters=[@__now_0='2025-10-02T07:59:54.5411976+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:04.899 +05:30 [INF] Executed DbCommand (164ms) [Parameters=[@__now_0='2025-10-02T08:00:04.7341859+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:15.000 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[@__now_0='2025-10-02T08:00:14.9063573+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:25.115 +05:30 [INF] Executed DbCommand (100ms) [Parameters=[@__now_0='2025-10-02T08:00:25.0145760+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:35.294 +05:30 [INF] Executed DbCommand (175ms) [Parameters=[@__now_0='2025-10-02T08:00:35.1177819+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:45.376 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__now_0='2025-10-02T08:00:45.3020597+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:30:55.518 +05:30 [INF] Executed DbCommand (128ms) [Parameters=[@__now_0='2025-10-02T08:00:55.3899747+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:05.694 +05:30 [INF] Executed DbCommand (167ms) [Parameters=[@__now_0='2025-10-02T08:01:05.5260702+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:15.954 +05:30 [INF] Executed DbCommand (243ms) [Parameters=[@__now_0='2025-10-02T08:01:15.7102285+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:26.059 +05:30 [INF] Executed DbCommand (88ms) [Parameters=[@__now_0='2025-10-02T08:01:25.9697817+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:28.361 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:31:28.364 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 13:31:28.401 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:28.404 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - 204 null null 43.2725ms
2025-10-02 13:31:28.410 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:31:28.418 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:28.503 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:31:28.514 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:31:28.680 +05:30 [INF] Executed DbCommand (86ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-10-02 13:31:28.691 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:31:28.710 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 191.3597ms
2025-10-02 13:31:28.711 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:31:28.715 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 305.2852ms
2025-10-02 13:31:30.029 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null null
2025-10-02 13:31:30.033 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:30.034 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 204 null null 5.2292ms
2025-10-02 13:31:30.038 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null 0
2025-10-02 13:31:30.041 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:30.043 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:30.047 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:31:30.207 +05:30 [INF] Executed DbCommand (94ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AudienceId", c."BusinessId", c."CTAFlowConfigId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."DocumentUrl", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."PhoneNumberId", c."Provider", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."TemplateSchemaSnapshot", c."UpdatedAt", c."VideoUrl"
FROM "Campaigns" AS c
WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
ORDER BY c."Id"
LIMIT 1
2025-10-02 13:31:30.395 +05:30 [INF] Executed DbCommand (163ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."AudienceMemberId", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IdempotencyKey", t0."IsAutoTagged", t0."MaterializedAt", t0."MessagePreview", t0."ProductBrowsed", t0."ResolvedButtonUrlsJson", t0."ResolvedParametersJson", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."ProfileName", t0."ProfileNameUpdatedAt", t0."Tags", t0."Id1", t0."AttributesJson", t0."AudienceId", t0."BusinessId1", t0."ContactId0", t0."CreatedAt0", t0."CreatedByUserId", t0."Email0", t0."IsDeleted", t0."IsTransientContact", t0."Name0", t0."PhoneE164", t0."PhoneRaw", t0."PromotedAt", t0."UpdatedAt0", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN (
    SELECT c0."Id", c0."AudienceMemberId", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IdempotencyKey", c0."IsAutoTagged", c0."MaterializedAt", c0."MessagePreview", c0."ProductBrowsed", c0."ResolvedButtonUrlsJson", c0."ResolvedParametersJson", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."ProfileName", c1."ProfileNameUpdatedAt", c1."Tags", a."Id" AS "Id1", a."AttributesJson", a."AudienceId", a."BusinessId" AS "BusinessId1", a."ContactId" AS "ContactId0", a."CreatedAt" AS "CreatedAt0", a."CreatedByUserId", a."Email" AS "Email0", a."IsDeleted", a."IsTransientContact", a."Name" AS "Name0", a."PhoneE164", a."PhoneRaw", a."PromotedAt", a."UpdatedAt" AS "UpdatedAt0"
    FROM "CampaignRecipients" AS c0
    LEFT JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
    LEFT JOIN "AudienceMembers" AS a ON c0."AudienceMemberId" = a."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:30.501 +05:30 [INF] Executed DbCommand (98ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."CampaignId", c0."IsFromTemplate", c0."Position", c0."Title", c0."Type", c0."Value", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN "CampaignButtons" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:30.527 +05:30 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-02 13:31:30.640 +05:30 [INF] Executed DbCommand (109ms) [Parameters=[@__flowId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", t0."Id", t0."CTAFlowConfigId", t0."PositionX", t0."PositionY", t0."ProfileNameSlot", t0."RequiredSource", t0."RequiredTag", t0."StepOrder", t0."TemplateToSend", t0."TemplateType", t0."TriggerButtonText", t0."TriggerButtonType", t0."UseProfileName", t0."Id0", t0."ButtonIndex", t0."ButtonSubType", t0."ButtonText", t0."ButtonType", t0."ButtonValue", t0."CTAFlowStepId", t0."NextStepId"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."Id" = @__flowId_Value_0 AND c."BusinessId" = @__businessId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."CTAFlowConfigId", c0."PositionX", c0."PositionY", c0."ProfileNameSlot", c0."RequiredSource", c0."RequiredTag", c0."StepOrder", c0."TemplateToSend", c0."TemplateType", c0."TriggerButtonText", c0."TriggerButtonType", c0."UseProfileName", f."Id" AS "Id0", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
    FROM "CTAFlowSteps" AS c0
    LEFT JOIN "FlowButtonLinks" AS f ON c0."Id" = f."CTAFlowStepId"
) AS t0 ON t."Id" = t0."CTAFlowConfigId"
ORDER BY t."Id", t0."Id"
2025-10-02 13:31:30.840 +05:30 [INF] Executed DbCommand (98ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 13:31:30.868 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:30.871 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:31.683 +05:30 [INF] Received HTTP response headers after 809.1009ms - 401
2025-10-02 13:31:31.684 +05:30 [INF] End processing HTTP request after 817.3285ms - 401
2025-10-02 13:31:31.687 +05:30 [ERR] ❌ Failed to fetch templates (provider=meta_cloud) for BusinessId "11f41b5f-f92c-4b6e-855b-62036779dee4": HTTP 401 Body: {"error":{"message":"Error validating access token: Session has expired on Thursday, 02-Oct-25 01:00:00 PDT. The current time is Thursday, 02-Oct-25 01:01:33 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"ADDbATXNO1lLUJKmj5zH9Zr"}}
2025-10-02 13:31:31.690 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 13:31:31.697 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 1648.0478ms
2025-10-02 13:31:31.698 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:31.699 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 400 null application/json; charset=utf-8 1660.5981ms
2025-10-02 13:31:36.227 +05:30 [INF] Executed DbCommand (165ms) [Parameters=[@__now_0='2025-10-02T08:01:36.0614093+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:46.354 +05:30 [INF] Executed DbCommand (118ms) [Parameters=[@__now_0='2025-10-02T08:01:46.2358937+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:47.316 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null null
2025-10-02 13:31:47.319 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:47.320 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 204 null null 3.7466ms
2025-10-02 13:31:47.323 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null 0
2025-10-02 13:31:47.325 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:47.327 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:47.328 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:31:47.495 +05:30 [INF] Executed DbCommand (159ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AudienceId", c."BusinessId", c."CTAFlowConfigId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."DocumentUrl", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."PhoneNumberId", c."Provider", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."TemplateSchemaSnapshot", c."UpdatedAt", c."VideoUrl"
FROM "Campaigns" AS c
WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
ORDER BY c."Id"
LIMIT 1
2025-10-02 13:31:47.625 +05:30 [INF] Executed DbCommand (127ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."AudienceMemberId", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IdempotencyKey", t0."IsAutoTagged", t0."MaterializedAt", t0."MessagePreview", t0."ProductBrowsed", t0."ResolvedButtonUrlsJson", t0."ResolvedParametersJson", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."ProfileName", t0."ProfileNameUpdatedAt", t0."Tags", t0."Id1", t0."AttributesJson", t0."AudienceId", t0."BusinessId1", t0."ContactId0", t0."CreatedAt0", t0."CreatedByUserId", t0."Email0", t0."IsDeleted", t0."IsTransientContact", t0."Name0", t0."PhoneE164", t0."PhoneRaw", t0."PromotedAt", t0."UpdatedAt0", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN (
    SELECT c0."Id", c0."AudienceMemberId", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IdempotencyKey", c0."IsAutoTagged", c0."MaterializedAt", c0."MessagePreview", c0."ProductBrowsed", c0."ResolvedButtonUrlsJson", c0."ResolvedParametersJson", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."ProfileName", c1."ProfileNameUpdatedAt", c1."Tags", a."Id" AS "Id1", a."AttributesJson", a."AudienceId", a."BusinessId" AS "BusinessId1", a."ContactId" AS "ContactId0", a."CreatedAt" AS "CreatedAt0", a."CreatedByUserId", a."Email" AS "Email0", a."IsDeleted", a."IsTransientContact", a."Name" AS "Name0", a."PhoneE164", a."PhoneRaw", a."PromotedAt", a."UpdatedAt" AS "UpdatedAt0"
    FROM "CampaignRecipients" AS c0
    LEFT JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
    LEFT JOIN "AudienceMembers" AS a ON c0."AudienceMemberId" = a."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:47.874 +05:30 [INF] Executed DbCommand (246ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."CampaignId", c0."IsFromTemplate", c0."Position", c0."Title", c0."Type", c0."Value", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN "CampaignButtons" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:47.983 +05:30 [INF] Executed DbCommand (106ms) [Parameters=[@__flowId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", t0."Id", t0."CTAFlowConfigId", t0."PositionX", t0."PositionY", t0."ProfileNameSlot", t0."RequiredSource", t0."RequiredTag", t0."StepOrder", t0."TemplateToSend", t0."TemplateType", t0."TriggerButtonText", t0."TriggerButtonType", t0."UseProfileName", t0."Id0", t0."ButtonIndex", t0."ButtonSubType", t0."ButtonText", t0."ButtonType", t0."ButtonValue", t0."CTAFlowStepId", t0."NextStepId"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."Id" = @__flowId_Value_0 AND c."BusinessId" = @__businessId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."CTAFlowConfigId", c0."PositionX", c0."PositionY", c0."ProfileNameSlot", c0."RequiredSource", c0."RequiredTag", c0."StepOrder", c0."TemplateToSend", c0."TemplateType", c0."TriggerButtonText", c0."TriggerButtonType", c0."UseProfileName", f."Id" AS "Id0", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
    FROM "CTAFlowSteps" AS c0
    LEFT JOIN "FlowButtonLinks" AS f ON c0."Id" = f."CTAFlowStepId"
) AS t0 ON t."Id" = t0."CTAFlowConfigId"
ORDER BY t."Id", t0."Id"
2025-10-02 13:31:48.056 +05:30 [INF] Executed DbCommand (70ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 13:31:48.059 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:48.060 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:48.407 +05:30 [INF] Received HTTP response headers after 345.7379ms - 401
2025-10-02 13:31:48.408 +05:30 [INF] End processing HTTP request after 348.9336ms - 401
2025-10-02 13:31:48.409 +05:30 [ERR] ❌ Failed to fetch templates (provider=meta_cloud) for BusinessId "11f41b5f-f92c-4b6e-855b-62036779dee4": HTTP 401 Body: {"error":{"message":"Error validating access token: Session has expired on Thursday, 02-Oct-25 01:00:00 PDT. The current time is Thursday, 02-Oct-25 01:01:50 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AVYlGixlnKVRRWyledTZtoA"}}
2025-10-02 13:31:48.411 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 13:31:48.413 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 1083.5437ms
2025-10-02 13:31:48.414 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:48.415 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 400 null application/json; charset=utf-8 1092.0644ms
2025-10-02 13:31:51.663 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 13:31:51.666 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:51.667 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 4.6892ms
2025-10-02 13:31:51.671 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 13:31:51.675 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:51.682 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:51.686 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 13:31:51.787 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p0."Id", p0."Code", p0."CreatedAt", p0."Description", p0."Group", p0."IsActive", p0."Name"
FROM "PlanPermissions" AS p
INNER JOIN "Permissions" AS p0 ON p."PermissionId" = p0."Id"
WHERE p."PlanId" = @__planId_0 AND p."IsActive"
2025-10-02 13:31:51.895 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 13:31:51.898 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:31:51.904 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 216.1283ms
2025-10-02 13:31:51.905 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:51.906 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 234.9897ms
2025-10-02 13:31:51.911 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 13:31:51.913 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:51.914 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/plan/me/permissions - 204 null null 2.7293ms
2025-10-02 13:31:51.916 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 13:31:51.918 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:51.920 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:51.921 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 13:31:52.056 +05:30 [INF] Executed DbCommand (132ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 13:31:52.058 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:31:52.059 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 136.6586ms
2025-10-02 13:31:52.060 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:52.061 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 144.7394ms
2025-10-02 13:31:52.102 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - null null
2025-10-02 13:31:52.102 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:31:52.105 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:52.107 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:52.108 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - 204 null null 6.2082ms
2025-10-02 13:31:52.109 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:52.113 +05:30 [INF] Route matched with {action = "GetMyPlanPermissions", controller = "Plan"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMyPlanPermissions(System.Threading.CancellationToken) on controller xbytechat.api.Features.AccessControl.Controllers.PlanController (xbytechat.api).
2025-10-02 13:31:52.115 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:31:52.118 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:52.122 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:31:52.123 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:31:52.195 +05:30 [INF] Executed DbCommand (78ms) [Parameters=[@__planId_0='5f9f5de1-a0b2-48ba-b03d-77b27345613f'], CommandType='"Text"', CommandTimeout='30']
SELECT p."Id", p."Code", p."Name", p."Description", p."IsActive"
FROM "Plans" AS p
WHERE p."Id" = @__planId_0
LIMIT 1
2025-10-02 13:31:52.198 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType58`3[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[xbytechat.api.Features.AccessControl.DTOs.PlanDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Collections.Generic.List`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:31:52.199 +05:30 [INF] Executed DbCommand (73ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-10-02 13:31:52.200 +05:30 [INF] Executed action xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api) in 84.8146ms
2025-10-02 13:31:52.202 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:31:52.203 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.AccessControl.Controllers.PlanController.GetMyPlanPermissions (xbytechat.api)'
2025-10-02 13:31:52.204 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 79.3245ms
2025-10-02 13:31:52.205 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/plan/me/permissions - 200 null application/json; charset=utf-8 102.4961ms
2025-10-02 13:31:52.206 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:31:52.210 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 95.1546ms
2025-10-02 13:31:53.634 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null null
2025-10-02 13:31:53.636 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:53.637 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 204 null null 3.086ms
2025-10-02 13:31:53.642 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null 0
2025-10-02 13:31:53.644 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:53.646 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:53.647 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:31:53.740 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AudienceId", c."BusinessId", c."CTAFlowConfigId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."DocumentUrl", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."PhoneNumberId", c."Provider", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."TemplateSchemaSnapshot", c."UpdatedAt", c."VideoUrl"
FROM "Campaigns" AS c
WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
ORDER BY c."Id"
LIMIT 1
2025-10-02 13:31:53.955 +05:30 [INF] Executed DbCommand (212ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."AudienceMemberId", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IdempotencyKey", t0."IsAutoTagged", t0."MaterializedAt", t0."MessagePreview", t0."ProductBrowsed", t0."ResolvedButtonUrlsJson", t0."ResolvedParametersJson", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."ProfileName", t0."ProfileNameUpdatedAt", t0."Tags", t0."Id1", t0."AttributesJson", t0."AudienceId", t0."BusinessId1", t0."ContactId0", t0."CreatedAt0", t0."CreatedByUserId", t0."Email0", t0."IsDeleted", t0."IsTransientContact", t0."Name0", t0."PhoneE164", t0."PhoneRaw", t0."PromotedAt", t0."UpdatedAt0", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN (
    SELECT c0."Id", c0."AudienceMemberId", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IdempotencyKey", c0."IsAutoTagged", c0."MaterializedAt", c0."MessagePreview", c0."ProductBrowsed", c0."ResolvedButtonUrlsJson", c0."ResolvedParametersJson", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."ProfileName", c1."ProfileNameUpdatedAt", c1."Tags", a."Id" AS "Id1", a."AttributesJson", a."AudienceId", a."BusinessId" AS "BusinessId1", a."ContactId" AS "ContactId0", a."CreatedAt" AS "CreatedAt0", a."CreatedByUserId", a."Email" AS "Email0", a."IsDeleted", a."IsTransientContact", a."Name" AS "Name0", a."PhoneE164", a."PhoneRaw", a."PromotedAt", a."UpdatedAt" AS "UpdatedAt0"
    FROM "CampaignRecipients" AS c0
    LEFT JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
    LEFT JOIN "AudienceMembers" AS a ON c0."AudienceMemberId" = a."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:54.089 +05:30 [INF] Executed DbCommand (132ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."CampaignId", c0."IsFromTemplate", c0."Position", c0."Title", c0."Type", c0."Value", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN "CampaignButtons" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:31:54.218 +05:30 [INF] Executed DbCommand (126ms) [Parameters=[@__flowId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", t0."Id", t0."CTAFlowConfigId", t0."PositionX", t0."PositionY", t0."ProfileNameSlot", t0."RequiredSource", t0."RequiredTag", t0."StepOrder", t0."TemplateToSend", t0."TemplateType", t0."TriggerButtonText", t0."TriggerButtonType", t0."UseProfileName", t0."Id0", t0."ButtonIndex", t0."ButtonSubType", t0."ButtonText", t0."ButtonType", t0."ButtonValue", t0."CTAFlowStepId", t0."NextStepId"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."Id" = @__flowId_Value_0 AND c."BusinessId" = @__businessId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."CTAFlowConfigId", c0."PositionX", c0."PositionY", c0."ProfileNameSlot", c0."RequiredSource", c0."RequiredTag", c0."StepOrder", c0."TemplateToSend", c0."TemplateType", c0."TriggerButtonText", c0."TriggerButtonType", c0."UseProfileName", f."Id" AS "Id0", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
    FROM "CTAFlowSteps" AS c0
    LEFT JOIN "FlowButtonLinks" AS f ON c0."Id" = f."CTAFlowStepId"
) AS t0 ON t."Id" = t0."CTAFlowConfigId"
ORDER BY t."Id", t0."Id"
2025-10-02 13:31:54.334 +05:30 [INF] Executed DbCommand (114ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 13:31:54.337 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:54.338 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:31:54.715 +05:30 [INF] Received HTTP response headers after 376.0065ms - 401
2025-10-02 13:31:54.717 +05:30 [INF] End processing HTTP request after 379.853ms - 401
2025-10-02 13:31:54.718 +05:30 [ERR] ❌ Failed to fetch templates (provider=meta_cloud) for BusinessId "11f41b5f-f92c-4b6e-855b-62036779dee4": HTTP 401 Body: {"error":{"message":"Error validating access token: Session has expired on Thursday, 02-Oct-25 01:00:00 PDT. The current time is Thursday, 02-Oct-25 01:01:57 PDT.","type":"OAuthException","code":190,"error_subcode":463,"fbtrace_id":"AfzeMICJIUna9mnAX42RLBe"}}
2025-10-02 13:31:54.719 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 13:31:54.721 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 1072.9049ms
2025-10-02 13:31:54.722 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:31:54.723 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 400 null application/json; charset=utf-8 1080.3516ms
2025-10-02 13:31:56.441 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__now_0='2025-10-02T08:01:56.3613740+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:31:59.422 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - null null
2025-10-02 13:31:59.425 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.429 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/me - 204 null null 6.5933ms
2025-10-02 13:31:59.436 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - null null
2025-10-02 13:31:59.438 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - null null
2025-10-02 13:31:59.440 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.441 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.442 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - 204 null null 5.8044ms
2025-10-02 13:31:59.443 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-10-02 13:31:59.445 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - null null
2025-10-02 13:31:59.448 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.448 +05:30 [INF] Route matched with {action = "GetMySettings", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMySettings() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 13:31:59.449 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.453 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 13:31:59.655 +05:30 [INF] Executed DbCommand (199ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:31:59.655 +05:30 [INF] Executed DbCommand (185ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='PINNACLE'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 13:31:59.657 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat_api.WhatsAppSettings.Models.WhatsAppSettingEntity'.
2025-10-02 13:31:59.659 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:31:59.661 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 206.6701ms
2025-10-02 13:31:59.662 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.663 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/PINNACLE/numbers - 200 null application/json; charset=utf-8 218.3377ms
2025-10-02 13:31:59.663 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api) in 214.0167ms
2025-10-02 13:31:59.666 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.GetMySettings (xbytechat.api)'
2025-10-02 13:31:59.667 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/me - 200 null application/json; charset=utf-8 229.4676ms
2025-10-02 13:31:59.669 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 13:31:59.671 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.672 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 204 null null 2.3932ms
2025-10-02 13:31:59.674 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 13:31:59.676 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.677 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.678 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 13:31:59.755 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 13:31:59.758 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:31:59.761 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 81.7677ms
2025-10-02 13:31:59.762 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - null null
2025-10-02 13:31:59.762 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.764 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:31:59.765 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 200 null application/json; charset=utf-8 91.0774ms
2025-10-02 13:31:59.766 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.768 +05:30 [INF] Route matched with {action = "List", controller = "WhatsAppNumbers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] List(System.String) on controller xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController (xbytechat.api).
2025-10-02 13:31:59.860 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."BusinessId", w."CreatedAt", w."IsActive", w."IsDefault", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WhatsAppBusinessNumber"
FROM "WhatsAppPhoneNumbers" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1
ORDER BY w."IsDefault" DESC, w."WhatsAppBusinessNumber"
2025-10-02 13:31:59.863 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.WhatsAppSettings.Models.WhatsAppPhoneNumber, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:31:59.864 +05:30 [INF] Executed action xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api) in 94.1087ms
2025-10-02 13:31:59.865 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.WhatsAppSettings.Controllers.WhatsAppNumbersController.List (xbytechat.api)'
2025-10-02 13:31:59.866 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/whatsappsettings/META_CLOUD/numbers - 200 null application/json; charset=utf-8 104.4029ms
2025-10-02 13:32:01.648 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - null null
2025-10-02 13:32:01.651 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:01.651 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - 204 null null 3.3273ms
2025-10-02 13:32:01.654 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - application/json 2
2025-10-02 13:32:01.657 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:01.658 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 13:32:01.661 +05:30 [INF] Route matched with {action = "TestConnectionCurrent", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] TestConnectionCurrent() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 13:32:01.773 +05:30 [INF] Executed DbCommand (108ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:32:01.779 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 13:32:01.780 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 13:32:02.317 +05:30 [INF] Received HTTP response headers after 535.5796ms - 401
2025-10-02 13:32:02.318 +05:30 [INF] End processing HTTP request after 539.0687ms - 401
2025-10-02 13:32:02.341 +05:30 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:32:02.344 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api) in 681.8066ms
2025-10-02 13:32:02.345 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 13:32:02.346 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - 400 null application/json; charset=utf-8 691.7369ms
2025-10-02 13:32:06.875 +05:30 [INF] Executed DbCommand (423ms) [Parameters=[@__now_0='2025-10-02T08:02:06.4523643+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:32:17.514 +05:30 [INF] Executed DbCommand (627ms) [Parameters=[@__now_0='2025-10-02T08:02:16.8869993+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:32:27.633 +05:30 [INF] Executed DbCommand (109ms) [Parameters=[@__now_0='2025-10-02T08:02:27.5228186+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:32:30.651 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - null null
2025-10-02 13:32:30.664 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:30.665 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/update - 204 null null 13.7774ms
2025-10-02 13:32:30.667 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - application/json 559
2025-10-02 13:32:30.669 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:30.670 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-10-02 13:32:30.673 +05:30 [INF] Route matched with {action = "UpdateSetting", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateSetting(xbytechat_api.WhatsAppSettings.DTOs.SaveWhatsAppSettingDto) on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 13:32:30.819 +05:30 [INF] Executed DbCommand (130ms) [Parameters=[@__dto_BusinessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__dto_Provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__dto_BusinessId_0 AND w."Provider" = @__dto_Provider_1
LIMIT 1
2025-10-02 13:32:30.960 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@p2='78b43af4-6f87-440d-96a9-681a92e17974', @p0='EAAUbmP4285YBPpN7AjGXOY5978V9mmizVtyLrrqg3E7KWi2nM1y9kc757bZAOusBKpH6rqQ3U73L2qanP349OaKWZC41tZAXhITcKeEJIgQPb6TVBFdgXbZAOnxLjIKMh0Iaw6PpCXY67hkbNmz8ZCs98D5NDjZCbpdnhgocjPqTxOVZCujkUoVTGpzDCJc5KxaW6fqdipquIZAtqgU9fZBP62D3ssHhnAQjfqJP4o6Gl1bJGPvkB3aAdOrDN5F8ljgZDZD' (Nullable = false), @p1='2025-10-02T08:02:30.8216783Z' (Nullable = true) (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "WhatsAppSettings" SET "ApiKey" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
2025-10-02 13:32:30.972 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:32:30.973 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api) in 298.8541ms
2025-10-02 13:32:30.974 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.UpdateSetting (xbytechat.api)'
2025-10-02 13:32:30.975 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:7113/api/whatsappsettings/update - 200 null application/json; charset=utf-8 307.7929ms
2025-10-02 13:32:31.454 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - null null
2025-10-02 13:32:31.455 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:31.456 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/whatsappsettings/test-connection/current - 204 null null 2.5699ms
2025-10-02 13:32:31.458 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - application/json 2
2025-10-02 13:32:31.460 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:31.461 +05:30 [INF] Executing endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 13:32:31.462 +05:30 [INF] Route matched with {action = "TestConnectionCurrent", controller = "WhatsAppSettings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] TestConnectionCurrent() on controller xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController (xbytechat.api).
2025-10-02 13:32:31.575 +05:30 [INF] Executed DbCommand (112ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:32:31.578 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 13:32:31.579 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/673199269218077
2025-10-02 13:32:32.601 +05:30 [INF] Received HTTP response headers after 1021.6809ms - 200
2025-10-02 13:32:32.603 +05:30 [INF] End processing HTTP request after 1024.8806ms - 200
2025-10-02 13:32:32.604 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType14`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-02 13:32:32.605 +05:30 [INF] Executed action xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api) in 1142.2363ms
2025-10-02 13:32:32.606 +05:30 [INF] Executed endpoint 'xbytechat_api.WhatsAppSettings.Controllers.WhatsAppSettingsController.TestConnectionCurrent (xbytechat.api)'
2025-10-02 13:32:32.607 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/whatsappsettings/test-connection/current - 200 null application/json; charset=utf-8 1148.8041ms
2025-10-02 13:32:36.494 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/facets - null null
2025-10-02 13:32:36.497 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:36.498 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/facets - 204 null null 4.2695ms
2025-10-02 13:32:36.506 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/report/message-logs/facets - null null
2025-10-02 13:32:36.509 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:36.511 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/report/message-logs/facets - 404 0 null 4.5944ms
2025-10-02 13:32:36.514 +05:30 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:7113/api/report/message-logs/facets, Response status code: 404
2025-10-02 13:32:36.727 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/search - null null
2025-10-02 13:32:36.729 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:36.730 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/report/message-logs/search - 204 null null 3.5551ms
2025-10-02 13:32:36.733 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/report/message-logs/search - application/json 131
2025-10-02 13:32:36.735 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:36.736 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api)'
2025-10-02 13:32:36.739 +05:30 [INF] Route matched with {action = "Search", controller = "MessageLogsReport"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Search(xbytechat.api.Features.Tracking.DTOs.MessageLogReportQueryDto, System.Threading.CancellationToken) on controller xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController (xbytechat.api).
2025-10-02 13:32:36.897 +05:30 [INF] Executed DbCommand (131ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__q_FromUtc_Value_1='2025-09-25T18:30:00.0000000Z' (DbType = DateTime), @__q_ToUtc_Value_2='2025-10-02T08:02:36.4670000Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND COALESCE(m."SentAt", m."CreatedAt") >= @__q_FromUtc_Value_1 AND COALESCE(m."SentAt", m."CreatedAt") <= @__q_ToUtc_Value_2
2025-10-02 13:32:37.006 +05:30 [INF] Executed DbCommand (94ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__q_FromUtc_Value_1='2025-09-25T18:30:00.0000000Z' (DbType = DateTime), @__q_ToUtc_Value_2='2025-10-02T08:02:36.4670000Z' (DbType = DateTime), @__p_4='25', @__p_3='0'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."CampaignId", c."Name" AS "CampaignName", m."RecipientNumber", c."PhoneNumberId" AS "SenderId", CASE
    WHEN c."Id" IS NOT NULL AND c."Provider" IS NOT NULL THEN c."Provider"
    ELSE m."Provider"
END AS "SourceChannel", m."Status", NULL AS "MessageType", m."MessageContent", COALESCE(m."ProviderMessageId", m."MessageId") AS "ProviderMessageId", m."ErrorMessage", m."CreatedAt", m."SentAt", NULL AS "DeliveredAt"
FROM "MessageLogs" AS m
LEFT JOIN "Campaigns" AS c ON m."CampaignId" = c."Id"
WHERE m."BusinessId" = @__businessId_0 AND COALESCE(m."SentAt", m."CreatedAt") >= @__q_FromUtc_Value_1 AND COALESCE(m."SentAt", m."CreatedAt") <= @__q_ToUtc_Value_2
ORDER BY COALESCE(m."SentAt", m."CreatedAt") DESC
LIMIT @__p_4 OFFSET @__p_3
2025-10-02 13:32:37.011 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Shared.PaginatedResponse`1[[xbytechat.api.Features.Tracking.DTOs.MessageLogListItemDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:32:37.017 +05:30 [INF] Executed action xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api) in 276.2165ms
2025-10-02 13:32:37.018 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.Tracking.Controllers.MessageLogsReportController.Search (xbytechat.api)'
2025-10-02 13:32:37.019 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/report/message-logs/search - 200 null application/json; charset=utf-8 286.916ms
2025-10-02 13:32:37.741 +05:30 [INF] Executed DbCommand (96ms) [Parameters=[@__now_0='2025-10-02T08:02:37.6441409+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:32:38.532 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:32:38.535 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:38.536 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/get-image-campaign - 204 null null 3.3206ms
2025-10-02 13:32:38.541 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - null null
2025-10-02 13:32:38.543 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:38.544 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:32:38.545 +05:30 [INF] Route matched with {action = "GetAll", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(System.String) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:32:38.657 +05:30 [INF] Executed DbCommand (110ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."Name", c."Status", c."ScheduledAt", c."CreatedAt", c."ImageUrl", c."ImageCaption", c0."Title" AS "CtaTitle", (
    SELECT count(*)::int
    FROM "CampaignRecipients" AS c1
    WHERE c."Id" = c1."CampaignId") AS "RecipientCount"
FROM "Campaigns" AS c
LEFT JOIN "CTADefinitions" AS c0 ON c."CtaId" = c0."Id"
WHERE c."BusinessId" = @__businessId_0
ORDER BY c."CreatedAt" DESC
2025-10-02 13:32:38.660 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[xbytechat.api.Features.CampaignModule.DTOs.CampaignSummaryDto, xbytechat.api, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-02 13:32:38.661 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api) in 114.5773ms
2025-10-02 13:32:38.662 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.GetAll (xbytechat.api)'
2025-10-02 13:32:38.663 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/api/campaign/get-image-campaign - 200 null application/json; charset=utf-8 121.9985ms
2025-10-02 13:32:39.897 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null null
2025-10-02 13:32:39.899 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:39.900 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 204 null null 3.1765ms
2025-10-02 13:32:39.903 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null 0
2025-10-02 13:32:39.904 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:32:39.905 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:32:39.906 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:32:40.031 +05:30 [INF] Executed DbCommand (122ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AudienceId", c."BusinessId", c."CTAFlowConfigId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."DocumentUrl", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."PhoneNumberId", c."Provider", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."TemplateSchemaSnapshot", c."UpdatedAt", c."VideoUrl"
FROM "Campaigns" AS c
WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
ORDER BY c."Id"
LIMIT 1
2025-10-02 13:32:40.117 +05:30 [INF] Executed DbCommand (84ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."AudienceMemberId", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IdempotencyKey", t0."IsAutoTagged", t0."MaterializedAt", t0."MessagePreview", t0."ProductBrowsed", t0."ResolvedButtonUrlsJson", t0."ResolvedParametersJson", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."ProfileName", t0."ProfileNameUpdatedAt", t0."Tags", t0."Id1", t0."AttributesJson", t0."AudienceId", t0."BusinessId1", t0."ContactId0", t0."CreatedAt0", t0."CreatedByUserId", t0."Email0", t0."IsDeleted", t0."IsTransientContact", t0."Name0", t0."PhoneE164", t0."PhoneRaw", t0."PromotedAt", t0."UpdatedAt0", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN (
    SELECT c0."Id", c0."AudienceMemberId", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IdempotencyKey", c0."IsAutoTagged", c0."MaterializedAt", c0."MessagePreview", c0."ProductBrowsed", c0."ResolvedButtonUrlsJson", c0."ResolvedParametersJson", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."ProfileName", c1."ProfileNameUpdatedAt", c1."Tags", a."Id" AS "Id1", a."AttributesJson", a."AudienceId", a."BusinessId" AS "BusinessId1", a."ContactId" AS "ContactId0", a."CreatedAt" AS "CreatedAt0", a."CreatedByUserId", a."Email" AS "Email0", a."IsDeleted", a."IsTransientContact", a."Name" AS "Name0", a."PhoneE164", a."PhoneRaw", a."PromotedAt", a."UpdatedAt" AS "UpdatedAt0"
    FROM "CampaignRecipients" AS c0
    LEFT JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
    LEFT JOIN "AudienceMembers" AS a ON c0."AudienceMemberId" = a."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:32:40.182 +05:30 [INF] Executed DbCommand (62ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."CampaignId", c0."IsFromTemplate", c0."Position", c0."Title", c0."Type", c0."Value", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN "CampaignButtons" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:32:40.325 +05:30 [INF] Executed DbCommand (140ms) [Parameters=[@__flowId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", t0."Id", t0."CTAFlowConfigId", t0."PositionX", t0."PositionY", t0."ProfileNameSlot", t0."RequiredSource", t0."RequiredTag", t0."StepOrder", t0."TemplateToSend", t0."TemplateType", t0."TriggerButtonText", t0."TriggerButtonType", t0."UseProfileName", t0."Id0", t0."ButtonIndex", t0."ButtonSubType", t0."ButtonText", t0."ButtonType", t0."ButtonValue", t0."CTAFlowStepId", t0."NextStepId"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."Id" = @__flowId_Value_0 AND c."BusinessId" = @__businessId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."CTAFlowConfigId", c0."PositionX", c0."PositionY", c0."ProfileNameSlot", c0."RequiredSource", c0."RequiredTag", c0."StepOrder", c0."TemplateToSend", c0."TemplateType", c0."TriggerButtonText", c0."TriggerButtonType", c0."UseProfileName", f."Id" AS "Id0", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
    FROM "CTAFlowSteps" AS c0
    LEFT JOIN "FlowButtonLinks" AS f ON c0."Id" = f."CTAFlowStepId"
) AS t0 ON t."Id" = t0."CTAFlowConfigId"
ORDER BY t."Id", t0."Id"
2025-10-02 13:32:40.395 +05:30 [INF] Executed DbCommand (67ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 13:32:40.397 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:32:40.398 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:32:41.243 +05:30 [INF] Received HTTP response headers after 843.2179ms - 200
2025-10-02 13:32:41.244 +05:30 [INF] End processing HTTP request after 846.348ms - 200
2025-10-02 13:32:41.537 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__campaign_CTAFlowConfigId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__campaign_CTAFlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 13:32:41.677 +05:30 [INF] Executed DbCommand (97ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__neededMemberIds_1={ 'b0fa50a8-060f-4f03-91b9-c7d5122edb1e' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."PhoneE164", a."PhoneRaw", a."Name"
FROM "AudienceMembers" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."Id" = ANY (@__neededMemberIds_1)
2025-10-02 13:32:41.950 +05:30 [INF] Executed DbCommand (152ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 13:32:42.033 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 13:32:42.042 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 13:32:42.043 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 13:32:43.481 +05:30 [INF] Received HTTP response headers after 1436.8005ms - 200
2025-10-02 13:32:43.483 +05:30 [INF] End processing HTTP request after 1440.5842ms - 200
2025-10-02 13:32:43.735 +05:30 [INF] Executed DbCommand (195ms) [Parameters=[@__messageLogId_0='6468e0de-ce4f-419a-9a04-390317849486', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 13:32:43.916 +05:30 [INF] Executed DbCommand (80ms) [Parameters=[@p2='4c4dc682-41ce-4e39-8a0d-bbebda1aee2a', @p0='2025-10-02T08:02:41.6809787Z' (Nullable = true) (DbType = DateTime), @p1='2025-10-02T08:02:41.6809787Z' (DbType = DateTime), @p3='6468e0de-ce4f-419a-9a04-390317849486', @p4='11f41b5f-f92c-4b6e-855b-62036779dee4', @p5='[{"i":0,"position":1,"text":"Show Me Template 2","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"Show Me Template 3","type":"QUICK_REPLY","subType":"quick_reply"}]', @p6='98cc4eed-e892-462a-88b5-2a2365a5ca14' (Nullable = true), @p7='832b5863-99a6-4fc4-b394-11bddfbe5591' (Nullable = true), @p8='c99d4b16-232e-4352-9a75-de8f392636ff' (Nullable = true), @p9=NULL (DbType = Guid), @p10=NULL, @p11=NULL, @p12=NULL (DbType = DateTime), @p13='2025-10-02T08:02:41.6809787Z' (DbType = DateTime), @p14=NULL, @p15=NULL (DbType = Int32), @p16=NULL (DbType = Boolean), @p17='False', @p18=NULL, @p19='template_1' (Nullable = false), @p20='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMUFBNDhBMzBEOUMwQzUxQjRBAA==', @p21=NULL (DbType = Decimal), @p22=NULL, @p23=NULL, @p24=NULL, @p25='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMUFBNDhBMzBEOUMwQzUxQjRBAA==","message_status":"accepted"}]}', @p26='918974005240' (Nullable = false), @p27=NULL (DbType = Guid), @p28=NULL, @p29='5d0f5e64-553c-4fc5-800a-783ee52d9452' (Nullable = true), @p30='2025-10-02T08:02:41.6809787Z' (Nullable = true) (DbType = DateTime), @p31='campaign', @p32='Sent' (Nullable = false), @p33='313b1f79-123a-46c0-8a4a-3fde07c16bee', @p34='11f41b5f-f92c-4b6e-855b-62036779dee4', @p35=NULL, @p36=NULL, @p37='2025-10-02T08:02:43.7377122+00:00' (DbType = DateTime), @p38='send_response' (Nullable = false), @p39=NULL (DbType = Boolean), @p40='6468e0de-ce4f-419a-9a04-390317849486' (Nullable = true), @p41='2025-10-02T08:02:43.7380130+00:00' (DbType = DateTime), @p42='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMUFBNDhBMzBEOUMwQzUxQjRBAA==","message_status":"accepted"}]}' (Nullable = false), @p43=NULL (DbType = Decimal), @p44=NULL, @p45='META_CLOUD' (Nullable = false), @p46='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMUFBNDhBMzBEOUMwQzUxQjRBAA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignRecipients" SET "MaterializedAt" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32)
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46);
2025-10-02 13:32:44.265 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[@p0='f2d155d5-c572-4054-a349-9e00e68230fb', @p1='True', @p2=NULL, @p3='11f41b5f-f92c-4b6e-855b-62036779dee4', @p4='[{"i":0,"position":1,"text":"Show Me Template 2","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"Show Me Template 3","type":"QUICK_REPLY","subType":"quick_reply"}]', @p5='98cc4eed-e892-462a-88b5-2a2365a5ca14' (Nullable = true), @p6='832b5863-99a6-4fc4-b394-11bddfbe5591' (Nullable = true), @p7='c99d4b16-232e-4352-9a75-de8f392636ff', @p8=NULL, @p9=NULL, @p10=NULL (DbType = DateTime), @p11=NULL (DbType = Guid), @p12=NULL, @p13='2025-10-02T08:02:41.6809787Z' (DbType = DateTime), @p14='system', @p15=NULL (DbType = DateTime), @p16=NULL, @p17=NULL, @p18=NULL, @p19=NULL, @p20='False', @p21=NULL (DbType = DateTime), @p22=NULL, @p23=NULL, @p24='This is the Template : 1' (Nullable = false), @p25='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSMUFBNDhBMzBEOUMwQzUxQjRBAA==', @p26='6468e0de-ce4f-419a-9a04-390317849486' (Nullable = true), @p27=NULL (DbType = DateTime), @p28='4c4dc682-41ce-4e39-8a0d-bbebda1aee2a', @p29='0', @p30='5d0f5e64-553c-4fc5-800a-783ee52d9452' (Nullable = true), @p31='Sent', @p32='2025-10-02T08:02:41.6809787Z' (Nullable = true) (DbType = DateTime), @p33=NULL, @p34='template_1', @p35=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "RunId", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2025-10-02 13:32:44.269 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 13:32:44.271 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 4363.1876ms
2025-10-02 13:32:44.272 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:32:44.273 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 200 null application/json; charset=utf-8 4370.8131ms
2025-10-02 13:32:47.915 +05:30 [INF] Executed DbCommand (161ms) [Parameters=[@__now_0='2025-10-02T08:02:47.7528644+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:32:58.001 +05:30 [INF] Executed DbCommand (75ms) [Parameters=[@__now_0='2025-10-02T08:02:57.9258516+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:33:08.162 +05:30 [INF] Executed DbCommand (143ms) [Parameters=[@__now_0='2025-10-02T08:03:08.0185290+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:33:18.317 +05:30 [INF] Executed DbCommand (139ms) [Parameters=[@__now_0='2025-10-02T08:03:18.1772361+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:33:28.385 +05:30 [INF] Executed DbCommand (64ms) [Parameters=[@__now_0='2025-10-02T08:03:28.3200624+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:33:38.530 +05:30 [INF] Executed DbCommand (140ms) [Parameters=[@__now_0='2025-10-02T08:03:38.3892078+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:34:22.053 +05:30 [INF] User profile is available. Using 'C:\Users\sunde\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-02 13:34:22.088 +05:30 [INF] 🚀 Webhook Queue Worker started.
2025-10-02 13:34:22.098 +05:30 [INF] 🧹 FailedWebhookLogCleanupService started.
2025-10-02 13:34:22.904 +05:30 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-10-02 13:34:23.504 +05:30 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-10-02 13:34:23.520 +05:30 [INF] ClickLogWorker started
2025-10-02 13:34:23.651 +05:30 [INF] Now listening on: http://localhost:7113
2025-10-02 13:34:23.652 +05:30 [INF] Now listening on: http://localhost:5295
2025-10-02 13:34:23.652 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-10-02 13:34:23.653 +05:30 [INF] Hosting environment: Development
2025-10-02 13:34:23.653 +05:30 [INF] Content root path: D:\xbytechat\xbytechat-api\xbytechat-api
2025-10-02 13:34:24.555 +05:30 [INF] ClickLogWorker stopped
2025-10-02 13:34:25.507 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/index.html - null null
2025-10-02 13:34:25.655 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/index.html - 200 null text/html;charset=utf-8 156.2574ms
2025-10-02 13:34:25.679 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - null null
2025-10-02 13:34:25.687 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_framework/aspnetcore-browser-refresh.js - 200 13762 application/javascript; charset=utf-8 7.4972ms
2025-10-02 13:34:25.741 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/_vs/browserLink - null null
2025-10-02 13:34:25.772 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.0135ms
2025-10-02 13:34:25.913 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - null null
2025-10-02 13:34:26.130 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:7113/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 216.8462ms
2025-10-02 13:34:31.897 +05:30 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."AutoCleanupEnabled", w."LastCleanupAt"
FROM "WebhookSettings" AS w
LIMIT 1
2025-10-02 13:34:31.901 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__cutoff_0='2025-09-25T08:04:22.1787065Z' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT f."Id", f."CreatedAt", f."ErrorMessage", f."FailureType", f."RawJson", f."SourceModule"
FROM "FailedWebhookLogs" AS f
WHERE f."CreatedAt" < @__cutoff_0
2025-10-02 13:34:33.631 +05:30 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT DISTINCT w."BusinessId"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive"
2025-10-02 13:34:33.723 +05:30 [INF] Executed DbCommand (63ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:34:33.814 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@__businessId_0='16d308c9-adcc-4ea9-8e9a-0724d11b5d7b'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 13:34:33.819 +05:30 [INF] ⏭️ Skipping sync for "16d308c9-adcc-4ea9-8e9a-0724d11b5d7b"; TTL not expired.
2025-10-02 13:34:33.820 +05:30 [INF] TemplateSyncWorker: biz="16d308c9-adcc-4ea9-8e9a-0724d11b5d7b" added=0 updated=0 skipped=0 syncedAt="2025-10-02T07:28:30.7163840Z"
2025-10-02 13:34:33.941 +05:30 [INF] Executed DbCommand (115ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."IsActive"
LIMIT 1
2025-10-02 13:34:34.046 +05:30 [INF] Executed DbCommand (103ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."LastSyncedAt"
FROM "WhatsAppTemplates" AS w
WHERE w."BusinessId" = @__businessId_0
ORDER BY w."LastSyncedAt" DESC
LIMIT 1
2025-10-02 13:34:34.048 +05:30 [INF] ⏭️ Skipping sync for "11f41b5f-f92c-4b6e-855b-62036779dee4"; TTL not expired.
2025-10-02 13:34:34.049 +05:30 [INF] TemplateSyncWorker: biz="11f41b5f-f92c-4b6e-855b-62036779dee4" added=0 updated=0 skipped=0 syncedAt="2025-10-02T06:47:39.2167560Z"
2025-10-02 13:34:34.051 +05:30 [INF] TemplateSyncWorker: sweep finished in 516 ms; processed=2; next run ~"2025-10-02T14:04:33.5352586Z"
2025-10-02 13:34:34.387 +05:30 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null null
2025-10-02 13:34:34.391 +05:30 [WRN] Failed to determine the https port for redirect.
2025-10-02 13:34:34.419 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:34:34.420 +05:30 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 204 null null 33.9195ms
2025-10-02 13:34:34.428 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - null 0
2025-10-02 13:34:34.435 +05:30 [INF] CORS policy execution successful.
2025-10-02 13:34:34.522 +05:30 [INF] Executing endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:34:34.534 +05:30 [INF] Route matched with {action = "SendTemplateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendTemplateCampaign(System.Guid) on controller xbytechat.api.Features.CampaignModule.Controllers.CampaignController (xbytechat.api).
2025-10-02 13:34:34.791 +05:30 [INF] Executed DbCommand (153ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id", c."AudienceId", c."BusinessId", c."CTAFlowConfigId", c."CampaignId", c."CampaignType", c."CreatedAt", c."CreatedBy", c."CtaId", c."DeletedAt", c."DeletedBy", c."DocumentUrl", c."FollowUpTemplateId", c."ImageCaption", c."ImageUrl", c."IsDeleted", c."MessageBody", c."MessageTemplate", c."Name", c."PhoneNumberId", c."Provider", c."ScheduledAt", c."SourceCampaignId", c."Status", c."TemplateId", c."TemplateParameters", c."TemplateSchemaSnapshot", c."UpdatedAt", c."VideoUrl"
FROM "Campaigns" AS c
WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
ORDER BY c."Id"
LIMIT 1
2025-10-02 13:34:34.927 +05:30 [INF] Executed DbCommand (112ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT t0."Id", t0."AudienceMemberId", t0."BotId", t0."BusinessId", t0."CampaignId", t0."CategoryBrowsed", t0."ClickedCTA", t0."ContactId", t0."IdempotencyKey", t0."IsAutoTagged", t0."MaterializedAt", t0."MessagePreview", t0."ProductBrowsed", t0."ResolvedButtonUrlsJson", t0."ResolvedParametersJson", t0."SentAt", t0."Status", t0."UpdatedAt", t0."Id0", t0."AssignedAgentId", t0."BusinessId0", t0."CreatedAt", t0."Email", t0."Group", t0."IsActive", t0."IsArchived", t0."IsAutomationPaused", t0."IsFavorite", t0."LastCTAInteraction", t0."LastCTAType", t0."LastClickedProductId", t0."LastContactedAt", t0."LeadSource", t0."Name", t0."NextFollowUpAt", t0."Notes", t0."PhoneNumber", t0."ProfileName", t0."ProfileNameUpdatedAt", t0."Tags", t0."Id1", t0."AttributesJson", t0."AudienceId", t0."BusinessId1", t0."ContactId0", t0."CreatedAt0", t0."CreatedByUserId", t0."Email0", t0."IsDeleted", t0."IsTransientContact", t0."Name0", t0."PhoneE164", t0."PhoneRaw", t0."PromotedAt", t0."UpdatedAt0", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN (
    SELECT c0."Id", c0."AudienceMemberId", c0."BotId", c0."BusinessId", c0."CampaignId", c0."CategoryBrowsed", c0."ClickedCTA", c0."ContactId", c0."IdempotencyKey", c0."IsAutoTagged", c0."MaterializedAt", c0."MessagePreview", c0."ProductBrowsed", c0."ResolvedButtonUrlsJson", c0."ResolvedParametersJson", c0."SentAt", c0."Status", c0."UpdatedAt", c1."Id" AS "Id0", c1."AssignedAgentId", c1."BusinessId" AS "BusinessId0", c1."CreatedAt", c1."Email", c1."Group", c1."IsActive", c1."IsArchived", c1."IsAutomationPaused", c1."IsFavorite", c1."LastCTAInteraction", c1."LastCTAType", c1."LastClickedProductId", c1."LastContactedAt", c1."LeadSource", c1."Name", c1."NextFollowUpAt", c1."Notes", c1."PhoneNumber", c1."ProfileName", c1."ProfileNameUpdatedAt", c1."Tags", a."Id" AS "Id1", a."AttributesJson", a."AudienceId", a."BusinessId" AS "BusinessId1", a."ContactId" AS "ContactId0", a."CreatedAt" AS "CreatedAt0", a."CreatedByUserId", a."Email" AS "Email0", a."IsDeleted", a."IsTransientContact", a."Name" AS "Name0", a."PhoneE164", a."PhoneRaw", a."PromotedAt", a."UpdatedAt" AS "UpdatedAt0"
    FROM "CampaignRecipients" AS c0
    LEFT JOIN "Contacts" AS c1 ON c0."ContactId" = c1."Id"
    LEFT JOIN "AudienceMembers" AS a ON c0."AudienceMemberId" = a."Id"
) AS t0 ON t."Id" = t0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:34:35.077 +05:30 [INF] Executed DbCommand (143ms) [Parameters=[@__campaignId_0='c99d4b16-232e-4352-9a75-de8f392636ff'], CommandType='"Text"', CommandTimeout='30']
SELECT c0."Id", c0."CampaignId", c0."IsFromTemplate", c0."Position", c0."Title", c0."Type", c0."Value", t."Id"
FROM (
    SELECT c."Id"
    FROM "Campaigns" AS c
    WHERE c."Id" = @__campaignId_0 AND NOT (c."IsDeleted")
    LIMIT 1
) AS t
INNER JOIN "CampaignButtons" AS c0 ON t."Id" = c0."CampaignId"
ORDER BY t."Id"
2025-10-02 13:34:35.109 +05:30 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-02 13:34:35.199 +05:30 [INF] Executed DbCommand (86ms) [Parameters=[@__flowId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT t."Id", t."BusinessId", t."CreatedAt", t."CreatedBy", t."FlowName", t."IsActive", t."IsPublished", t."UpdatedAt", t0."Id", t0."CTAFlowConfigId", t0."PositionX", t0."PositionY", t0."ProfileNameSlot", t0."RequiredSource", t0."RequiredTag", t0."StepOrder", t0."TemplateToSend", t0."TemplateType", t0."TriggerButtonText", t0."TriggerButtonType", t0."UseProfileName", t0."Id0", t0."ButtonIndex", t0."ButtonSubType", t0."ButtonText", t0."ButtonType", t0."ButtonValue", t0."CTAFlowStepId", t0."NextStepId"
FROM (
    SELECT c."Id", c."BusinessId", c."CreatedAt", c."CreatedBy", c."FlowName", c."IsActive", c."IsPublished", c."UpdatedAt"
    FROM "CTAFlowConfigs" AS c
    WHERE c."Id" = @__flowId_Value_0 AND c."BusinessId" = @__businessId_1 AND c."IsActive"
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT c0."Id", c0."CTAFlowConfigId", c0."PositionX", c0."PositionY", c0."ProfileNameSlot", c0."RequiredSource", c0."RequiredTag", c0."StepOrder", c0."TemplateToSend", c0."TemplateType", c0."TriggerButtonText", c0."TriggerButtonType", c0."UseProfileName", f."Id" AS "Id0", f."ButtonIndex", f."ButtonSubType", f."ButtonText", f."ButtonType", f."ButtonValue", f."CTAFlowStepId", f."NextStepId"
    FROM "CTAFlowSteps" AS c0
    LEFT JOIN "FlowButtonLinks" AS f ON c0."Id" = f."CTAFlowStepId"
) AS t0 ON t."Id" = t0."CTAFlowConfigId"
ORDER BY t."Id", t0."Id"
2025-10-02 13:34:35.466 +05:30 [INF] Executed DbCommand (176ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."IsActive" AND w."BusinessId" = @__businessId_0
LIMIT 1
2025-10-02 13:34:35.496 +05:30 [INF] Start processing HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:34:35.498 +05:30 [INF] Sending HTTP request GET https://graph.facebook.com/v22.0/744548247936621/message_templates?limit=200
2025-10-02 13:34:36.485 +05:30 [INF] Received HTTP response headers after 982.8928ms - 200
2025-10-02 13:34:36.487 +05:30 [INF] End processing HTTP request after 993.4917ms - 200
2025-10-02 13:34:36.838 +05:30 [INF] Executed DbCommand (93ms) [Parameters=[@__now_0='2025-10-02T08:04:28.5352692+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:34:36.838 +05:30 [INF] Executed DbCommand (79ms) [Parameters=[@__campaign_CTAFlowConfigId_Value_0='98cc4eed-e892-462a-88b5-2a2365a5ca14'], CommandType='"Text"', CommandTimeout='30']
SELECT c."Id"
FROM "CTAFlowSteps" AS c
WHERE c."CTAFlowConfigId" = @__campaign_CTAFlowConfigId_Value_0
ORDER BY c."StepOrder"
LIMIT 1
2025-10-02 13:34:37.056 +05:30 [INF] Executed DbCommand (147ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__neededMemberIds_1={ 'b0fa50a8-060f-4f03-91b9-c7d5122edb1e' } (DbType = Object)], CommandType='"Text"', CommandTimeout='30']
SELECT a."Id", a."PhoneE164", a."PhoneRaw", a."Name"
FROM "AudienceMembers" AS a
WHERE a."BusinessId" = @__businessId_0 AND a."Id" = ANY (@__neededMemberIds_1)
2025-10-02 13:34:37.358 +05:30 [INF] Executed DbCommand (165ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD', @__phoneNumberId_2='673199269218077'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "WhatsAppPhoneNumbers" AS w
    WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."PhoneNumberId" = @__phoneNumberId_2)
2025-10-02 13:34:37.441 +05:30 [INF] Executed DbCommand (74ms) [Parameters=[@__businessId_0='11f41b5f-f92c-4b6e-855b-62036779dee4', @__provider_1='META_CLOUD'], CommandType='"Text"', CommandTimeout='30']
SELECT w."Id", w."ApiKey", w."ApiUrl", w."BusinessId", w."CreatedAt", w."IsActive", w."PhoneNumberId", w."Provider", w."SenderDisplayName", w."UpdatedAt", w."WabaId", w."WebhookCallbackUrl", w."WebhookSecret", w."WebhookVerifyToken", w."WhatsAppBusinessNumber"
FROM "WhatsAppSettings" AS w
WHERE w."BusinessId" = @__businessId_0 AND w."Provider" = @__provider_1 AND w."IsActive"
LIMIT 1
2025-10-02 13:34:37.455 +05:30 [INF] Start processing HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 13:34:37.457 +05:30 [INF] Sending HTTP request POST https://graph.facebook.com/v22.0/673199269218077/messages
2025-10-02 13:34:39.044 +05:30 [INF] Received HTTP response headers after 1586.1502ms - 200
2025-10-02 13:34:39.045 +05:30 [INF] End processing HTTP request after 1589.7716ms - 200
2025-10-02 13:34:39.258 +05:30 [INF] Executed DbCommand (153ms) [Parameters=[@__messageLogId_0='4054ee83-760e-4778-a5b9-d5ab0b3e0305', @__businessId_1='11f41b5f-f92c-4b6e-855b-62036779dee4'], CommandType='"Text"', CommandTimeout='30']
SELECT m."Id", m."BusinessId", m."ButtonBundleJson", m."CTAFlowConfigId", m."CTAFlowStepId", m."CampaignId", m."ContactId", m."ConversationCategory", m."ConversationId", m."ConversationStartedAt", m."CreatedAt", m."ErrorMessage", m."FlowVersion", m."IsChargeable", m."IsIncoming", m."MediaUrl", m."MessageContent", m."MessageId", m."MessageTime", m."PriceAmount", m."PriceCurrency", m."Provider", m."ProviderMessageId", m."RawResponse", m."RecipientNumber", m."RefMessageId", m."RenderedBody", m."RunId", m."SentAt", m."Source", m."Status"
FROM "MessageLogs" AS m
WHERE m."Id" = @__messageLogId_0 AND m."BusinessId" = @__businessId_1
LIMIT 1
2025-10-02 13:34:39.637 +05:30 [INF] Executed DbCommand (191ms) [Parameters=[@p2='4c4dc682-41ce-4e39-8a0d-bbebda1aee2a', @p0='2025-10-02T08:04:37.0603181Z' (Nullable = true) (DbType = DateTime), @p1='2025-10-02T08:04:37.0603181Z' (DbType = DateTime), @p3='4054ee83-760e-4778-a5b9-d5ab0b3e0305', @p4='11f41b5f-f92c-4b6e-855b-62036779dee4', @p5='[{"i":0,"position":1,"text":"Show Me Template 2","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"Show Me Template 3","type":"QUICK_REPLY","subType":"quick_reply"}]', @p6='98cc4eed-e892-462a-88b5-2a2365a5ca14' (Nullable = true), @p7='832b5863-99a6-4fc4-b394-11bddfbe5591' (Nullable = true), @p8='c99d4b16-232e-4352-9a75-de8f392636ff' (Nullable = true), @p9=NULL (DbType = Guid), @p10=NULL, @p11=NULL, @p12=NULL (DbType = DateTime), @p13='2025-10-02T08:04:37.0603181Z' (DbType = DateTime), @p14=NULL, @p15=NULL (DbType = Int32), @p16=NULL (DbType = Boolean), @p17='False', @p18=NULL, @p19='template_1' (Nullable = false), @p20='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRUI1NjM1OEM3NzRGNjQzRkM1AA==', @p21=NULL (DbType = Decimal), @p22=NULL, @p23=NULL, @p24=NULL, @p25='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRUI1NjM1OEM3NzRGNjQzRkM1AA==","message_status":"accepted"}]}', @p26='918974005240' (Nullable = false), @p27=NULL (DbType = Guid), @p28=NULL, @p29='021e9cde-2e0f-4ec6-8cc8-e85b165507ed' (Nullable = true), @p30='2025-10-02T08:04:37.0603181Z' (Nullable = true) (DbType = DateTime), @p31='campaign', @p32='Sent' (Nullable = false), @p33='9a9788a9-f00d-418e-84c2-b7c27698f42e', @p34='11f41b5f-f92c-4b6e-855b-62036779dee4', @p35=NULL, @p36=NULL, @p37='2025-10-02T08:04:39.2611846+00:00' (DbType = DateTime), @p38='send_response' (Nullable = false), @p39=NULL (DbType = Boolean), @p40='4054ee83-760e-4778-a5b9-d5ab0b3e0305' (Nullable = true), @p41='2025-10-02T08:04:39.2616291+00:00' (DbType = DateTime), @p42='{"messaging_product":"whatsapp","contacts":[{"input":"918974005240","wa_id":"918974005240"}],"messages":[{"id":"wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRUI1NjM1OEM3NzRGNjQzRkM1AA==","message_status":"accepted"}]}' (Nullable = false), @p43=NULL (DbType = Decimal), @p44=NULL, @p45='META_CLOUD' (Nullable = false), @p46='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRUI1NjM1OEM3NzRGNjQzRkM1AA=='], CommandType='"Text"', CommandTimeout='30']
UPDATE "CampaignRecipients" SET "MaterializedAt" = @p0, "UpdatedAt" = @p1
WHERE "Id" = @p2;
INSERT INTO "MessageLogs" ("Id", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "ContactId", "ConversationCategory", "ConversationId", "ConversationStartedAt", "CreatedAt", "ErrorMessage", "FlowVersion", "IsChargeable", "IsIncoming", "MediaUrl", "MessageContent", "MessageId", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId", "RawResponse", "RecipientNumber", "RefMessageId", "RenderedBody", "RunId", "SentAt", "Source", "Status")
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32)
RETURNING "MessageTime";
INSERT INTO "ProviderBillingEvents" ("Id", "BusinessId", "ConversationCategory", "ConversationId", "CreatedAt", "EventType", "IsChargeable", "MessageLogId", "OccurredAt", "PayloadJson", "PriceAmount", "PriceCurrency", "Provider", "ProviderMessageId")
VALUES (@p33, @p34, @p35, @p36, @p37, @p38, @p39, @p40, @p41, @p42, @p43, @p44, @p45, @p46);
2025-10-02 13:34:39.870 +05:30 [INF] Executed DbCommand (89ms) [Parameters=[@p0='84884a67-cc98-4b6b-a15d-ac24d7364908', @p1='True', @p2=NULL, @p3='11f41b5f-f92c-4b6e-855b-62036779dee4', @p4='[{"i":0,"position":1,"text":"Show Me Template 2","type":"QUICK_REPLY","subType":"quick_reply"},{"i":1,"position":2,"text":"Show Me Template 3","type":"QUICK_REPLY","subType":"quick_reply"}]', @p5='98cc4eed-e892-462a-88b5-2a2365a5ca14' (Nullable = true), @p6='832b5863-99a6-4fc4-b394-11bddfbe5591' (Nullable = true), @p7='c99d4b16-232e-4352-9a75-de8f392636ff', @p8=NULL, @p9=NULL, @p10=NULL (DbType = DateTime), @p11=NULL (DbType = Guid), @p12=NULL, @p13='2025-10-02T08:04:37.0603181Z' (DbType = DateTime), @p14='system', @p15=NULL (DbType = DateTime), @p16=NULL, @p17=NULL, @p18=NULL, @p19=NULL, @p20='False', @p21=NULL (DbType = DateTime), @p22=NULL, @p23=NULL, @p24='This is the Template : 1' (Nullable = false), @p25='wamid.HBgMOTE4OTc0MDA1MjQwFQIAERgSRUI1NjM1OEM3NzRGNjQzRkM1AA==', @p26='4054ee83-760e-4778-a5b9-d5ab0b3e0305' (Nullable = true), @p27=NULL (DbType = DateTime), @p28='4c4dc682-41ce-4e39-8a0d-bbebda1aee2a', @p29='0', @p30='021e9cde-2e0f-4ec6-8cc8-e85b165507ed' (Nullable = true), @p31='Sent', @p32='2025-10-02T08:04:37.0603181Z' (Nullable = true) (DbType = DateTime), @p33=NULL, @p34='template_1', @p35=NULL (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CampaignSendLogs" ("Id", "AllowRetry", "Browser", "BusinessId", "ButtonBundleJson", "CTAFlowConfigId", "CTAFlowStepId", "CampaignId", "City", "ClickType", "ClickedAt", "ContactId", "Country", "CreatedAt", "CreatedBy", "DeliveredAt", "DeviceInfo", "DeviceType", "ErrorMessage", "IpAddress", "IsClicked", "LastRetryAt", "LastRetryStatus", "MacAddress", "MessageBody", "MessageId", "MessageLogId", "ReadAt", "RecipientId", "RetryCount", "RunId", "SendStatus", "SentAt", "SourceChannel", "TemplateId", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35);
2025-10-02 13:34:39.879 +05:30 [INF] Executing OkObjectResult, writing value of type 'xbytechat.api.Helpers.ResponseResult'.
2025-10-02 13:34:39.897 +05:30 [INF] Executed action xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api) in 5359.083ms
2025-10-02 13:34:39.898 +05:30 [INF] Executed endpoint 'xbytechat.api.Features.CampaignModule.Controllers.CampaignController.SendTemplateCampaign (xbytechat.api)'
2025-10-02 13:34:39.904 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:7113/api/campaign/send-campaign/c99d4b16-232e-4352-9a75-de8f392636ff - 200 null application/json; charset=utf-8 5476.5824ms
2025-10-02 13:34:46.958 +05:30 [INF] Executed DbCommand (102ms) [Parameters=[@__now_0='2025-10-02T08:04:46.8549766+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:34:57.117 +05:30 [INF] Executed DbCommand (154ms) [Parameters=[@__now_0='2025-10-02T08:04:56.9629882+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
2025-10-02 13:35:07.216 +05:30 [INF] Executed DbCommand (91ms) [Parameters=[@__now_0='2025-10-02T08:05:07.1244802+00:00' (DbType = DateTime), @__p_1='3'], CommandType='"Text"', CommandTimeout='30']
SELECT o."Id", o."Attempt", o."BusinessId", o."CampaignId", o."CreatedAt", o."LastError", o."MaxAttempts", o."NextAttemptAt", o."Status", o."UpdatedAt"
FROM "OutboundCampaignJobs" AS o
WHERE o."Status" = 'queued' AND o."NextAttemptAt" <= @__now_0
ORDER BY o."NextAttemptAt", o."CreatedAt"
LIMIT @__p_1
